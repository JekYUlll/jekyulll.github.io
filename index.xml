<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Horeb's Blog â¬†ï¸</title><link>https://jekyulll.github.io/</link><description>Recent content on Horeb's Blog â¬†ï¸</description><generator>Hugo</generator><language>en</language><copyright>&lt;a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="noopener">CC BY-NC 4.0&lt;/a></copyright><lastBuildDate>Sat, 18 Oct 2025 21:05:47 +0800</lastBuildDate><atom:link href="https://jekyulll.github.io/index.xml" rel="self" type="application/rss+xml"/><item><title>å®éªŒå®¤æœåŠ¡å™¨ä½¿ç”¨æ•™ç¨‹</title><link>https://jekyulll.github.io/posts/normal-%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/</link><pubDate>Sat, 18 Oct 2025 21:05:47 +0800</pubDate><guid>https://jekyulll.github.io/posts/normal-%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/</guid><description>&lt;h2 id="ä¸€å‰è¨€">ä¸€ã€å‰è¨€&lt;/h2>
&lt;p>&lt;span style="color: red;">&lt;strong>æ ¡å¤–è®¿é—®è¯·é€šè¿‡æ ¡å›­ VPN&lt;/strong>&lt;/span>&lt;/p>
&lt;h3 id="å†™ä½œç›®çš„">å†™ä½œç›®çš„&lt;/h3>
&lt;p>å®éªŒå®¤è¿‘æœŸæ–°è´­ç½®äº†ä¸€å°æ·±åº¦å­¦ä¹ æœåŠ¡å™¨ï¼Œä¾›æˆå‘˜è¿›è¡Œæ¨¡å‹è®­ç»ƒã€ä»¿çœŸå’Œè®¡ç®—ä»»åŠ¡ã€‚ä¸ºäº†å¸®åŠ©å¤§å®¶å¿«é€Ÿä¸Šæ‰‹ã€è§„èŒƒä½¿ç”¨ã€é¿å…èµ„æºæµªè´¹æˆ–ç³»ç»ŸæŸåï¼Œç‰¹ç¼–å†™æ­¤æ•™ç¨‹ã€‚å†…å®¹æ¶µç›–æœåŠ¡å™¨çš„åŸºæœ¬æ¦‚å¿µã€å„æ“ä½œç³»ç»Ÿä¸‹çš„è¿æ¥æ–¹å¼ã€Conda ç¯å¢ƒçš„ä½¿ç”¨ï¼Œä»¥åŠå›¾å½¢åŒ–ï¼ˆè¿œç¨‹æ¡Œé¢ï¼‰æ“ä½œæ–¹æ³•ã€‚&lt;/p>
&lt;h3 id="é€‚ç”¨äººç¾¤">é€‚ç”¨äººç¾¤&lt;/h3>
&lt;ul>
&lt;li>å¯¹ Linux æˆ–å‘½ä»¤è¡Œä¸ç†Ÿæ‚‰çš„åŒå­¦ï¼›&lt;/li>
&lt;li>éœ€è¦è¿›è¡Œæ·±åº¦å­¦ä¹ ã€æœ‰é™å…ƒä»¿çœŸæˆ–æ•°æ®å¤„ç†çš„ç ”ç©¶ç”Ÿã€‚&lt;/li>
&lt;/ul>
&lt;hr>
&lt;h2 id="äºŒä»€ä¹ˆæ˜¯æ·±åº¦å­¦ä¹ æœåŠ¡å™¨">äºŒã€ä»€ä¹ˆæ˜¯â€œæ·±åº¦å­¦ä¹ æœåŠ¡å™¨â€&lt;/h2>
&lt;p>æ·±åº¦å­¦ä¹ æœåŠ¡å™¨æ˜¯ä¸€å°é«˜æ€§èƒ½è®¡ç®—æœºï¼Œé€šå¸¸é…å¤‡å¤šå— GPUï¼ˆå›¾å½¢å¤„ç†å™¨ï¼‰ã€å¤§å®¹é‡æ˜¾å­˜ã€å†…å­˜å’Œé«˜é€Ÿå­˜å‚¨ã€‚
é€šå¸¸å®‰è£…Linuxç³»ç»Ÿ ï¼Œä¸€èˆ¬&lt;strong>ä¸ç›´æ¥æ¥æ˜¾ç¤ºå™¨&lt;/strong>ï¼Œè€Œæ˜¯é€šè¿‡ç½‘ç»œè¿œç¨‹è®¿é—®ï¼ˆSSH æˆ–è¿œç¨‹æ¡Œé¢ï¼‰ã€‚&lt;/p>
&lt;h3 id="ä¸»è¦ç”¨é€”">ä¸»è¦ç”¨é€”&lt;/h3>
&lt;ul>
&lt;li>æ·±åº¦å­¦ä¹ è®­ç»ƒï¼ˆå¦‚ PyTorchã€TensorFlowï¼‰ï¼›&lt;/li>
&lt;li>å¤§è§„æ¨¡æœ‰é™å…ƒä»¿çœŸï¼ˆAbaqusã€ANSYSã€COMSOLï¼‰ï¼›&lt;/li>
&lt;li>æ•°æ®åˆ†æã€å›¾åƒè¯†åˆ«ã€æ¨¡å‹ä¼˜åŒ–ç­‰ã€‚&lt;/li>
&lt;/ul>
&lt;h3 id="ç³»ç»Ÿä¸è½¯ä»¶ç¯å¢ƒ">ç³»ç»Ÿä¸è½¯ä»¶ç¯å¢ƒ&lt;/h3>
&lt;ul>
&lt;li>æ“ä½œç³»ç»Ÿï¼šUbuntu 22.04 LTS&lt;/li>
&lt;li>å·²å®‰è£…è½¯ä»¶ï¼šCUDAã€cuDNNã€Anacondaã€Pythonã€JupyterLab&lt;/li>
&lt;/ul>
&lt;hr>
&lt;h2 id="ä¸‰è´¦æˆ·ä¸ç™»å½•ä¿¡æ¯">ä¸‰ã€è´¦æˆ·ä¸ç™»å½•ä¿¡æ¯&lt;/h2>
&lt;h3 id="è´¦æˆ·ç”³è¯·">è´¦æˆ·ç”³è¯·&lt;/h3>
&lt;p>æ–°ç”¨æˆ·è¯·è”ç³»å®éªŒå®¤ç®¡ç†å‘˜å¼€é€šã€‚&lt;/p>
&lt;ol>
&lt;li>
&lt;p>&lt;strong>è´¦æˆ·å‘½åè§„åˆ™&lt;/strong>
å®éªŒå®¤ç»Ÿä¸€ä»¥&lt;em>å§“åå…¨æ‹¼&lt;/em>ä½œä¸ºç”¨æˆ·åï¼Œä¾‹å¦‚ï¼š&lt;/p>
&lt;ul>
&lt;li>å¼ ä¸‰ â†’ &lt;em>zhangsan&lt;/em>&lt;/li>
&lt;li>æå›› â†’ &lt;em>lisi&lt;/em>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>åˆå§‹å¯†ç &lt;/strong>
æ‰€æœ‰æ–°è´¦æˆ·çš„åˆå§‹å¯†ç ä¸ºï¼š&lt;code>123456&lt;/code>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;hr>
&lt;h3 id="-æ‰‹åŠ¨ä¿®æ”¹å¯†ç å¿…åš">ğŸ” æ‰‹åŠ¨ä¿®æ”¹å¯†ç ï¼ˆå¿…åšï¼‰&lt;/h3>
&lt;ol>
&lt;li>
&lt;p>ç™»å½•æœåŠ¡å™¨åï¼ˆè§åç»­æ•™ç¨‹ï¼‰ï¼Œåœ¨ç»ˆç«¯è¾“å…¥ï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>passwd
&lt;/code>&lt;/pre>&lt;/li>
&lt;li>
&lt;p>ç³»ç»Ÿä¼šæç¤ºï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>Changing password for user zhangsan.
(current) UNIX password:
&lt;/code>&lt;/pre>&lt;p>è¾“å…¥å½“å‰å¯†ç ï¼ˆå³ &lt;code>123456&lt;/code>ï¼‰ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>æ¥ç€è¾“å…¥æ–°å¯†ç ä¸¤æ¬¡ï¼ˆç³»ç»Ÿä¸ä¼šæ˜¾ç¤ºè¾“å…¥å†…å®¹ï¼Œä½†å®é™…ä¸Šè¾“è¿›å»äº†ï¼‰ï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>Enter new UNIX password:
Retype new UNIX password:
&lt;/code>&lt;/pre>&lt;/li>
&lt;li>
&lt;p>å¦‚æœä¸¤æ¬¡è¾“å…¥ä¸€è‡´ï¼Œä¼šæ˜¾ç¤ºï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>password updated successfully
&lt;/code>&lt;/pre>&lt;p>è¡¨ç¤ºä¿®æ”¹æˆåŠŸã€‚&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h3 id="ç½‘ç»œè®¿é—®">ç½‘ç»œè®¿é—®&lt;/h3>
&lt;hr>
&lt;h2 id="å››è¿æ¥æ–¹å¼">å››ã€è¿æ¥æ–¹å¼&lt;/h2>
&lt;h3 id="ä¸€windows-ç”¨æˆ·">ï¼ˆä¸€ï¼‰Windows ç”¨æˆ·&lt;/h3>
&lt;p>æ­¤å¤„æ¨èä¸‰ä¸ªç”¨äºè¿æ¥çš„ç»ˆç«¯å·¥å…·ï¼ˆå°±æ˜¯é»‘çª—å£ï¼Œç†è®ºä¸Šcmdå³å¯ï¼Œä½†ä¸å¤Ÿæ˜“ç”¨ï¼‰ï¼š&lt;/p></description></item><item><title>å®¹å™¨åŒ–æŠ€æœ¯ä¹‹ Linux namespace</title><link>https://jekyulll.github.io/posts/linux-%E5%AE%B9%E5%99%A8%E5%8C%96%E6%8A%80%E6%9C%AF%E4%B9%8B-linux-namespace/</link><pubDate>Sun, 08 Jun 2025 20:05:47 +0800</pubDate><guid>https://jekyulll.github.io/posts/linux-%E5%AE%B9%E5%99%A8%E5%8C%96%E6%8A%80%E6%9C%AF%E4%B9%8B-linux-namespace/</guid><description>&lt;p>Linux namespaceåšä¸€å±‚èµ„æºéš”ç¦»ï¼Œä½¿é‡Œé¢çš„è¿›ç¨‹/è¿›ç¨‹ç»„çœ‹èµ·æ¥æ‹¥æœ‰è‡ªå·±çš„ç‹¬ç«‹èµ„æºã€‚&lt;/p>
&lt;p>PID namespace ä¸­çš„ &lt;code>init&lt;/code> è¿›ç¨‹ï¼ˆPID=1ï¼‰éœ€è¦æ­£ç¡®å¤„ç†å­è¿›ç¨‹çš„åƒµå°¸çŠ¶æ€ï¼Œå¦åˆ™ä¼šå¯¼è‡´èµ„æºæ³„æ¼ã€‚&lt;/p>
&lt;p>æœ‰å¤šç§namespace:&lt;/p>
&lt;ul>
&lt;li>PID Namespaceï¼ˆCLONE_NEWPIDï¼‰ï¼šä¸åŒ namespace ä¸­çš„è¿›ç¨‹å¯ä»¥æ‹¥æœ‰ç›¸åŒçš„ PID&lt;/li>
&lt;li>Network Namespaceï¼ˆCLONE_NEWNETï¼‰ï¼šéš”ç¦»ç½‘ç»œæ ˆï¼ŒåŒ…æ‹¬ç½‘ç»œè®¾å¤‡ã€IP åœ°å€ã€ç«¯å£ã€è·¯ç”±è¡¨ä»¥åŠé˜²ç«å¢™è§„åˆ™&lt;/li>
&lt;li>Mount Namespaceï¼ˆCLONE_NEWNSï¼‰ï¼šéš”ç¦»æ–‡ä»¶ç³»ç»ŸæŒ‚è½½ç‚¹&lt;/li>
&lt;li>User Namespaceï¼ˆCLONE_NEWUSERï¼‰ï¼šéš”ç¦»ç”¨æˆ·å’Œç»„ ID ç©ºé—´ï¼Œå…è®¸åŒä¸€ä¸ªç”¨æˆ·åœ¨ä¸åŒ namespace ä¸­æ‹¥æœ‰ä¸åŒçš„æƒé™&lt;/li>
&lt;li>&amp;hellip;&lt;/li>
&lt;/ul>
&lt;p>Docker å®¹å™¨é»˜è®¤ä¼šä½¿ç”¨ä»¥ä¸‹ namespaceï¼š&lt;/p>
&lt;ul>
&lt;li>PIDï¼šéš”ç¦»è¿›ç¨‹æ ‘ã€‚&lt;/li>
&lt;li>NETï¼šæä¾›ç‹¬ç«‹çš„ç½‘ç»œæ ˆã€‚&lt;/li>
&lt;li>IPCï¼šéš”ç¦»è¿›ç¨‹é—´é€šä¿¡ã€‚&lt;/li>
&lt;li>UTSï¼šè®¾ç½®ç‹¬ç«‹çš„ä¸»æœºåã€‚&lt;/li>
&lt;li>MOUNTï¼šéš”ç¦»æ–‡ä»¶ç³»ç»ŸæŒ‚è½½ç‚¹ã€‚&lt;/li>
&lt;li>USERï¼šç”¨äºæ˜ å°„å®¹å™¨å†…çš„ root ç”¨æˆ·åˆ°å®¿ä¸»æœºçš„æ™®é€šç”¨æˆ·ã€‚&lt;/li>
&lt;/ul>
&lt;p>æ¯ä¸ªè¿›ç¨‹çš„ namespace ä¿¡æ¯éƒ½å­˜å‚¨åœ¨/proc/[pid]/nsç›®å½•ä¸‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>ls -l /proc/self/ns
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># lrwxrwxrwx 1 user user 0 Jun 10 12:00 cgroup -&amp;gt; &amp;#39;cgroup:[4026531835]&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># lrwxrwxrwx 1 user user 0 Jun 10 12:00 ipc -&amp;gt; &amp;#39;ipc:[4026531839]&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># lrwxrwxrwx 1 user user 0 Jun 10 12:00 mnt -&amp;gt; &amp;#39;mnt:[4026531840]&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># lrwxrwxrwx 1 user user 0 Jun 10 12:00 net -&amp;gt; &amp;#39;net:[4026531956]&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># lrwxrwxrwx 1 user user 0 Jun 10 12:00 pid -&amp;gt; &amp;#39;pid:[4026531836]&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># lrwxrwxrwx 1 user user 0 Jun 10 12:00 pid_for_children -&amp;gt; &amp;#39;pid:[4026531836]&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># lrwxrwxrwx 1 user user 0 Jun 10 12:00 user -&amp;gt; &amp;#39;user:[4026531837]&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># lrwxrwxrwx 1 user user 0 Jun 10 12:00 uts -&amp;gt; &amp;#39;uts:[4026531838]&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="å¦‚ä½•åˆ›å»º">å¦‚ä½•åˆ›å»ºï¼Ÿ&lt;/h3>
&lt;ol>
&lt;li>ä½¿ç”¨&lt;code>unshare&lt;/code>å‘½ä»¤åˆ›å»º namespaceï¼š&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># åˆ›å»ºæ–°çš„æŒ‚è½½ç‚¹å’ŒPID namespaceï¼Œå¹¶åœ¨å…¶ä¸­å¯åŠ¨bash&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>unshare --mount --pid --fork bash
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># åœ¨æ–°çš„namespaceä¸­æŸ¥çœ‹PID&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>echo $$ &lt;span style="color:#75715e"># è¾“å‡ºé€šå¸¸ä¸º1ï¼Œè¡¨ç¤ºå½“å‰bashæ˜¯æ–°namespaceä¸­çš„ç¬¬ä¸€ä¸ªè¿›ç¨‹&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># æŸ¥çœ‹å½“å‰namespaceä¸­çš„è¿›ç¨‹&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ps aux
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="2">
&lt;li>ä½¿ç”¨&lt;code>clone()&lt;/code>ç³»ç»Ÿè°ƒç”¨&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-C++" data-lang="C++">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#define _GNU_SOURCE
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;sched.h&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;unistd.h&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;stdlib.h&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;sys/wait.h&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;stdio.h&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// å­è¿›ç¨‹æ‰§è¡Œçš„å‡½æ•°
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">static&lt;/span> &lt;span style="color:#66d9ef">int&lt;/span> &lt;span style="color:#a6e22e">child_func&lt;/span>(&lt;span style="color:#66d9ef">void&lt;/span> &lt;span style="color:#f92672">*&lt;/span>arg) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// åœ¨æ–°çš„UTS namespaceä¸­è®¾ç½®ä¸»æœºå
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> sethostname(&lt;span style="color:#e6db74">&amp;#34;container&amp;#34;&lt;/span>, &lt;span style="color:#ae81ff">9&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// è¾“å‡ºå½“å‰è¿›ç¨‹IDå’Œä¸»æœºå
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> printf(&lt;span style="color:#e6db74">&amp;#34;å­è¿›ç¨‹PID: %d&lt;/span>&lt;span style="color:#ae81ff">\n&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>, getpid());
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> printf(&lt;span style="color:#e6db74">&amp;#34;ä¸»æœºå: %s&lt;/span>&lt;span style="color:#ae81ff">\n&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;container&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// æ‰§è¡Œ/bin/bash
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> execlp(&lt;span style="color:#e6db74">&amp;#34;/bin/bash&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;bash&amp;#34;&lt;/span>, NULL);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">int&lt;/span> &lt;span style="color:#a6e22e">main&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#66d9ef">int&lt;/span> STACK_SIZE &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">65536&lt;/span>; &lt;span style="color:#75715e">// ä¸ºå­è¿›ç¨‹åˆ†é…æ ˆç©ºé—´
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">char&lt;/span> &lt;span style="color:#f92672">*&lt;/span>stack &lt;span style="color:#f92672">=&lt;/span> malloc(STACK_SIZE);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (&lt;span style="color:#f92672">!&lt;/span>stack) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> perror(&lt;span style="color:#e6db74">&amp;#34;å†…å­˜åˆ†é…å¤±è´¥&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// è®¾ç½®æ ˆé¡¶ï¼ˆæ ˆæ˜¯å‘ä¸‹å¢é•¿çš„ï¼‰
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">char&lt;/span> &lt;span style="color:#f92672">*&lt;/span>stack_top &lt;span style="color:#f92672">=&lt;/span> stack &lt;span style="color:#f92672">+&lt;/span> STACK_SIZE;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// åˆ›å»ºæ–°çš„UTSå’ŒPID namespaceï¼Œå¹¶å¯åŠ¨å­è¿›ç¨‹
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> pid_t pid &lt;span style="color:#f92672">=&lt;/span> clone(child_func, stack_top, 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> CLONE_NEWUTS &lt;span style="color:#f92672">|&lt;/span> CLONE_NEWPID &lt;span style="color:#f92672">|&lt;/span> SIGCHLD, NULL);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (pid &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> perror(&lt;span style="color:#e6db74">&amp;#34;cloneå¤±è´¥&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// ç­‰å¾…å­è¿›ç¨‹ç»“æŸ
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> waitpid(pid, NULL, &lt;span style="color:#ae81ff">0&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> free(stack);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="3">
&lt;li>ä½¿ç”¨&lt;code>setns()&lt;/code>åŠ å…¥ç°æœ‰ namespace&lt;br>
åŠ å…¥å¦ä¸€ä¸ªè¿›ç¨‹çš„ç½‘ç»œ namespaceï¼š&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-C++" data-lang="C++">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#define _GNU_SOURCE
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;fcntl.h&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;sched.h&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;unistd.h&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;stdio.h&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">int&lt;/span> &lt;span style="color:#a6e22e">main&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// æ‰“å¼€ç›®æ ‡è¿›ç¨‹çš„ç½‘ç»œnamespaceæ–‡ä»¶
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">int&lt;/span> fd &lt;span style="color:#f92672">=&lt;/span> open(&lt;span style="color:#e6db74">&amp;#34;/proc/1234/ns/net&amp;#34;&lt;/span>, O_RDONLY);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (fd &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> perror(&lt;span style="color:#e6db74">&amp;#34;æ‰“å¼€namespaceæ–‡ä»¶å¤±è´¥&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// åŠ å…¥ç›®æ ‡namespace
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">if&lt;/span> (setns(fd, CLONE_NEWNET) &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> perror(&lt;span style="color:#e6db74">&amp;#34;åŠ å…¥namespaceå¤±è´¥&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> close(fd);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// æ‰§è¡Œéœ€è¦åœ¨ç›®æ ‡namespaceä¸­è¿è¡Œçš„å‘½ä»¤
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> execlp(&lt;span style="color:#e6db74">&amp;#34;ip&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;ip&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;addr&amp;#34;&lt;/span>, NULL);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="4">
&lt;li>ä½¿ç”¨&lt;code>nsenter&lt;/code>å‘½ä»¤ï¼ˆç®€åŒ–ç‰ˆ&lt;code>setns()&lt;/code>ï¼‰&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>sudo nsenter --target &lt;span style="color:#ae81ff">1234&lt;/span> --net ip addr
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>ã€ä»…æºç ã€‘Cè¯­è¨€é€šè¿‡getaddrinfoå‡½æ•°è·å–åŸŸåçš„IPåœ°å€</title><link>https://jekyulll.github.io/posts/cppc%E8%AF%AD%E8%A8%80%E9%80%9A%E8%BF%87getaddrinfo%E5%87%BD%E6%95%B0%E8%8E%B7%E5%8F%96%E5%9F%9F%E5%90%8D%E7%9A%84ip%E5%9C%B0%E5%9D%80/</link><pubDate>Thu, 08 May 2025 18:05:47 +0800</pubDate><guid>https://jekyulll.github.io/posts/cppc%E8%AF%AD%E8%A8%80%E9%80%9A%E8%BF%87getaddrinfo%E5%87%BD%E6%95%B0%E8%8E%B7%E5%8F%96%E5%9F%9F%E5%90%8D%E7%9A%84ip%E5%9C%B0%E5%9D%80/</guid><description>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;cstring&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;stdio.h&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;stdlib.h&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;sys/types.h&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;sys/socket.h&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;netdb.h&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;arpa/inet.h&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// 2025/05/08
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// Cè¯­è¨€é€šè¿‡getaddrinfoå‡½æ•°è·å–åŸŸåçš„IPåœ°å€
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">int&lt;/span> &lt;span style="color:#a6e22e">main&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">struct&lt;/span> &lt;span style="color:#a6e22e">addrinfo&lt;/span> hints, &lt;span style="color:#f92672">*&lt;/span>res, &lt;span style="color:#f92672">*&lt;/span>p;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">int&lt;/span> status;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">char&lt;/span> ipstr[INET6_ADDRSTRLEN];
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// åˆå§‹åŒ–hintsç»“æ„
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> memset(&lt;span style="color:#f92672">&amp;amp;&lt;/span>hints, &lt;span style="color:#ae81ff">0&lt;/span>, &lt;span style="color:#66d9ef">sizeof&lt;/span> hints);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> hints.ai_family &lt;span style="color:#f92672">=&lt;/span> AF_UNSPEC; &lt;span style="color:#75715e">// IPv4 æˆ–è€… IPv6
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> hints.ai_socktype &lt;span style="color:#f92672">=&lt;/span> SOCK_STREAM; &lt;span style="color:#75715e">// TCP å¥—æ¥å­—
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// è·å–åœ°å€ä¿¡æ¯
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">if&lt;/span> ((status &lt;span style="color:#f92672">=&lt;/span> getaddrinfo(&lt;span style="color:#e6db74">&amp;#34;www.baidu.com&amp;#34;&lt;/span>, NULL, &lt;span style="color:#f92672">&amp;amp;&lt;/span>hints, &lt;span style="color:#f92672">&amp;amp;&lt;/span>res)) &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> fprintf(stderr, &lt;span style="color:#e6db74">&amp;#34;getaddrinfo error: %s&lt;/span>&lt;span style="color:#ae81ff">\n&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>, gai_strerror(status));
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// éå†åœ°å€åˆ—è¡¨
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">for&lt;/span>(p &lt;span style="color:#f92672">=&lt;/span> res; p &lt;span style="color:#f92672">!=&lt;/span> NULL; p &lt;span style="color:#f92672">=&lt;/span> p&lt;span style="color:#f92672">-&amp;gt;&lt;/span>ai_next) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">void&lt;/span> &lt;span style="color:#f92672">*&lt;/span>addr;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">char&lt;/span> &lt;span style="color:#f92672">*&lt;/span>ipver;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// è·å– IP åœ°å€
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">if&lt;/span> (p&lt;span style="color:#f92672">-&amp;gt;&lt;/span>ai_family &lt;span style="color:#f92672">==&lt;/span> AF_INET) { &lt;span style="color:#75715e">// IPv4
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">struct&lt;/span> &lt;span style="color:#a6e22e">sockaddr_in&lt;/span> &lt;span style="color:#f92672">*&lt;/span>ipv4 &lt;span style="color:#f92672">=&lt;/span> (&lt;span style="color:#66d9ef">struct&lt;/span> &lt;span style="color:#a6e22e">sockaddr_in&lt;/span> &lt;span style="color:#f92672">*&lt;/span>)p&lt;span style="color:#f92672">-&amp;gt;&lt;/span>ai_addr;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> addr &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#f92672">&amp;amp;&lt;/span>(ipv4&lt;span style="color:#f92672">-&amp;gt;&lt;/span>sin_addr);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ipver &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;IPv4&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> } &lt;span style="color:#66d9ef">else&lt;/span> { &lt;span style="color:#75715e">// IPv6
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">struct&lt;/span> &lt;span style="color:#a6e22e">sockaddr_in6&lt;/span> &lt;span style="color:#f92672">*&lt;/span>ipv6 &lt;span style="color:#f92672">=&lt;/span> (&lt;span style="color:#66d9ef">struct&lt;/span> &lt;span style="color:#a6e22e">sockaddr_in6&lt;/span> &lt;span style="color:#f92672">*&lt;/span>)p&lt;span style="color:#f92672">-&amp;gt;&lt;/span>ai_addr;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> addr &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#f92672">&amp;amp;&lt;/span>(ipv6&lt;span style="color:#f92672">-&amp;gt;&lt;/span>sin6_addr);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ipver &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;IPv6&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// å°†äºŒè¿›åˆ¶ IP åœ°å€è½¬æ¢ä¸ºæ–‡æœ¬æ ¼å¼
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> inet_ntop(p&lt;span style="color:#f92672">-&amp;gt;&lt;/span>ai_family, addr, ipstr, &lt;span style="color:#66d9ef">sizeof&lt;/span> ipstr);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> printf(&lt;span style="color:#e6db74">&amp;#34;%s: %s&lt;/span>&lt;span style="color:#ae81ff">\n&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>, ipver, ipstr);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// é‡Šæ”¾åœ°å€ä¿¡æ¯
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> freeaddrinfo(res);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Redis Streamå’ŒMQ</title><link>https://jekyulll.github.io/posts/redis-redis-stream%E5%92%8Cmq/</link><pubDate>Mon, 05 May 2025 21:05:47 +0800</pubDate><guid>https://jekyulll.github.io/posts/redis-redis-stream%E5%92%8Cmq/</guid><description>&lt;p>å¸¸è§MQçš„åŠŸèƒ½ï¼Œæœ‰å“ªäº›æ˜¯ç”¨Rediså®ç°ä¸äº†çš„ï¼Ÿ&lt;/p>
&lt;p>æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆMQï¼‰ç”¨äºè§£è€¦ç³»ç»Ÿã€å¼‚æ­¥å¤„ç†ã€å‰Šå³°å¡«è°·ç­‰ï¼Œå¸¸è§çš„ MQ æœ‰ RabbitMQã€Kafkaã€RocketMQã€ActiveMQ ç­‰ã€‚è€Œ Redis ä¹Ÿæä¾›äº†å‘å¸ƒ/è®¢é˜…ï¼ˆpub/subï¼‰ã€List é˜Ÿåˆ—ã€Streamï¼ˆæµï¼‰ç­‰æœºåˆ¶ï¼Œçœ‹ä¼¼ä¹Ÿèƒ½å®ç°éƒ¨åˆ†æ¶ˆæ¯é˜Ÿåˆ—çš„åŠŸèƒ½ã€‚&lt;/p>
&lt;hr>
&lt;h3 id="-redis-èƒ½åšçš„-mq-åŠŸèƒ½">âœ… Redis èƒ½åšçš„ MQ åŠŸèƒ½ï¼š&lt;/h3>
&lt;table>
 &lt;thead>
 &lt;tr>
 &lt;th>åŠŸèƒ½&lt;/th>
 &lt;th>Redis æ”¯æŒæ–¹å¼&lt;/th>
 &lt;/tr>
 &lt;/thead>
 &lt;tbody>
 &lt;tr>
 &lt;td>ç®€å•é˜Ÿåˆ—&lt;/td>
 &lt;td>ä½¿ç”¨ &lt;code>List&lt;/code> çš„ &lt;code>LPUSH + BRPOP&lt;/code> å®ç°&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>å‘å¸ƒè®¢é˜…&lt;/td>
 &lt;td>ä½¿ç”¨ &lt;code>Pub/Sub&lt;/code> åŠŸèƒ½&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>æ¶ˆæ¯æµ&lt;/td>
 &lt;td>ä½¿ç”¨ &lt;code>Stream&lt;/code> ç±»å‹ï¼ˆè‡ª Redis 5.0 èµ·ï¼‰&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>æ¶ˆæ¯æŒä¹…åŒ–ï¼ˆæœ‰é™ï¼‰&lt;/td>
 &lt;td>Redis æœ‰æŒä¹…åŒ–æœºåˆ¶ï¼ˆRDBã€AOFï¼‰&lt;/td>
 &lt;/tr>
 &lt;/tbody>
&lt;/table>
&lt;hr>
&lt;h3 id="-redis-å®ç°ä¸äº†æˆ–ä¸æ“…é•¿çš„-mq-åŠŸèƒ½">âŒ Redis å®ç°ä¸äº†æˆ–ä¸æ“…é•¿çš„ MQ åŠŸèƒ½ï¼š&lt;/h3>
&lt;table>
 &lt;thead>
 &lt;tr>
 &lt;th>åŠŸèƒ½&lt;/th>
 &lt;th>åŸå› &lt;/th>
 &lt;/tr>
 &lt;/thead>
 &lt;tbody>
 &lt;tr>
 &lt;td>&lt;strong>æ¶ˆæ¯å¯é æŠ•é€’ï¼ˆACK ç¡®è®¤æœºåˆ¶ï¼‰&lt;/strong>&lt;/td>
 &lt;td>Redis çš„ Pub/Sub æ²¡æœ‰æ¶ˆè´¹ç¡®è®¤æœºåˆ¶ï¼ŒStream æœ‰ä½†æ¯”è¾ƒå¼±ï¼ˆå¦‚æ— æ¶ˆè´¹å¤±è´¥è‡ªåŠ¨é‡è¯•æœºåˆ¶ï¼‰&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>&lt;strong>é«˜ååé‡/åˆ†å¸ƒå¼æ—¥å¿—ç³»ç»Ÿï¼ˆå¦‚ Kafkaï¼‰&lt;/strong>&lt;/td>
 &lt;td>Redis ä¸é€‚åˆå¤§è§„æ¨¡æ—¥å¿—æˆ–ç™¾ä¸‡ TPS åœºæ™¯ï¼Œä¸”ä¸å…·å¤‡åˆ†åŒºï¼ˆpartitionï¼‰æœºåˆ¶&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>&lt;strong>æ¶ˆè´¹å¤±è´¥åçš„é‡è¯•æœºåˆ¶ã€æ­»ä¿¡é˜Ÿåˆ—ï¼ˆDLQï¼‰&lt;/strong>&lt;/td>
 &lt;td>Redis ä¸åŸç”Ÿæ”¯æŒï¼Œéœ€è¦æ‰‹åŠ¨æ„å»ºï¼ˆé€»è¾‘å¤æ‚ä¸”ä¸å¤Ÿå¥å£®ï¼‰&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>&lt;strong>æ¶ˆè´¹é¡ºåºä¿éšœï¼ˆpartition+offsetï¼‰&lt;/strong>&lt;/td>
 &lt;td>Redis Stream æä¾› ID é¡ºåºï¼Œä½†æ— æ³•å¦‚ Kafka é‚£æ ·åšä¸¥æ ¼çš„æœ‰åºåˆ†åŒºæ¶ˆè´¹&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>&lt;strong>æŒä¹…æ€§ä¿è¯å’Œç£ç›˜å®¹é‡ä¼˜åŒ–&lt;/strong>&lt;/td>
 &lt;td>Redis ä¸ºå†…å­˜æ•°æ®åº“ï¼ŒæŒä¹…æ€§å’Œå­˜å‚¨æˆæœ¬è¿œä¸å¦‚ Kafka ç­‰ç£ç›˜çº§ MQ&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>&lt;strong>æ¶ˆæ¯ç§¯å‹å¤„ç†èƒ½åŠ›å¼º&lt;/strong>&lt;/td>
 &lt;td>Redis åŸºäºå†…å­˜ï¼Œç§¯å‹æ¶ˆæ¯å¤šäº†å®¹æ˜“ OOMï¼ŒKafka ä¹‹ç±»åŸºäºç£ç›˜æ— æ­¤é—®é¢˜&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>&lt;strong>äº‹åŠ¡æ€§æ¶ˆæ¯æ”¯æŒï¼ˆå¦‚ RocketMQï¼‰&lt;/strong>&lt;/td>
 &lt;td>Redis ä¸æ”¯æŒäº‹åŠ¡æ€§æ¶ˆæ¯é€»è¾‘&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>&lt;strong>æ¶ˆè´¹è€…åˆ†ç»„ä¸è´Ÿè½½å‡è¡¡ï¼ˆConsumer Groupï¼‰&lt;/strong>&lt;/td>
 &lt;td>Redis Stream æœ‰äº›ç±»ä¼¼åŠŸèƒ½ï¼Œä½†ä¸å¦‚ Kafka çµæ´»å’Œæˆç†Ÿ&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>&lt;strong>æµæ§å’Œé™é€Ÿã€å¹‚ç­‰æœºåˆ¶æ”¯æŒ&lt;/strong>&lt;/td>
 &lt;td>Redis éœ€è¦è‡ªå·±å®ç°ï¼ŒKafka ç­‰ MQ å†…å»ºæ”¯æŒ&lt;/td>
 &lt;/tr>
 &lt;/tbody>
&lt;/table>
&lt;hr>
&lt;h3 id="æ€»ç»“">æ€»ç»“&lt;/h3>
&lt;ul>
&lt;li>Redis å¯ä»¥ç”¨æ¥å®ç°è½»é‡çº§ã€ç®€å•æˆ–ä½ååçš„æ¶ˆæ¯é˜Ÿåˆ—ç³»ç»Ÿï¼›&lt;/li>
&lt;li>Kafkaã€RabbitMQã€RocketMQ ç­‰æ›´é€‚åˆéœ€è¦&lt;strong>é«˜å¯é æ€§ã€åˆ†å¸ƒå¼ã€é«˜ååã€å¤æ‚æ¶ˆæ¯æ¨¡å¼&lt;/strong>çš„åœºæ™¯ï¼›&lt;/li>
&lt;li>Redis é€‚åˆâ€œç©å…·çº§â€æˆ–è½»é‡ä»»åŠ¡é˜Ÿåˆ—ï¼Œ&lt;strong>ä¸æ¨èåœ¨ä¼ä¸šçº§å¤æ‚ç³»ç»Ÿä¸­ç”¨ä½œæ ¸å¿ƒ MQ&lt;/strong>ã€‚&lt;/li>
&lt;/ul></description></item><item><title>[linux] TODO å®ˆæŠ¤è¿›ç¨‹ï¼Œsetsidï¼ŒLinuxä¸‰ä¸ªidï¼Œæƒé™</title><link>https://jekyulll.github.io/posts/linux-todo-%E5%AE%88%E6%8A%A4%E8%BF%9B%E7%A8%8Bsetsidlinux%E4%B8%89%E4%B8%AAid%E6%9D%83%E9%99%90/</link><pubDate>Tue, 29 Apr 2025 21:05:47 +0800</pubDate><guid>https://jekyulll.github.io/posts/linux-todo-%E5%AE%88%E6%8A%A4%E8%BF%9B%E7%A8%8Bsetsidlinux%E4%B8%89%E4%B8%AAid%E6%9D%83%E9%99%90/</guid><description>&lt;p>å¤ä¹ ï¼š&lt;a href="https://blog.csdn.net/JMW1407/article/details/108412836">ã€Linuxã€‘å®ˆæŠ¤è¿›ç¨‹ï¼ˆ Daemonï¼‰çš„å®šä¹‰ï¼Œä½œç”¨ï¼Œåˆ›å»ºæµç¨‹&lt;/a>ã€‚&lt;/p>
&lt;p>&lt;a href="https://blog.csdn.net/liaowenxiong/article/details/116401524">Linux å‘½ä»¤ä¹‹ &lt;code>locale&lt;/code> &amp;ndash; è®¾ç½®å’Œæ˜¾ç¤ºç¨‹åºè¿è¡Œçš„è¯­è¨€ç¯å¢ƒ&lt;/a>ã€‚&lt;/p>
&lt;blockquote>
&lt;p>ä½¿ç”¨ &lt;code>locale&lt;/code> å‘½ä»¤æ¥è®¾ç½®å’Œæ˜¾ç¤ºç¨‹åºè¿è¡Œçš„è¯­è¨€ç¯å¢ƒï¼Œ&lt;code>locale&lt;/code> ä¼šæ ¹æ®è®¡ç®—æœºç”¨æˆ·æ‰€ä½¿ç”¨çš„è¯­è¨€ï¼Œæ‰€åœ¨å›½å®¶æˆ–è€…åœ°åŒºï¼Œä»¥åŠå½“åœ°çš„æ–‡åŒ–ä¼ ç»Ÿå®šä¹‰ä¸€ä¸ªè½¯ä»¶è¿è¡Œæ—¶çš„è¯­è¨€ç¯å¢ƒã€‚&lt;br>
&lt;code>locale&lt;/code> ç”±ANSI Cæä¾›æ”¯æŒã€‚&lt;code>locale&lt;/code> çš„å‘½åè§„åˆ™ä¸º&lt;code>&amp;lt;è¯­è¨€&amp;gt;_&amp;lt;åœ°åŒº&amp;gt;.&amp;lt;å­—ç¬¦é›†ç¼–ç &amp;gt;&lt;/code>ã€‚&lt;/p>
&lt;/blockquote>
&lt;p>&lt;a href="https://blog.csdn.net/fmeng23/article/details/23115989">æ·±åˆ»ç†è§£â€”â€”real user id, effective user id, saved user id in Linux&lt;/a>ã€‚&lt;br>
&lt;a href="https://blog.csdn.net/ybxuwei/article/details/23563423">Linuxè¿›ç¨‹æƒé™çš„ç ”ç©¶â€”â€”real user id, effective user id, saved set-user-id&lt;/a>ã€‚&lt;/p>
&lt;blockquote>
&lt;p>è°ƒç”¨setsidçš„è¿›ç¨‹ä¸æ˜¯ä¸€ä¸ªè¿›ç¨‹ç»„çš„ç»„é•¿ï¼Œæ­¤å‡½æ•°åˆ›å»ºä¸€ä¸ªæ–°çš„ä¼šè¯æœŸã€‚&lt;/p>
&lt;/blockquote>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>echo $UID
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>[linux] åœ¨weztermé‡Œä½¿ç”¨tmuxå®ç°history restore ä¿å­˜å†å²ä¼šè¯</title><link>https://jekyulll.github.io/posts/linux-tmux%E5%AE%9E%E7%8E%B0wezterm%E4%BF%9D%E5%AD%98%E4%BC%9A%E8%AF%9D/</link><pubDate>Tue, 29 Apr 2025 21:05:47 +0800</pubDate><guid>https://jekyulll.github.io/posts/linux-tmux%E5%AE%9E%E7%8E%B0wezterm%E4%BF%9D%E5%AD%98%E4%BC%9A%E8%AF%9D/</guid><description>&lt;hr>
&lt;p>çŸ¥ä¹é“¾æ¥ï¼šhttps://zhuanlan.zhihu.com/p/1961547067106259944&lt;/p>
&lt;p>weztermåœ¨æ‰“å¼€ä¸»è¿›ç¨‹ã€æˆ–è€…ctrl+alt+tæ–°å»ºtabçš„æ—¶å€™é»˜è®¤æ˜¯ç©ºçš„shellä¼šè¯ï¼Œæœ‰æ—¶å€™ä¸å¤Ÿæ–¹ä¾¿ã€‚&lt;/p>
&lt;p>tmuxå¯ä»¥è½»æ¾è§£å†³ç—›ç‚¹ï¼Œä½†æ˜¯å¦‚æœè®¾ç½®weztermçš„default_progä¸ºtmuxï¼ˆå³æ¯æ¬¡ä¼šè¯éƒ½å¯åŠ¨ï¼‰ï¼šåœ¨weztermé‡Œæ–°å»ºtabï¼Œä½ ä¼šå‘ç°å’Œä¹‹å‰å…±äº«åŒä¸€ä¸ªtmuxï¼Œç›¸å½“äºweztermè‡ªå¸¦çš„tabåŠŸèƒ½æ²¡ç”¨äº†ã€‚&lt;/p>
&lt;pre>&lt;code>config.default_prog = { &amp;quot;/usr/bin/tmux&amp;quot;, &amp;quot;new-session&amp;quot;, &amp;quot;-A&amp;quot;, &amp;quot;-s&amp;quot;, &amp;quot;main&amp;quot; }
&lt;/code>&lt;/pre>
&lt;p>äºæ˜¯ï¼šèƒ½å¦åªè®©weztermçš„ç¬¬ä¸€ä¸ªtabå§‹ç»ˆå¼€å¯ä¸€ä¸ªtmuxæ¥ä¿å­˜ä¼šè¯ï¼Œå…¶ä»–tabåˆ™ä½¿ç”¨é»˜è®¤çš„æ–°å»ºshellåŠŸèƒ½ï¼Ÿ&lt;/p>
&lt;p>å…·ä½“å®ç°ï¼š&lt;/p>
&lt;pre>&lt;code>-- ç¬¬ä¸€ä¸ªtabæ‰“å¼€tmuxï¼Œä¹‹åçš„ä¸ºç©ºçš„shell
local tmux_started = false
wezterm.on(&amp;quot;gui-startup&amp;quot;, function(cmd)
	-- å¯åŠ¨ wezterm æ—¶è‡ªåŠ¨æ‰“å¼€ä¸€ä¸ª window
	local tab, pane, window = wezterm.mux.spawn_window(cmd or {})
	if not tmux_started then
		tmux_started = true
		-- å¯åŠ¨ tmux
		pane:send_text(&amp;quot;tmux -u new-session -A -s main\n&amp;quot;)
	end
end)
&lt;/code>&lt;/pre>
&lt;p>åŠ åœ¨weztermé…ç½®åˆé€‚çš„ä½ç½®å³å¯ã€‚&lt;/p></description></item><item><title>Linux å®ˆæŠ¤è¿›ç¨‹</title><link>https://jekyulll.github.io/posts/linux-%E5%AE%88%E6%8A%A4%E8%BF%9B%E7%A8%8B/</link><pubDate>Tue, 29 Apr 2025 20:05:47 +0800</pubDate><guid>https://jekyulll.github.io/posts/linux-%E5%AE%88%E6%8A%A4%E8%BF%9B%E7%A8%8B/</guid><description>&lt;p>å¤ä¹ ï¼š&lt;a href="https://blog.csdn.net/JMW1407/article/details/108412836">ã€Linuxã€‘å®ˆæŠ¤è¿›ç¨‹ï¼ˆ Daemonï¼‰çš„å®šä¹‰ï¼Œä½œç”¨ï¼Œåˆ›å»ºæµç¨‹&lt;/a>ã€‚&lt;/p>
&lt;p>ç¼–å†™å®ˆæŠ¤è¿›ç¨‹çš„ä¸€èˆ¬æ­¥éª¤æ­¥éª¤ï¼š&lt;/p>
&lt;ol>
&lt;li>åœ¨çˆ¶è¿›ç¨‹ä¸­æ‰§è¡Œ&lt;code>fork&lt;/code>å¹¶&lt;code>exit&lt;/code>é€€å‡ºï¼›&lt;/li>
&lt;li>åœ¨å­è¿›ç¨‹ä¸­è°ƒç”¨&lt;code>setsid&lt;/code>å‡½æ•°åˆ›å»ºæ–°çš„ä¼šè¯ï¼›&lt;/li>
&lt;li>åœ¨å­è¿›ç¨‹ä¸­è°ƒç”¨&lt;code>chdir&lt;/code>å‡½æ•°ï¼Œè®©æ ¹ç›®å½•&lt;code>/&lt;/code>æˆä¸ºå­è¿›ç¨‹çš„å·¥ä½œç›®å½•ï¼›&lt;/li>
&lt;li>åœ¨å­è¿›ç¨‹ä¸­è°ƒç”¨&lt;code>umask&lt;/code>å‡½æ•°ï¼Œè®¾ç½®è¿›ç¨‹çš„&lt;code>umask&lt;/code>ä¸º&lt;code>0&lt;/code>ï¼›&lt;/li>
&lt;li>åœ¨å­è¿›ç¨‹ä¸­å…³é—­ä»»ä½•ä¸éœ€è¦çš„æ–‡ä»¶æè¿°ç¬¦ã€‚&lt;/li>
&lt;/ol>
&lt;p>&lt;a href="https://blog.csdn.net/Change_Improve/article/details/106107317">Linuxâ€”umaskï¼ˆåˆ›å»ºæ–‡ä»¶æ—¶çš„æ©ç ï¼‰ç”¨æ³•è¯¦è§£&lt;/a>ã€‚&lt;/p>
&lt;p>&lt;a href="https://blog.csdn.net/fmeng23/article/details/23115989">æ·±åˆ»ç†è§£â€”â€”real user id, effective user id, saved user id in Linux&lt;/a>ã€‚&lt;br>
&lt;a href="https://blog.csdn.net/ybxuwei/article/details/23563423">Linuxè¿›ç¨‹æƒé™çš„ç ”ç©¶â€”â€”real user id, effective user id, saved set-user-id&lt;/a>ã€‚&lt;/p>
&lt;blockquote>
&lt;p>è°ƒç”¨setsidçš„è¿›ç¨‹ä¸æ˜¯ä¸€ä¸ªè¿›ç¨‹ç»„çš„ç»„é•¿ï¼Œæ­¤å‡½æ•°åˆ›å»ºä¸€ä¸ªæ–°çš„ä¼šè¯æœŸã€‚&lt;/p>
&lt;/blockquote></description></item><item><title>ã€1ã€‘Blenderå­¦ä¹ æ—¥è®°-å…¥é—¨</title><link>https://jekyulll.github.io/posts/game-1blender%E5%AD%A6%E4%B9%A0%E6%97%A5%E8%AE%B0-%E5%85%A5%E9%97%A8/</link><pubDate>Fri, 25 Apr 2025 06:05:47 +0800</pubDate><guid>https://jekyulll.github.io/posts/game-1blender%E5%AD%A6%E4%B9%A0%E6%97%A5%E8%AE%B0-%E5%85%A5%E9%97%A8/</guid><description>&lt;p>åŠå¤œå­¦ä¸€ä¸‹blenderã€‚&lt;/p>
&lt;!-- åœ¨Mintä¸Šä¹Ÿè£…äº†ä¸€ä¸‹ã€‚ -->
&lt;p>&lt;a href="https://www.bilibili.com/video/BV14u41147YH">ã€Kurtã€‘Blenderé›¶åŸºç¡€å…¥é—¨æ•™ç¨‹ | Blenderä¸­æ–‡åŒºæ–°æ‰‹å¿…åˆ·æ•™ç¨‹(å·²å®Œç»“)&lt;/a>ã€‚ç¬¬å››è¯¾è‘—åçš„çç è€³ç¯å°‘å¥³ï¼Œæ„Ÿè§‰ä¸€èŠ‚è¯¾å°±å·®ä¸å¤šå­¦ä¼šåŸºç¡€æ“ä½œäº†ï¼Œä¸é”™ã€‚&lt;/p>
&lt;p>&lt;code>N&lt;/code>æ˜¯å˜æ¢ï¼Œ&lt;code>S&lt;/code>æ˜¯sizeï¼ˆä¹Ÿå¯ä»¥ç»“åˆæ–¹å‘è½´ï¼Œåœ¨è½´å‘ä¼¸ç¼©ï¼‰ï¼Œ&lt;code>R&lt;/code>æ˜¯æ—‹è½¬ï¼ˆå¯ä»¥è¾“æ•°å­—ï¼Œä¾‹å¦‚&lt;code>R&lt;/code> &lt;code>Z&lt;/code> &lt;code>90&lt;/code>å°±æ˜¯åœ¨Zè½´æ—‹è½¬90åº¦ï¼‰ï¼Œ&lt;code>G&lt;/code>æ˜¯ç§»åŠ¨ã€‚&lt;br>
æ–°å»ºå†…å®¹æ˜¯&lt;code>SHIFT&lt;/code>+&lt;code>A&lt;/code>ï¼Œ&lt;code>F9&lt;/code>å¯ä»¥æ”¹æ®µæ•°ã€‚&lt;code>SHIFT&lt;/code>+&lt;code>D&lt;/code>å¤åˆ¶ï¼Œç§»åŠ¨çš„æ—¶å€™å¯ä»¥ä¾‹å¦‚æŒ‰&lt;code>Z&lt;/code>é”å®šåœ¨Zè½´ä¸Šç§»åŠ¨ã€‚æŒ‰ä¸¤ä¸‹æ–¹å‘è½´ï¼ˆä¾‹å¦‚ç§»åŠ¨çš„æ—¶å€™ï¼‰ï¼Œå¯ä»¥ä»ä¸–ç•Œåæ ‡ç³»åˆ‡æ¢åˆ°å±€éƒ¨åæ ‡ç³»ã€‚&lt;br>
æŒ‰&lt;code>/&lt;/code>å¯ä»¥å•ç‹¬æ˜¾ç¤ºè¯¥ç‰©ä½“ã€‚&lt;br>
åœ¨çª—å£å·¦ä¸Šè§’æ‹‰ä¸€ä¸‹ï¼Œèƒ½æ‹‰å‡ºæ–°çª—å£ã€‚æ–°çª—å£çš„å³ä¸Šè§’ï¼Œå¯ä»¥æ‹‰å›å»ã€‚&lt;br>
æ‘„åƒæœºæ¨¡å¼ä¹Ÿå¯ä»¥æŒ‰&lt;code>N&lt;/code>ï¼Œåœ¨&amp;quot;è§†å›¾&amp;quot;é‡ŒæŠŠæ‘„åƒæœº&amp;quot;é”å®šåˆ°è§†å›¾æ–¹ä½&amp;quot;ï¼Œæ–¹ä¾¿è°ƒæ•´ã€‚&lt;/p>
&lt;p>blenderæœ‰ä¸¤ä¸ªæ¸²æŸ“å¼•æ“ï¼š&lt;em>EEVEE&lt;/em>ï¼ˆå¿«ã€å®æ—¶ï¼‰ã€&lt;em>CYCLES&lt;/em>ï¼ˆç‰©ç†å†™å®ï¼‰ã€‚
æ¸²æŸ“å¿«æ·é”®F12ã€‚&lt;br>
å³é”®ç‰©ä½“ï¼Œå¹³æ»‘ç€è‰²ã€‚å³è¾¹ç‰©ä½“æ•°æ®å±æ€§ï¼ˆç»¿è‰²ä¸‰è§’ï¼‰-&amp;gt; æ³•å‘ -&amp;gt; è‡ªåŠ¨å…‰æ»‘ã€‚&lt;/p>
&lt;p>ç¼–è¾‘-&amp;gt;åå¥½è®¾ç½®é‡Œèƒ½è°ƒæ•´CUDAè®¾ç½®ã€‚&lt;br>
å‘ç°ç”¨CYCLESçš„æ—¶å€™ï¼Œåˆ‡æ¢æˆGPUæ¸²æŸ“ä¸å‡ºä¸œè¥¿ã€‚æ˜¾ç¤º&lt;code>Error CUDA kernel for this graphics card compute capability(8.6) not found&lt;/code>ï¼Œå¯èƒ½æ˜¯å› ä¸ºæ˜¾å¡é©±åŠ¨å¤ªæ–°â€”â€”æ¯•ç«Ÿæˆ‘ç”¨çš„ 2.83 çš„è¿œå¤Blenderï¼ˆä»¥å‰è½¬mmdæ ¼å¼çš„æ—¶å€™ï¼Œæ’ä»¶æ¯”è¾ƒè€ï¼Œæ‰€ä»¥ä¸‹çš„è€ç‰ˆæœ¬ï¼‰ã€‚&lt;/p>
&lt;p>å¤šé€‰ä¹‹å-&amp;gt;&lt;code>CTRL&lt;/code>+&lt;code>L&lt;/code>-&amp;gt;å…³è”æè´¨ã€‚&lt;/p></description></item><item><title>å®ç°æœåŠ¡ç«¯æ–­ç‚¹ç»­ä¼ ï¼šGoä¸Nginx</title><link>https://jekyulll.github.io/posts/web-%E5%88%A4%E6%96%ADhttp%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%96%AD%E7%82%B9%E7%BB%AD%E4%BC%A0/</link><pubDate>Wed, 23 Apr 2025 12:05:47 +0800</pubDate><guid>https://jekyulll.github.io/posts/web-%E5%88%A4%E6%96%ADhttp%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%96%AD%E7%82%B9%E7%BB%AD%E4%BC%A0/</guid><description>&lt;h3 id="ä¸€httpåè®®åŸºç¡€">ä¸€ã€HTTPåè®®åŸºç¡€&lt;/h3>
&lt;p>HTTPåè®®é€šè¿‡&lt;strong>Rangeè¯·æ±‚&lt;/strong>å®ç°æ–­ç‚¹ç»­ä¼ ï¼š&lt;/p>
&lt;ol>
&lt;li>
&lt;p>&lt;strong>å®¢æˆ·ç«¯è¯·æ±‚æŒ‡å®šèŒƒå›´&lt;/strong>&lt;br>
å®¢æˆ·ç«¯åœ¨è¯·æ±‚å¤´ä¸­æºå¸¦&lt;code>Range&lt;/code>å­—æ®µï¼Œä¾‹å¦‚ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /file.zip &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">1.1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Range&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">bytes=500-1000&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>&lt;strong>æœåŠ¡ç«¯å“åº”éƒ¨åˆ†å†…å®¹&lt;/strong>&lt;br>
è‹¥æ”¯æŒèŒƒå›´è¯·æ±‚ï¼ŒæœåŠ¡ç«¯è¿”å›çŠ¶æ€ç &lt;code>206 Partial Content&lt;/code>åŠå¯¹åº”æ•°æ®ç‰‡æ®µï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">1.1&lt;/span> &lt;span style="color:#ae81ff">206&lt;/span> &lt;span style="color:#a6e22e">Partial Content&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Content-Range&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">bytes 500-1000/5000&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Content-Length&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">501&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>&lt;strong>å®Œæ•´æ€§æ ¡éªŒæœºåˆ¶&lt;/strong>&lt;br>
é€šè¿‡&lt;code>ETag&lt;/code>æˆ–&lt;code>Last-Modified&lt;/code>å¤´ç¡®ä¿æ–‡ä»¶æœªå˜æ›´ï¼Œé¿å…ç»­ä¼ æ•°æ®ä¸ä¸€è‡´ã€‚&lt;/p>
&lt;/li>
&lt;/ol>
&lt;hr>
&lt;h3 id="äºŒnginxé™æ€èµ„æºæ–­ç‚¹ç»­ä¼ ">äºŒã€Nginxé™æ€èµ„æºæ–­ç‚¹ç»­ä¼ &lt;/h3>
&lt;p>Nginxé»˜è®¤æ”¯æŒé™æ€æ–‡ä»¶çš„æ–­ç‚¹ç»­ä¼ ã€‚éœ€è¦æœ‰ä»¥ä¸‹é…ç½®ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-nginx" data-lang="nginx">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">server&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">location&lt;/span> &lt;span style="color:#e6db74">/static&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">root&lt;/span> &lt;span style="color:#e6db74">/data/files&lt;/span>; &lt;span style="color:#75715e"># æ–‡ä»¶å­˜å‚¨è·¯å¾„
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#f92672">add_header&lt;/span> &lt;span style="color:#e6db74">Accept-Ranges&lt;/span> &lt;span style="color:#e6db74">bytes&lt;/span>; &lt;span style="color:#75715e"># å£°æ˜æ”¯æŒå­—èŠ‚èŒƒå›´è¯·æ±‚
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;strong>éªŒè¯æ–¹æ³•&lt;/strong>ï¼š&lt;br>
ä½¿ç”¨&lt;code>curl&lt;/code>æ£€æµ‹å“åº”å¤´ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>curl -I http://your-domain/static/large-file.iso
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>è‹¥è¾“å‡ºåŒ…å«&lt;code>Accept-Ranges: bytes&lt;/code>ä¸&lt;code>Content-Length&lt;/code>ï¼Œåˆ™è¡¨æ˜æ”¯æŒç»­ä¼ ã€‚&lt;/p>
&lt;hr>
&lt;h3 id="ä¸‰goå®ç°">ä¸‰ã€Goå®ç°&lt;/h3>
&lt;p>å¯¹äºåŠ¨æ€ç”Ÿæˆçš„æ–‡ä»¶ï¼ˆå¦‚éœ€é‰´æƒçš„èµ„æºï¼‰ï¼Œéœ€æ‰‹åŠ¨å¤„ç†&lt;code>Range&lt;/code>è¯·æ±‚ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-go" data-lang="go">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">package&lt;/span> &lt;span style="color:#a6e22e">main&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">import&lt;/span> (
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;fmt&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;net/http&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;os&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;strconv&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;strings&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">func&lt;/span> &lt;span style="color:#a6e22e">handleDownload&lt;/span>(&lt;span style="color:#a6e22e">w&lt;/span> &lt;span style="color:#a6e22e">http&lt;/span>.&lt;span style="color:#a6e22e">ResponseWriter&lt;/span>, &lt;span style="color:#a6e22e">r&lt;/span> &lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#a6e22e">http&lt;/span>.&lt;span style="color:#a6e22e">Request&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">filePath&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;/data/dynamic-file.bin&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">file&lt;/span>, &lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">os&lt;/span>.&lt;span style="color:#a6e22e">Open&lt;/span>(&lt;span style="color:#a6e22e">filePath&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#66d9ef">nil&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">http&lt;/span>.&lt;span style="color:#a6e22e">Error&lt;/span>(&lt;span style="color:#a6e22e">w&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;File not found&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">http&lt;/span>.&lt;span style="color:#a6e22e">StatusNotFound&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">defer&lt;/span> &lt;span style="color:#a6e22e">file&lt;/span>.&lt;span style="color:#a6e22e">Close&lt;/span>()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">fileInfo&lt;/span>, &lt;span style="color:#a6e22e">_&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">file&lt;/span>.&lt;span style="color:#a6e22e">Stat&lt;/span>()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">fileSize&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">fileInfo&lt;/span>.&lt;span style="color:#a6e22e">Size&lt;/span>()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">w&lt;/span>.&lt;span style="color:#a6e22e">Header&lt;/span>().&lt;span style="color:#a6e22e">Set&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;Content-Length&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">strconv&lt;/span>.&lt;span style="color:#a6e22e">FormatInt&lt;/span>(&lt;span style="color:#a6e22e">fileSize&lt;/span>, &lt;span style="color:#ae81ff">10&lt;/span>))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">w&lt;/span>.&lt;span style="color:#a6e22e">Header&lt;/span>().&lt;span style="color:#a6e22e">Set&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;ETag&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">fmt&lt;/span>.&lt;span style="color:#a6e22e">Sprintf&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;\&amp;#34;%x\&amp;#34;&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">fileInfo&lt;/span>.&lt;span style="color:#a6e22e">ModTime&lt;/span>().&lt;span style="color:#a6e22e">UnixNano&lt;/span>()))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">rangeHeader&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">r&lt;/span>.&lt;span style="color:#a6e22e">Header&lt;/span>.&lt;span style="color:#a6e22e">Get&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;Range&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#a6e22e">rangeHeader&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#e6db74">&amp;#34;&amp;#34;&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">http&lt;/span>.&lt;span style="color:#a6e22e">ServeContent&lt;/span>(&lt;span style="color:#a6e22e">w&lt;/span>, &lt;span style="color:#a6e22e">r&lt;/span>, &lt;span style="color:#a6e22e">fileInfo&lt;/span>.&lt;span style="color:#a6e22e">Name&lt;/span>(), &lt;span style="color:#a6e22e">fileInfo&lt;/span>.&lt;span style="color:#a6e22e">ModTime&lt;/span>(), &lt;span style="color:#a6e22e">file&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">ranges&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">strings&lt;/span>.&lt;span style="color:#a6e22e">Split&lt;/span>(&lt;span style="color:#a6e22e">rangeHeader&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;=&amp;#34;&lt;/span>)[&lt;span style="color:#ae81ff">1&lt;/span>]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">parts&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">strings&lt;/span>.&lt;span style="color:#a6e22e">Split&lt;/span>(&lt;span style="color:#a6e22e">ranges&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;-&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">start&lt;/span>, &lt;span style="color:#a6e22e">_&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">strconv&lt;/span>.&lt;span style="color:#a6e22e">ParseInt&lt;/span>(&lt;span style="color:#a6e22e">parts&lt;/span>[&lt;span style="color:#ae81ff">0&lt;/span>], &lt;span style="color:#ae81ff">10&lt;/span>, &lt;span style="color:#ae81ff">64&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">end&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">fileSize&lt;/span> &lt;span style="color:#f92672">-&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#a6e22e">parts&lt;/span>[&lt;span style="color:#ae81ff">1&lt;/span>] &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;&amp;#34;&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">end&lt;/span>, &lt;span style="color:#a6e22e">_&lt;/span> = &lt;span style="color:#a6e22e">strconv&lt;/span>.&lt;span style="color:#a6e22e">ParseInt&lt;/span>(&lt;span style="color:#a6e22e">parts&lt;/span>[&lt;span style="color:#ae81ff">1&lt;/span>], &lt;span style="color:#ae81ff">10&lt;/span>, &lt;span style="color:#ae81ff">64&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#a6e22e">start&lt;/span> &lt;span style="color:#f92672">&amp;gt;=&lt;/span> &lt;span style="color:#a6e22e">fileSize&lt;/span> &lt;span style="color:#f92672">||&lt;/span> &lt;span style="color:#a6e22e">end&lt;/span> &lt;span style="color:#f92672">&amp;gt;=&lt;/span> &lt;span style="color:#a6e22e">fileSize&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">http&lt;/span>.&lt;span style="color:#a6e22e">Error&lt;/span>(&lt;span style="color:#a6e22e">w&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;Requested range not satisfiable&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">http&lt;/span>.&lt;span style="color:#a6e22e">StatusRequestedRangeNotSatisfiable&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">w&lt;/span>.&lt;span style="color:#a6e22e">Header&lt;/span>().&lt;span style="color:#a6e22e">Set&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;Content-Range&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">fmt&lt;/span>.&lt;span style="color:#a6e22e">Sprintf&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;bytes %d-%d/%d&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">start&lt;/span>, &lt;span style="color:#a6e22e">end&lt;/span>, &lt;span style="color:#a6e22e">fileSize&lt;/span>))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">w&lt;/span>.&lt;span style="color:#a6e22e">Header&lt;/span>().&lt;span style="color:#a6e22e">Set&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;Content-Length&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">strconv&lt;/span>.&lt;span style="color:#a6e22e">FormatInt&lt;/span>(&lt;span style="color:#a6e22e">end&lt;/span>&lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#a6e22e">start&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>, &lt;span style="color:#ae81ff">10&lt;/span>))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">w&lt;/span>.&lt;span style="color:#a6e22e">WriteHeader&lt;/span>(&lt;span style="color:#a6e22e">http&lt;/span>.&lt;span style="color:#a6e22e">StatusPartialContent&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">file&lt;/span>.&lt;span style="color:#a6e22e">Seek&lt;/span>(&lt;span style="color:#a6e22e">start&lt;/span>, &lt;span style="color:#ae81ff">0&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">http&lt;/span>.&lt;span style="color:#a6e22e">ServeContent&lt;/span>(&lt;span style="color:#a6e22e">w&lt;/span>, &lt;span style="color:#a6e22e">r&lt;/span>, &lt;span style="color:#a6e22e">fileInfo&lt;/span>.&lt;span style="color:#a6e22e">Name&lt;/span>(), &lt;span style="color:#a6e22e">fileInfo&lt;/span>.&lt;span style="color:#a6e22e">ModTime&lt;/span>(), &lt;span style="color:#a6e22e">file&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">func&lt;/span> &lt;span style="color:#a6e22e">main&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">http&lt;/span>.&lt;span style="color:#a6e22e">HandleFunc&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;/download&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">handleDownload&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">http&lt;/span>.&lt;span style="color:#a6e22e">ListenAndServe&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;:8080&amp;#34;&lt;/span>, &lt;span style="color:#66d9ef">nil&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>â€¢ è§£æ&lt;code>Range&lt;/code>è¯·æ±‚å¤´å¹¶éªŒè¯èŒƒå›´æœ‰æ•ˆæ€§
â€¢ ä½¿ç”¨&lt;code>Seek&lt;/code>å®šä½æ–‡ä»¶æŒ‡é’ˆï¼Œè¿”å›éƒ¨åˆ†å†…å®¹
â€¢ é€šè¿‡&lt;code>ETag&lt;/code>å®ç°æ–‡ä»¶ä¸€è‡´æ€§æ ¡éªŒ&lt;/p></description></item><item><title>C++ ä¸­çš„ä¹è§‚é”å’Œæ‚²è§‚é”</title><link>https://jekyulll.github.io/posts/cpp-c++-%E4%B8%AD%E7%9A%84%E4%B9%90%E8%A7%82%E9%94%81%E5%92%8C%E6%82%B2%E8%A7%82%E9%94%81/</link><pubDate>Mon, 21 Apr 2025 18:05:47 +0800</pubDate><guid>https://jekyulll.github.io/posts/cpp-c++-%E4%B8%AD%E7%9A%84%E4%B9%90%E8%A7%82%E9%94%81%E5%92%8C%E6%82%B2%E8%A7%82%E9%94%81/</guid><description>&lt;blockquote>
&lt;p>&lt;strong>æ‚²è§‚é”&lt;/strong>ï¼ˆPessimistic Lockï¼‰æ˜¯ä¸€ç§å‡è®¾å†²çªä¼šé¢‘ç¹å‘ç”Ÿçš„é”æœºåˆ¶ã€‚æ¯æ¬¡æ•°æ®è®¿é—®æ—¶ï¼Œéƒ½ä¼šå…ˆåŠ é”ï¼Œç›´åˆ°æ“ä½œå®Œæˆåæ‰é‡Šæ”¾é”ï¼Œè¿™æ ·å¯ä»¥ç¡®ä¿åœ¨é”æŒæœ‰æœŸé—´ï¼Œå…¶ä»–çº¿ç¨‹æ— æ³•è®¿é—®è¿™æ®µæ•°æ®ï¼Œä»è€Œé¿å…äº†å¹¶å‘å†²çªã€‚
&lt;strong>ä¹è§‚é”&lt;/strong>ï¼ˆOptimistic Lockï¼‰æ˜¯ä¸€ç§å‡è®¾å†²çªä¸ä¼šé¢‘ç¹å‘ç”Ÿçš„é”æœºåˆ¶ã€‚æ¯æ¬¡æ•°æ®è®¿é—®æ—¶ï¼Œä¸ä¼šåŠ é”ï¼Œè€Œæ˜¯åœ¨æ›´æ–°æ•°æ®æ—¶æ£€æŸ¥æ˜¯å¦æœ‰å…¶ä»–çº¿ç¨‹ä¿®æ”¹è¿‡æ•°æ®ã€‚å¦‚æœæ£€æµ‹åˆ°å†²çªï¼ˆæ•°æ®è¢«å…¶ä»–çº¿ç¨‹ä¿®æ”¹è¿‡ï¼‰ï¼Œåˆ™é‡è¯•æ“ä½œæˆ–æŠ¥é”™ã€‚é€‚ç”¨äºè¯»å¤šå†™å°‘çš„åœºæ™¯ã€‚&lt;/p>
&lt;/blockquote>
&lt;p>ä¹è§‚é”é€šå¸¸å®ç°æ–¹å¼æœ‰ä»¥ä¸‹ä¸¤ç§ï¼š&lt;/p>
&lt;ul>
&lt;li>
&lt;p>&lt;strong>ç‰ˆæœ¬å·æœºåˆ¶&lt;/strong>ï¼šæ¯æ¬¡è¯»å–æ•°æ®æ—¶ï¼Œè¯»å–ä¸€ä¸ªç‰ˆæœ¬å·ï¼Œæ›´æ–°æ•°æ®æ—¶ï¼Œæ£€æŸ¥ç‰ˆæœ¬å·æ˜¯å¦å˜åŒ–ï¼Œå¦‚æœæ²¡æœ‰å˜åŒ–ï¼Œåˆ™æ›´æ–°æˆåŠŸï¼Œå¦åˆ™é‡è¯•ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>æ—¶é—´æˆ³æœºåˆ¶&lt;/strong>ï¼šç±»ä¼¼ç‰ˆæœ¬å·æœºåˆ¶ï¼Œé€šè¿‡æ—¶é—´æˆ³æ¥æ£€æµ‹æ•°æ®æ˜¯å¦è¢«ä¿®æ”¹ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>æ‚²è§‚é”æ€§èƒ½è¾ƒä½ï¼Œå› ä¸ºæ¯æ¬¡æ“ä½œéƒ½éœ€è¦åŠ é”å’Œè§£é”ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ä¹è§‚é”æ€§èƒ½è¾ƒé«˜ï¼Œä½†åœ¨é«˜å¹¶å‘å†™æ“ä½œä¸‹å¯èƒ½ä¼šé¢‘ç¹é‡è¯•ï¼Œå½±å“æ€§èƒ½ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>æ‚²è§‚é”é€‚ç”¨äºå¹¶å‘å†²çªé«˜ã€æ•°æ®ä¸€è‡´æ€§è¦æ±‚ä¸¥æ ¼çš„åœºæ™¯ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ä¹è§‚é”é€‚ç”¨äºå¹¶å‘å†²çªä½ã€è¯»å¤šå†™å°‘çš„åœºæ™¯ã€‚&lt;/p>
&lt;/li>
&lt;/ul>
&lt;hr>
&lt;p>C++ä¹è§‚é”å®ç°æ–¹å¼ï¼šä½¿ç”¨ &lt;strong>CASï¼ˆCompare-And-Swapï¼‰&lt;/strong> æˆ– &lt;code>std::atomic&lt;/code>ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;iostream&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;thread&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;atomic&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>std&lt;span style="color:#f92672">::&lt;/span>atomic&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#66d9ef">int&lt;/span>&lt;span style="color:#f92672">&amp;gt;&lt;/span> sharedData(&lt;span style="color:#ae81ff">0&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">void&lt;/span> &lt;span style="color:#a6e22e">optimisticTask&lt;/span>(&lt;span style="color:#66d9ef">int&lt;/span> id) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">for&lt;/span> (&lt;span style="color:#66d9ef">int&lt;/span> i &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>; i &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#ae81ff">5&lt;/span>; &lt;span style="color:#f92672">++&lt;/span>i) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">int&lt;/span> oldValue;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">int&lt;/span> newValue;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">do&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> oldValue &lt;span style="color:#f92672">=&lt;/span> sharedData.load(); &lt;span style="color:#75715e">// è¯»å–å½“å‰å€¼
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> newValue &lt;span style="color:#f92672">=&lt;/span> oldValue &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>; &lt;span style="color:#75715e">// æœ¬åœ°è®¡ç®—
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> } &lt;span style="color:#66d9ef">while&lt;/span> (&lt;span style="color:#f92672">!&lt;/span>sharedData.compare_exchange_weak(oldValue, newValue));
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> std&lt;span style="color:#f92672">::&lt;/span>cout &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> &lt;span style="color:#e6db74">&amp;#34;Thread &amp;#34;&lt;/span> &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> id &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> &lt;span style="color:#e6db74">&amp;#34; updated sharedData to &amp;#34;&lt;/span> &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> newValue &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> std&lt;span style="color:#f92672">::&lt;/span>endl;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">int&lt;/span> &lt;span style="color:#a6e22e">main&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> std&lt;span style="color:#f92672">::&lt;/span>&lt;span style="color:#66d9ef">thread&lt;/span> t1(optimisticTask, &lt;span style="color:#ae81ff">1&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> std&lt;span style="color:#f92672">::&lt;/span>&lt;span style="color:#66d9ef">thread&lt;/span> t2(optimisticTask, &lt;span style="color:#ae81ff">2&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> t1.join();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> t2.join();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> std&lt;span style="color:#f92672">::&lt;/span>cout &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> &lt;span style="color:#e6db74">&amp;#34;Final sharedData: &amp;#34;&lt;/span> &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> sharedData &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> std&lt;span style="color:#f92672">::&lt;/span>endl;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>compare_exchange_weak&lt;/code> å¯èƒ½ä¼šåœ¨æ— å†²çªæ—¶ä¹Ÿå¤±è´¥ï¼ˆä¸ºæ€§èƒ½ä¼˜åŒ–ï¼‰ï¼Œå¯ä»¥æ¢æˆ &lt;code>compare_exchange_strong&lt;/code> æ›´ç¨³å®šã€‚&lt;/p></description></item><item><title>304 Not Modified æ˜¯æ€ä¹ˆæ£€æµ‹çš„ï¼Ÿ</title><link>https://jekyulll.github.io/posts/web-304-not-modified-%E6%98%AF%E6%80%8E%E4%B9%88%E6%A3%80%E6%B5%8B%E7%9A%84/</link><pubDate>Thu, 17 Apr 2025 04:05:47 +0800</pubDate><guid>https://jekyulll.github.io/posts/web-304-not-modified-%E6%98%AF%E6%80%8E%E4%B9%88%E6%A3%80%E6%B5%8B%E7%9A%84/</guid><description>&lt;p>&lt;strong>æœ€ç»ˆåˆ¤æ–­é€»è¾‘ç”±æœåŠ¡ç«¯å®Œæˆ&lt;/strong>ã€‚&lt;/p>
&lt;p>â€¢ &lt;strong>æµè§ˆå™¨è¡Œä¸º&lt;/strong>ï¼ˆå®¢æˆ·ç«¯ï¼‰ï¼š&lt;br>
â€¢ æµè§ˆå™¨ä¼šç¼“å­˜èµ„æºï¼ˆå¦‚ HTMLã€å›¾ç‰‡ã€CSS ç­‰ï¼‰ï¼Œå¹¶æ ¹æ®æœåŠ¡ç«¯ä¹‹å‰è¿”å›çš„å“åº”å¤´ï¼ˆå¦‚ &lt;code>Cache-Control&lt;/code>ã€&lt;code>Expires&lt;/code>ã€&lt;code>ETag&lt;/code>ã€&lt;code>Last-Modified&lt;/code>ï¼‰å†³å®šæ˜¯å¦å‘èµ·&lt;strong>æ¡ä»¶è¯·æ±‚&lt;/strong>ã€‚&lt;br>
â€¢ å½“ç¼“å­˜è¿‡æœŸæˆ–é¡µé¢åˆ·æ–°ï¼ˆéå¼ºåˆ¶åˆ·æ–°ï¼‰æ—¶ï¼Œæµè§ˆå™¨ä¼šå‘æœåŠ¡ç«¯å‘é€ä¸€ä¸ªå¸¦æœ‰&lt;strong>éªŒè¯å¤´&lt;/strong>çš„è¯·æ±‚ï¼Œä¾‹å¦‚ï¼š&lt;br>
â—¦ &lt;code>If-None-Match&lt;/code>ï¼ˆå¯¹åº”æœåŠ¡ç«¯ä¹‹å‰è¿”å›çš„ &lt;code>ETag&lt;/code>ï¼‰&lt;br>
â—¦ &lt;code>If-Modified-Since&lt;/code>ï¼ˆå¯¹åº”æœåŠ¡ç«¯ä¹‹å‰è¿”å›çš„ &lt;code>Last-Modified&lt;/code>ï¼‰&lt;/p>
&lt;p>â€¢ &lt;strong>æœåŠ¡ç«¯è¡Œä¸º&lt;/strong>ï¼š&lt;br>
â€¢ æœåŠ¡ç«¯æ”¶åˆ°è¯·æ±‚åï¼Œæ ¹æ®å®¢æˆ·ç«¯çš„éªŒè¯å¤´ï¼ˆ&lt;code>If-None-Match&lt;/code> æˆ– &lt;code>If-Modified-Since&lt;/code>ï¼‰æ£€æŸ¥èµ„æºæ˜¯å¦å·²ä¿®æ”¹ã€‚&lt;br>
â€¢ &lt;strong>å¦‚æœèµ„æºæœªä¿®æ”¹&lt;/strong>ï¼Œè¿”å› &lt;strong>304 Not Modified&lt;/strong>ï¼Œä¸”ä¸è¿”å›èµ„æºå†…å®¹ï¼Œä»…è¿”å›å“åº”å¤´ã€‚&lt;br>
â€¢ &lt;strong>å¦‚æœèµ„æºå·²ä¿®æ”¹&lt;/strong>ï¼Œè¿”å› &lt;strong>200 OK&lt;/strong> å¹¶é™„å¸¦æ–°å†…å®¹ã€‚&lt;/p>
&lt;p>â€¢ &lt;strong>æµè§ˆå™¨&lt;/strong>ï¼šè´Ÿè´£å‘èµ·æ¡ä»¶è¯·æ±‚ï¼ˆæºå¸¦éªŒè¯å¤´ï¼‰ï¼Œå¹¶æ ¹æ®å“åº”çŠ¶æ€ç å†³å®šæ˜¯å¦ä½¿ç”¨ç¼“å­˜ã€‚&lt;br>
â€¢ &lt;strong>æœåŠ¡ç«¯&lt;/strong>ï¼šè´Ÿè´£éªŒè¯èµ„æºæ˜¯å¦ä¿®æ”¹ï¼Œå¹¶å†³å®šè¿”å› 304 æˆ– 200ã€‚&lt;/p>
&lt;ol>
&lt;li>ç”¨æˆ·é¦–æ¬¡è®¿é—®ç½‘é¡µï¼ŒæœåŠ¡ç«¯è¿”å›èµ„æºï¼Œå“åº”å¤´åŒ…å«ï¼š
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">1.1&lt;/span> &lt;span style="color:#ae81ff">200&lt;/span> &lt;span style="color:#a6e22e">OK&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ETag&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">&amp;#34;abc123&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Last-Modified&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">Wed, 01 Jan 2024 00:00:00 GMT&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Cache-Control&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">max-age=3600&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>ç”¨æˆ·å†æ¬¡è®¿é—®æ—¶ï¼Œæµè§ˆå™¨ç¼“å­˜æœªè¿‡æœŸï¼ˆ&lt;code>max-age=3600&lt;/code> å†…ï¼‰ï¼š&lt;br>
â€¢ ç›´æ¥ä½¿ç”¨ç¼“å­˜ï¼Œæ— éœ€è¯·æ±‚æœåŠ¡ç«¯ã€‚&lt;/li>
&lt;li>ç¼“å­˜è¿‡æœŸåï¼Œæµè§ˆå™¨å‘èµ·æ¡ä»¶è¯·æ±‚ï¼š
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">GET&lt;/span> /example.html &lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">1.1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>If-None-Match&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">&amp;#34;abc123&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>If-Modified-Since&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">Wed, 01 Jan 2024 00:00:00 GMT&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>æœåŠ¡ç«¯éªŒè¯èµ„æºæœªä¿®æ”¹ï¼Œè¿”å›ï¼š
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-http" data-lang="http">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">HTTP&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#ae81ff">1.1&lt;/span> &lt;span style="color:#ae81ff">304&lt;/span> &lt;span style="color:#a6e22e">Not Modified&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ETag&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">&amp;#34;abc123&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Last-Modified&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">Wed, 01 Jan 2024 00:00:00 GMT&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>æµè§ˆå™¨æ”¶åˆ° 304 åï¼Œç»§ç»­ä½¿ç”¨æœ¬åœ°ç¼“å­˜ã€‚&lt;/li>
&lt;/ol></description></item><item><title>Linux çš„CPUä¿æŠ¤ç¯ï¼Œä¸‰ç¯å’Œé›¶ç¯</title><link>https://jekyulll.github.io/posts/linux-linux-%E7%9A%84cpu%E4%BF%9D%E6%8A%A4%E7%8E%AF%E4%B8%89%E7%8E%AF%E5%92%8C%E9%9B%B6%E7%8E%AF/</link><pubDate>Sun, 30 Mar 2025 04:05:47 +0800</pubDate><guid>https://jekyulll.github.io/posts/linux-linux-%E7%9A%84cpu%E4%BF%9D%E6%8A%A4%E7%8E%AF%E4%B8%89%E7%8E%AF%E5%92%8C%E9%9B%B6%E7%8E%AF/</guid><description>&lt;p>Linuxç³»ç»Ÿä¸­çš„â€œä¸‰ç¯â€å’Œâ€œé›¶ç¯â€æ¦‚å¿µæºè‡ªCPUçš„&lt;strong>ä¿æŠ¤ç¯&lt;/strong>ï¼ˆProtection Ringsï¼‰æœºåˆ¶ï¼Œæ˜¯æ“ä½œç³»ç»Ÿå®ç°æƒé™éš”ç¦»å’Œå®‰å…¨ä¿æŠ¤çš„æ ¸å¿ƒè®¾è®¡ã€‚&lt;/p>
&lt;p>x86ä¿æŠ¤ç¯çš„å®Œæ•´ç»“æ„ä¸ºå››å±‚ï¼Œä½†å®é™…ä»…Ring 0å’ŒRing 3è¢«å¹¿æ³›ä½¿ç”¨ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;strong>é›¶ç¯&lt;/strong>ï¼ˆRing 0ï¼‰ï¼š
&lt;ul>
&lt;li>åˆç§°å†…æ ¸æ€ï¼Œæ˜¯CPUæƒé™æœ€é«˜çš„è¿è¡Œæ¨¡å¼ã€‚æ“ä½œç³»ç»Ÿå†…æ ¸è¿è¡Œäºæ­¤ç¯ï¼Œå¯ç›´æ¥è®¿é—®ç¡¬ä»¶èµ„æºï¼ˆå¦‚CPUã€å†…å­˜ã€I/Oè®¾å¤‡ï¼‰ï¼Œæ‰§è¡Œç‰¹æƒæŒ‡ä»¤ï¼ˆå¦‚ä¿®æ”¹å†…å­˜æ˜ å°„ã€ä¸­æ–­å¤„ç†ç­‰ï¼‰ã€‚ä¾‹å¦‚ï¼ŒLinuxå†…æ ¸çš„è¿›ç¨‹è°ƒåº¦ã€å†…å­˜ç®¡ç†å’Œè®¾å¤‡é©±åŠ¨å‡åœ¨æ­¤å±‚çº§è¿è¡Œã€‚&lt;/li>
&lt;li>é›¶ç¯å¯ç›´æ¥æ§åˆ¶ç¡¬ä»¶ï¼Œè€Œä¸‰ç¯çš„ä»£ç è‹¥è¯•å›¾æ‰§è¡Œç‰¹æƒæŒ‡ä»¤ï¼ˆå¦‚ç›´æ¥è¯»å†™ç£ç›˜ï¼‰ï¼ŒCPUä¼šè§¦å‘å¼‚å¸¸ï¼ˆå¦‚General Protection Faultï¼‰ï¼Œå¼ºåˆ¶ç»ˆæ­¢éæ³•æ“ä½œã€‚è¿™ç§è®¾è®¡é¿å…äº†ç”¨æˆ·ç¨‹åºç ´åç³»ç»Ÿç¨³å®šæ€§ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;strong>ä¸‰ç¯&lt;/strong>ï¼ˆRing 3ï¼‰ï¼š
&lt;ul>
&lt;li>åˆç§°ç”¨æˆ·æ€ï¼Œæ˜¯æƒé™æœ€ä½çš„å±‚çº§ã€‚æ™®é€šåº”ç”¨ç¨‹åºè¿è¡Œäºæ­¤ç¯ï¼Œä»…èƒ½é€šè¿‡ç³»ç»Ÿè°ƒç”¨ï¼ˆSyscallï¼‰è¯·æ±‚å†…æ ¸æœåŠ¡ï¼Œæ— æ³•ç›´æ¥æ“ä½œç¡¬ä»¶ã€‚ä¾‹å¦‚ï¼Œç”¨æˆ·å¯åŠ¨çš„æ–‡æœ¬ç¼–è¾‘å™¨ã€æµè§ˆå™¨ç­‰ç¨‹åºå‡å—æ­¤é™åˆ¶ã€‚&lt;/li>
&lt;li>ç”¨æˆ·ç¨‹åºé€šè¿‡ç³»ç»Ÿè°ƒç”¨æˆ–ç¡¬ä»¶ä¸­æ–­ä»ä¸‰ç¯åˆ‡æ¢åˆ°é›¶ç¯ã€‚ä¾‹å¦‚ï¼Œå½“ç¨‹åºè°ƒç”¨&lt;code>open()&lt;/code>å‡½æ•°æ‰“å¼€æ–‡ä»¶æ—¶ï¼Œä¼šè§¦å‘è½¯ä¸­æ–­ï¼ˆå¦‚&lt;code>int 0x80&lt;/code>æˆ–&lt;code>syscall&lt;/code>æŒ‡ä»¤ï¼‰ï¼Œå†…æ ¸æ¥ç®¡æ‰§è¡Œæ–‡ä»¶æ“ä½œï¼Œå®Œæˆåè¿”å›ç”¨æˆ·æ€ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>&lt;a href="https://blog.csdn.net/youyou1543724847/article/details/85048490">CPUçš„è¿è¡Œç¯, ç‰¹æƒçº§ä¸ä¿æŠ¤&lt;/a>ã€‚&lt;br>
&lt;a href="https://blog.csdn.net/farmwang/article/details/50094959">åŸæ–‡ â€”â€”CPUçš„è¿è¡Œç¯, ç‰¹æƒçº§ä¸ä¿æŠ¤&lt;/a>ã€‚&lt;br>
&lt;a href="https://blog.csdn.net/qq_26962739/article/details/133133574">Linuxå†…æ ¸å¼€å‘ä¹‹hookç³»ç»Ÿè°ƒç”¨&lt;/a>ã€‚&lt;br>
&lt;a href="https://www.cnblogs.com/onetrainee/p/11707130.html">ä¸‰ç¯è¿›å…¥é›¶ç¯çš„ç»†èŠ‚ï¼ˆKiFastCallEntryå‡½æ•°åˆ†æï¼‰&lt;/a>ã€‚&lt;br>
&lt;a href="https://blog.csdn.net/wxy_xx1/article/details/142953401">ç³»ç»Ÿè°ƒç”¨ä¹‹_KUSER_SHARED_DATA&lt;/a>ã€‚&lt;/p></description></item><item><title>forkå‡ºçš„å­è¿›ç¨‹æ˜¯å¦ç»§æ‰¿æ–‡ä»¶æè¿°ç¬¦è¡¨ï¼Ÿ</title><link>https://jekyulll.github.io/posts/linux-fork%E5%87%BA%E7%9A%84%E5%AD%90%E8%BF%9B%E7%A8%8B%E6%98%AF%E5%90%A6%E7%BB%A7%E6%89%BF%E6%96%87%E4%BB%B6%E6%8F%8F%E8%BF%B0%E7%AC%A6%E8%A1%A8/</link><pubDate>Sat, 29 Mar 2025 04:05:47 +0800</pubDate><guid>https://jekyulll.github.io/posts/linux-fork%E5%87%BA%E7%9A%84%E5%AD%90%E8%BF%9B%E7%A8%8B%E6%98%AF%E5%90%A6%E7%BB%A7%E6%89%BF%E6%96%87%E4%BB%B6%E6%8F%8F%E8%BF%B0%E7%AC%A6%E8%A1%A8/</guid><description>&lt;p>å½“é€šè¿‡ &lt;code>fork()&lt;/code> åˆ›å»ºå­è¿›ç¨‹æ—¶ï¼Œå­è¿›ç¨‹ä¼šè·å¾—çˆ¶è¿›ç¨‹æ–‡ä»¶æè¿°ç¬¦è¡¨çš„&lt;u>å®Œæ•´å‰¯æœ¬&lt;/u>ã€‚è¿™æ„å‘³ç€å­è¿›ç¨‹çš„æ–‡ä»¶æè¿°ç¬¦è¡¨ä¸­æ¯ä¸ªæ¡ç›®æŒ‡å‘çš„ ç³»ç»Ÿçº§æ–‡ä»¶è¡¨é¡¹ï¼ˆFile Table Entryï¼‰ä¸çˆ¶è¿›ç¨‹ç›¸åŒã€‚
çˆ¶å­è¿›ç¨‹å…±äº«æ–‡ä»¶è¡¨é¡¹ä¸­çš„æ–‡ä»¶åç§»é‡ï¼ˆOffsetï¼‰ã€æ‰“å¼€æ¨¡å¼ï¼ˆRead/Write Flagsï¼‰ã€æ–‡ä»¶çŠ¶æ€æ ‡å¿—ç­‰ä¿¡æ¯ã€‚ä¾‹å¦‚ï¼Œå¦‚æœçˆ¶è¿›ç¨‹å†™å…¥æ–‡ä»¶åç§»åŠ¨äº†åç§»é‡ï¼Œå­è¿›ç¨‹ä¼šä»æ–°çš„åç§»ä½ç½®ç»§ç»­æ“ä½œã€‚&lt;/p>
&lt;ul>
&lt;li>ä¿®æ”¹æ–‡ä»¶æè¿°ç¬¦è¡¨æœ¬èº«ï¼ˆå¦‚å…³é—­ &lt;code>fd&lt;/code>ï¼‰ï¼šå­è¿›ç¨‹çš„æ“ä½œä¸ä¼šå½±å“çˆ¶è¿›ç¨‹ã€‚ä¾‹å¦‚ï¼Œå­è¿›ç¨‹å…³é—­ fd=3ï¼Œçˆ¶è¿›ç¨‹çš„ fd=3 ä»ç„¶æœ‰æ•ˆã€‚&lt;/li>
&lt;li>ä¿®æ”¹å…±äº«çš„æ–‡ä»¶è¡¨é¡¹ï¼ˆå¦‚åç§»é‡ã€çŠ¶æ€æ ‡å¿—ï¼‰ï¼šå­è¿›ç¨‹çš„æ“ä½œä¼šç›´æ¥å½±å“çˆ¶è¿›ç¨‹ï¼Œå› ä¸ºå®ƒä»¬å…±äº«åŒä¸€æ–‡ä»¶è¡¨é¡¹ã€‚&lt;/li>
&lt;/ul>
&lt;p>&lt;a href="https://blog.csdn.net/DLUTBruceZhang/article/details/8802156">&lt;code>fork()&lt;/code>å­è¿›ç¨‹ä¸çˆ¶è¿›ç¨‹ä¹‹é—´çš„æ–‡ä»¶æè¿°ç¬¦é—®é¢˜&lt;/a>ã€‚&lt;br>
&lt;a href="https://blog.csdn.net/m0_73209194/article/details/130165449">ã€Linuxã€‘è¿›ç¨‹é—´é€šä¿¡&lt;/a>ã€‚&lt;/p>
&lt;blockquote>
&lt;p>æ–‡ä»¶æè¿°ç¬¦ç›¸å½“äºä¸€ä¸ªé€»è¾‘å¥æŸ„ï¼Œè€Œ&lt;code>open&lt;/code>ï¼Œ&lt;code>close&lt;/code>ç­‰å‡½æ•°åˆ™æ˜¯å°†æ–‡ä»¶æˆ–è€…ç‰©ç†è®¾å¤‡ä¸å¥æŸ„ç›¸å…³è”ã€‚&lt;/p>
&lt;/blockquote>
&lt;p>ä¸‰å¼ è¡¨ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;strong>æ–‡ä»¶æè¿°ç¬¦è¡¨&lt;/strong>ï¼šç”¨æˆ·åŒºçš„ä¸€éƒ¨åˆ†ï¼Œé™¤éé€šè¿‡ä½¿ç”¨æ–‡ä»¶æè¿°ç¬¦çš„å‡½æ•°ï¼Œå¦åˆ™ç¨‹åºæ— æ³•å¯¹å…¶è¿›è¡Œè®¿é—®ã€‚å¯¹è¿›ç¨‹ä¸­æ¯ä¸ªæ‰“å¼€çš„æ–‡ä»¶ï¼Œæ–‡ä»¶æè¿°ç¬¦è¡¨éƒ½åŒ…å«ä¸€ä¸ªæ¡ç›®ã€‚&lt;/li>
&lt;li>&lt;strong>ç³»ç»Ÿæ–‡ä»¶è¡¨&lt;/strong>ï¼šä¸ºç³»ç»Ÿä¸­æ‰€æœ‰çš„è¿›ç¨‹å…±äº«ã€‚å¯¹æ¯ä¸ªæ´»åŠ¨çš„open, å®ƒéƒ½åŒ…å«ä¸€ä¸ªæ¡ç›®ã€‚æ¯ä¸ªç³»ç»Ÿæ–‡ä»¶è¡¨çš„æ¡ç›®éƒ½åŒ…å«æ–‡ä»¶åç§»é‡ã€è®¿é—®æ¨¡å¼ï¼ˆè¯»ã€å†™ã€or è¯»-å†™ï¼‰ä»¥åŠæŒ‡å‘å®ƒçš„æ–‡ä»¶æè¿°ç¬¦è¡¨çš„æ¡ç›®è®¡æ•°ã€‚&lt;/li>
&lt;li>&lt;strong>å†…å­˜ç´¢å¼•èŠ‚ç‚¹è¡¨&lt;/strong>: å¯¹ç³»ç»Ÿä¸­çš„æ¯ä¸ªæ´»åŠ¨çš„æ–‡ä»¶ï¼ˆè¢«æŸä¸ªè¿›ç¨‹æ‰“å¼€äº†ï¼‰ï¼Œå†…å­˜ä¸­ç´¢å¼•èŠ‚ç‚¹è¡¨éƒ½åŒ…å«ä¸€ä¸ªæ¡ç›®ã€‚å‡ ä¸ªç³»ç»Ÿæ–‡ä»¶è¡¨æ¡ç›®å¯èƒ½å¯¹åº”äºåŒä¸€ä¸ªå†…å­˜ç´¢å¼•èŠ‚ç‚¹è¡¨ï¼ˆä¸åŒè¿›ç¨‹æ‰“å¼€åŒä¸€ä¸ªæ–‡ä»¶ï¼‰ã€‚&lt;/li>
&lt;/ul></description></item><item><title>Linuxé‡Œforkå‡ºå­è¿›ç¨‹çš„æ—¶å€™ï¼Œå“ªäº›å†…å®¹æ˜¯å…±äº«çš„ï¼Ÿ</title><link>https://jekyulll.github.io/posts/linux-linux%E9%87%8Cfork%E5%87%BA%E5%AD%90%E8%BF%9B%E7%A8%8B%E7%9A%84%E6%97%B6%E5%80%99%E5%93%AA%E4%BA%9B%E5%86%85%E5%AE%B9%E6%98%AF%E5%85%B1%E4%BA%AB%E7%9A%84/</link><pubDate>Thu, 27 Mar 2025 04:05:47 +0800</pubDate><guid>https://jekyulll.github.io/posts/linux-linux%E9%87%8Cfork%E5%87%BA%E5%AD%90%E8%BF%9B%E7%A8%8B%E7%9A%84%E6%97%B6%E5%80%99%E5%93%AA%E4%BA%9B%E5%86%85%E5%AE%B9%E6%98%AF%E5%85%B1%E4%BA%AB%E7%9A%84/</guid><description>&lt;h3 id="ä¸€å…±äº«çš„å†…å®¹">&lt;strong>ä¸€ã€å…±äº«çš„å†…å®¹&lt;/strong>&lt;/h3>
&lt;ol>
&lt;li>
&lt;p>&lt;strong>æ–‡ä»¶æè¿°ç¬¦ä¸æ–‡ä»¶çŠ¶æ€&lt;/strong>&lt;br>
å­è¿›ç¨‹ä¼šç»§æ‰¿çˆ¶è¿›ç¨‹å·²æ‰“å¼€çš„æ–‡ä»¶æè¿°ç¬¦è¡¨ï¼ŒåŒ…æ‹¬æ–‡ä»¶åç§»é‡ã€æ‰“å¼€æ¨¡å¼ï¼ˆå¦‚è¯»å†™æƒé™ï¼‰å’Œæ–‡ä»¶çŠ¶æ€æ ‡å¿—ï¼ˆå¦‚&lt;code>O_APPEND&lt;/code>ï¼‰ã€‚ä¾‹å¦‚ï¼Œè‹¥çˆ¶è¿›ç¨‹æ‰“å¼€äº†ä¸€ä¸ªæ–‡ä»¶å¹¶å†™å…¥æ•°æ®ï¼Œå­è¿›ç¨‹å¯é€šè¿‡ç›¸åŒçš„æ–‡ä»¶æè¿°ç¬¦ç»§ç»­æ“ä½œï¼Œä¸”ä¸¤è€…çš„å†™å…¥ä½ç½®ï¼ˆåç§»é‡ï¼‰ä¼šç›¸äº’å½±å“ã€‚&lt;br>
â€¢ &lt;strong>ç¤ºä¾‹åœºæ™¯&lt;/strong>ï¼šçˆ¶è¿›ç¨‹å‘æ–‡ä»¶å†™å…¥â€œParentâ€ï¼Œå­è¿›ç¨‹å†™å…¥â€œChildâ€ï¼Œæœ€ç»ˆæ–‡ä»¶å†…å®¹ä¼šæŒ‰æ“ä½œé¡ºåºåˆå¹¶ï¼ˆå¦‚â€œParentChildâ€æˆ–â€œChildParentâ€ï¼‰ï¼Œå…·ä½“å–å†³äºè°ƒåº¦é¡ºåºã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>ä¿¡å·å¤„ç†è®¾ç½®&lt;/strong>&lt;br>
å­è¿›ç¨‹ç»§æ‰¿çˆ¶è¿›ç¨‹çš„ä¿¡å·å¤„ç†å‡½æ•°ï¼ˆå¦‚&lt;code>SIG_IGN&lt;/code>æˆ–è‡ªå®šä¹‰å¤„ç†ç¨‹åºï¼‰å’Œä¿¡å·å±è”½é›†ï¼ˆ&lt;code>sigprocmask&lt;/code>çš„è®¾ç½®ï¼‰ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>ç”¨æˆ·èº«ä»½ä¸ç¯å¢ƒå˜é‡&lt;/strong>&lt;br>
å­è¿›ç¨‹ç»§æ‰¿çˆ¶è¿›ç¨‹çš„ç”¨æˆ·IDã€ç»„IDã€ç¯å¢ƒå˜é‡ã€å½“å‰å·¥ä½œç›®å½•ç­‰èº«ä»½ä¿¡æ¯ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>å†™æ—¶å¤åˆ¶ï¼ˆCopy-On-Writeï¼‰çš„å†…å­˜åˆå§‹çŠ¶æ€&lt;/strong>&lt;br>
åœ¨æœªå‘ç”Ÿå†™å…¥æ“ä½œå‰ï¼Œçˆ¶å­è¿›ç¨‹çš„ä»£ç æ®µï¼ˆ&lt;code>.text&lt;/code>ï¼‰ã€æ•°æ®æ®µï¼ˆ&lt;code>.data&lt;/code>ã€&lt;code>.bss&lt;/code>ï¼‰ã€å †ã€æ ˆç­‰å†…å­˜åŒºåŸŸå…±äº«åŒä¸€ç‰©ç†å†…å­˜é¡µã€‚ä¸€æ—¦æŸä¸€æ–¹å°è¯•ä¿®æ”¹æ•°æ®ï¼Œåˆ™ä¼šè§¦å‘å†™æ—¶å¤åˆ¶ï¼Œç”Ÿæˆç‹¬ç«‹çš„å‰¯æœ¬ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>æ–‡ä»¶é”&lt;/strong>&lt;br>
é€šè¿‡&lt;code>fcntl&lt;/code>æˆ–&lt;code>flock&lt;/code>è®¾ç½®çš„æ–‡ä»¶é”ä¼šè¢«å­è¿›ç¨‹ç»§æ‰¿ï¼Œçˆ¶å­è¿›ç¨‹å¯¹åŒä¸€æ–‡ä»¶çš„é”å®šæ“ä½œä¼šç›¸äº’å½±å“ã€‚&lt;/p>
&lt;/li>
&lt;/ol>
&lt;hr>
&lt;h3 id="äºŒä¸å…±äº«çš„å†…å®¹">&lt;strong>äºŒã€ä¸å…±äº«çš„å†…å®¹&lt;/strong>&lt;/h3>
&lt;ol>
&lt;li>
&lt;p>&lt;strong>è¿›ç¨‹ç‹¬ç«‹å±æ€§&lt;/strong>&lt;br>
å­è¿›ç¨‹æ‹¥æœ‰ç‹¬ç«‹çš„è¿›ç¨‹IDï¼ˆPIDï¼‰ã€çˆ¶è¿›ç¨‹IDï¼ˆPPIDï¼‰ã€è¿è¡Œæ—¶é—´ç»Ÿè®¡ã€æœªå†³ä¿¡å·é˜Ÿåˆ—ç­‰ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>å¤šçº¿ç¨‹ç¯å¢ƒä¸­çš„çº¿ç¨‹èµ„æº&lt;/strong>&lt;br>
è‹¥çˆ¶è¿›ç¨‹åŒ…å«å¤šä¸ªçº¿ç¨‹ï¼Œå­è¿›ç¨‹ä»…å¤åˆ¶æ‰§è¡Œ&lt;code>fork()&lt;/code>çš„çº¿ç¨‹ï¼Œå…¶ä»–çº¿ç¨‹ä¸ä¼šè¢«ç»§æ‰¿ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>ç‹¬ç«‹çš„å†…å­˜ä¿®æ”¹&lt;/strong>&lt;br>
é€šè¿‡å†™æ—¶å¤åˆ¶æœºåˆ¶ï¼Œçˆ¶å­è¿›ç¨‹å¯¹å†…å­˜çš„ä¿®æ”¹ä¼šå„è‡ªç‹¬ç«‹ã€‚ä¾‹å¦‚ï¼Œå…¨å±€å˜é‡åˆå§‹å€¼ç›¸åŒï¼Œä½†ä¿®æ”¹åäº’ä¸å½±å“ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>ç‹¬ç«‹çš„æ–‡ä»¶æè¿°ç¬¦å…³é—­æ“ä½œ&lt;/strong>&lt;br>
å­è¿›ç¨‹å…³é—­æŸä¸ªæ–‡ä»¶æè¿°ç¬¦ä¸ä¼šå½±å“çˆ¶è¿›ç¨‹çš„åŒåæè¿°ç¬¦ï¼Œåä¹‹äº¦ç„¶ã€‚&lt;/p>
&lt;/li>
&lt;/ol>
&lt;hr>
&lt;h3 id="ä¸‰å…³é”®æœºåˆ¶å†™æ—¶å¤åˆ¶cow">&lt;strong>ä¸‰ã€å…³é”®æœºåˆ¶ï¼šå†™æ—¶å¤åˆ¶ï¼ˆCOWï¼‰&lt;/strong>&lt;/h3>
&lt;p>å†…æ ¸é€šè¿‡å†™æ—¶å¤åˆ¶æŠ€æœ¯ä¼˜åŒ–æ€§èƒ½ï¼š&lt;br>
â€¢ &lt;strong>åŸç†&lt;/strong>ï¼š&lt;code>fork()&lt;/code>åï¼Œçˆ¶å­è¿›ç¨‹çš„é¡µè¡¨é¡¹æŒ‡å‘ç›¸åŒçš„ç‰©ç†å†…å­˜é¡µï¼Œå¹¶å°†è¿™äº›é¡µæ ‡è®°ä¸ºåªè¯»ã€‚å½“æŸä¸€è¿›ç¨‹å°è¯•å†™å…¥æ—¶ï¼Œè§¦å‘é¡µé”™è¯¯ï¼Œå†…æ ¸å¤åˆ¶è¯¥é¡µå¹¶ä¿®æ”¹æƒé™ä¸ºå¯å†™ã€‚&lt;br>
â€¢ &lt;strong>ä¼˜ç‚¹&lt;/strong>ï¼šé¿å…ä¸å¿…è¦çš„å†…å­˜å¤åˆ¶ï¼Œæé«˜èµ„æºåˆ©ç”¨ç‡ã€‚&lt;/p>
&lt;hr>
&lt;h3 id="å››åº”ç”¨æ³¨æ„äº‹é¡¹">&lt;strong>å››ã€åº”ç”¨æ³¨æ„äº‹é¡¹&lt;/strong>&lt;/h3>
&lt;ol>
&lt;li>&lt;strong>æ–‡ä»¶æ“ä½œåŒæ­¥&lt;/strong>ï¼šçˆ¶å­è¿›ç¨‹å¯¹åŒä¸€æ–‡ä»¶æè¿°ç¬¦çš„å¹¶å‘å†™å…¥éœ€é€šè¿‡é”ï¼ˆå¦‚&lt;code>flock()&lt;/code>ï¼‰æˆ–åŸå­æ“ä½œé¿å…ç«äº‰ã€‚&lt;/li>
&lt;li>&lt;strong>å†…å­˜å…±äº«é™åˆ¶&lt;/strong>ï¼šè‹¥éœ€ä¸»åŠ¨å…±äº«å†…å­˜ï¼Œéœ€ä½¿ç”¨&lt;code>mmap()&lt;/code>æˆ–å…±äº«å†…å­˜APIï¼ˆå¦‚&lt;code>shmget()&lt;/code>ï¼‰ã€‚&lt;/li>
&lt;li>&lt;strong>åƒµå°¸è¿›ç¨‹å¤„ç†&lt;/strong>ï¼šçˆ¶è¿›ç¨‹éœ€é€šè¿‡&lt;code>wait()&lt;/code>å›æ”¶å­è¿›ç¨‹èµ„æºï¼Œæˆ–æ³¨å†Œ&lt;code>SIGCHLD&lt;/code>ä¿¡å·å¤„ç†å‡½æ•°ã€‚&lt;/li>
&lt;/ol></description></item><item><title>æ–‡ä»¶é”ï¼ˆFileLockï¼‰çš„æœ¬è´¨ä¸ä»·å€¼</title><link>https://jekyulll.github.io/posts/cpp-%E6%96%87%E4%BB%B6%E9%94%81filelock%E7%9A%84%E6%9C%AC%E8%B4%A8%E4%B8%8E%E4%BB%B7%E5%80%BC/</link><pubDate>Wed, 26 Mar 2025 04:05:47 +0800</pubDate><guid>https://jekyulll.github.io/posts/cpp-%E6%96%87%E4%BB%B6%E9%94%81filelock%E7%9A%84%E6%9C%AC%E8%B4%A8%E4%B8%8E%E4%BB%B7%E5%80%BC/</guid><description>&lt;p>åœ¨å¤šè¿›ç¨‹/å¤šçº¿ç¨‹ç¯å¢ƒä¸­ï¼ŒMutexé’ˆå¯¹çš„æ˜¯ç¨‹åºå†…éƒ¨çš„å†…å­˜æ•°æ®ç»“æ„ï¼ˆå¦‚é“¾è¡¨ã€å“ˆå¸Œè¡¨ï¼‰ï¼Œæ— æ³•ç›´æ¥æ§åˆ¶å¤–éƒ¨èµ„æºï¼ˆå¦‚ç£ç›˜æ–‡ä»¶ï¼‰ã€‚ä¾‹å¦‚ï¼Œçº¿ç¨‹Aé€šè¿‡Mutexä¿æŠ¤ä¸€ä¸ªç¼“å­˜é˜Ÿåˆ—ï¼Œä½†è‹¥å¦ä¸€ä¸ªè¿›ç¨‹ç›´æ¥ä¿®æ”¹ç£ç›˜ä¸Šçš„å¯¹åº”æ–‡ä»¶ï¼ŒMutexæ— æ³•æ‹¦æˆªã€‚æ­¤æ—¶å¯ä»¥ç”¨æ–‡ä»¶é”æ¥è§£å†³ã€‚&lt;/p>
&lt;p>æ–‡ä»¶é”çš„æ ¸å¿ƒé€»è¾‘æ˜¯é€šè¿‡ç‹¬å æ ‡è®°åè°ƒèµ„æºè®¿é—®ã€‚&lt;/p>
&lt;p>&lt;strong>å…¸å‹åº”ç”¨åœºæ™¯&lt;/strong>ï¼š&lt;/p>
&lt;ol>
&lt;li>&lt;strong>é…ç½®æ–‡ä»¶çš„åŸå­æ€§æ›´æ–°&lt;/strong>&lt;br>
å¤šä¸ªæœåŠ¡å®ä¾‹åŒæ—¶ä¿®æ”¹åŒä¸€é…ç½®æ–‡ä»¶æ—¶ï¼ŒæœªåŠ é”ä¼šå¯¼è‡´æœ€åçš„å†™å…¥è¦†ç›–å…ˆå‰å†…å®¹ï¼ˆä¾‹å¦‚Nginxé…ç½®çƒ­æ›´æ–°ï¼‰&lt;/li>
&lt;li>&lt;strong>æ—¥å¿—æ–‡ä»¶çš„é¡ºåºå†™å…¥&lt;/strong>&lt;br>
å¤šçº¿ç¨‹æ—¥å¿—ç³»ç»Ÿä¸­ï¼Œä¸åŠ é”å¯èƒ½å¼•å‘æ—¥å¿—è¡Œäº¤é”™ï¼ˆå¦‚Apacheæ—¥å¿—æ»šåŠ¨çš„å¹¶å‘é—®é¢˜ï¼‰&lt;/li>
&lt;li>&lt;strong>åˆ†å¸ƒå¼ç³»ç»Ÿçš„èµ„æºåè°ƒ&lt;/strong>&lt;br>
åœ¨æ— ä¸­å¿ƒåŒ–é”æœåŠ¡æ—¶ï¼Œé€šè¿‡å…±äº«å­˜å‚¨ï¼ˆå¦‚NFSï¼‰çš„æ–‡ä»¶é”å®ç°åˆ†å¸ƒå¼é”ï¼ˆç±»ä¼¼ZooKeeperçš„ä¸´æ—¶èŠ‚ç‚¹æœºåˆ¶ï¼‰&lt;/li>
&lt;/ol>
&lt;hr>
&lt;h3 id="cå®ç°æ–‡ä»¶é”çš„ä¸‰ç§èŒƒå¼">C++å®ç°æ–‡ä»¶é”çš„ä¸‰ç§èŒƒå¼&lt;/h3>
&lt;h4 id="æ–¹æ¡ˆä¸€æ“ä½œç³»ç»ŸåŸç”Ÿapiå·¥ä¸šçº§æ–¹æ¡ˆ">&lt;strong>æ–¹æ¡ˆä¸€ï¼šæ“ä½œç³»ç»ŸåŸç”ŸAPIï¼ˆå·¥ä¸šçº§æ–¹æ¡ˆï¼‰&lt;/strong>&lt;/h4>
&lt;p>&lt;strong>é€‚ç”¨åœºæ™¯&lt;/strong>ï¼šéœ€è¦é«˜å¯é æ€§ã€è·¨å¹³å°å…¼å®¹çš„ç”Ÿäº§ç¯å¢ƒ&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;string&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;fcntl.h&amp;gt;&lt;/span>&lt;span style="color:#75715e"> &lt;/span>&lt;span style="color:#75715e">// Linux
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;windows.h&amp;gt;&lt;/span>&lt;span style="color:#75715e"> &lt;/span>&lt;span style="color:#75715e">// Windows
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">class&lt;/span> &lt;span style="color:#a6e22e">NativeFileLock&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">public&lt;/span>&lt;span style="color:#f92672">:&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">explicit&lt;/span> NativeFileLock(&lt;span style="color:#66d9ef">const&lt;/span> std&lt;span style="color:#f92672">::&lt;/span>string&lt;span style="color:#f92672">&amp;amp;&lt;/span> path) &lt;span style="color:#f92672">:&lt;/span> lock_path(path) {}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">bool&lt;/span> &lt;span style="color:#a6e22e">acquire&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#ifdef _WIN32
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75715e">// Windowsé€šè¿‡ç‹¬å æ¨¡å¼åˆ›å»ºæ–‡ä»¶å®ç°é”
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> h_file &lt;span style="color:#f92672">=&lt;/span> CreateFileA(lock_path.c_str(), GENERIC_WRITE, &lt;span style="color:#ae81ff">0&lt;/span>, 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">nullptr&lt;/span>, CREATE_ALWAYS, FILE_ATTRIBUTE_HIDDEN, &lt;span style="color:#66d9ef">nullptr&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> h_file &lt;span style="color:#f92672">!=&lt;/span> INVALID_HANDLE_VALUE;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#else
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75715e">// Linuxä½¿ç”¨fcntlè®°å½•é”
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> fd &lt;span style="color:#f92672">=&lt;/span> open(lock_path.c_str(), O_RDWR &lt;span style="color:#f92672">|&lt;/span> O_CREAT, &lt;span style="color:#ae81ff">0644&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (fd &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>) &lt;span style="color:#66d9ef">return&lt;/span> false;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> flock lock_struct{};
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> lock_struct.l_type &lt;span style="color:#f92672">=&lt;/span> F_WRLCK; &lt;span style="color:#75715e">// æ’ä»–é”
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> lock_struct.l_whence &lt;span style="color:#f92672">=&lt;/span> SEEK_SET;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> fcntl(fd, F_SETLK, &lt;span style="color:#f92672">&amp;amp;&lt;/span>lock_struct) &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#endif
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">void&lt;/span> &lt;span style="color:#a6e22e">release&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#ifdef _WIN32
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> CloseHandle(h_file);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> DeleteFileA(lock_path.c_str());
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#else
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> close(fd);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> unlink(lock_path.c_str());
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#endif
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">private&lt;/span>&lt;span style="color:#f92672">:&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#ifdef _WIN32
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> HANDLE h_file &lt;span style="color:#f92672">=&lt;/span> INVALID_HANDLE_VALUE;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#else
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">int&lt;/span> fd &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#endif
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> std&lt;span style="color:#f92672">::&lt;/span>string lock_path;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;strong>æŠ€æœ¯è¦ç‚¹&lt;/strong>ï¼š&lt;br>
â€¢ Windowsé€šè¿‡&lt;code>CREATE_ALWAYS&lt;/code>+éšè—å±æ€§å®ç°åŸå­åˆ›å»º&lt;br>
â€¢ Linuxä½¿ç”¨&lt;code>fcntl&lt;/code>çš„è®°å½•é”ï¼Œæ”¯æŒå¯¹æ–‡ä»¶éƒ¨åˆ†åŒºåŸŸåŠ é”&lt;br>
â€¢ å¿…é¡»å¤„ç†è¿›ç¨‹å´©æºƒåçš„é”æ®‹ç•™ï¼ˆé€šè¿‡&lt;code>unlink/DeleteFile&lt;/code>ç‰©ç†åˆ é™¤é”æ–‡ä»¶ï¼‰&lt;/p></description></item><item><title>æ›´æ–°çš„äºŒè¿›åˆ¶å·®å¼‚ç®—æ³•</title><link>https://jekyulll.github.io/posts/alg-%E6%9B%B4%E6%96%B0%E7%9A%84%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%B7%AE%E5%BC%82%E7%AE%97%E6%B3%95/</link><pubDate>Wed, 26 Mar 2025 04:05:47 +0800</pubDate><guid>https://jekyulll.github.io/posts/alg-%E6%9B%B4%E6%96%B0%E7%9A%84%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%B7%AE%E5%BC%82%E7%AE%97%E6%B3%95/</guid><description>&lt;p>æ›¿æ¢ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶æœ‰ä»¥ä¸‹ä¸¤ä¸ªæ€è·¯ï¼š&lt;/p>
&lt;p>ä½¿ç”¨å®Œæ•´çš„ä¸€ä¸ªæ–°æ–‡ä»¶ç›´æ¥è¦†ç›–æ—§çš„æ–‡ä»¶ã€‚
åªæ›¿æ¢æ–°æ—§æ–‡ä»¶ä¹‹é—´çš„å·®å¼‚ã€‚é€šè¿‡ç®—æ³•å»è®¡ç®—æ–°æ—§æ–‡ä»¶ä¹‹é—´çš„å·®å¼‚ï¼Œç„¶åå°†å·®å¼‚éƒ¨åˆ†ç§»åŠ¨åˆ°ç›®æ ‡æœºå™¨ä¸Šã€‚
å…¶ä¸­æ–¹æ³•ä¸€åˆ¶ä½œçš„æ›´æ–°å°±å«åšå…¨é‡æ›´æ–°ï¼ˆFull Updateï¼‰ã€‚è€Œæ–¹æ³•äºŒå°±æ˜¯äºŒè¿›åˆ¶å·®åˆ†æ–¹å¼ï¼Œå³å¢é‡æ›´æ–°ï¼ˆDelta Updateï¼‰ã€‚&lt;/p>
&lt;hr>
&lt;h2 id="å¢é‡æ›´æ–°">å¢é‡æ›´æ–°&lt;/h2>
&lt;p>å¢é‡æ›´æ–°æœ‰ä¸¤ä¸ªæ–¹å¼ï¼š&lt;strong>æ–‡ä»¶å·®é‡æ›´æ–°&lt;/strong>ã€&lt;strong>äºŒè¿›åˆ¶å·®é‡æ›´æ–°&lt;/strong>ã€‚&lt;br>
å¤§éƒ¨åˆ†çš„å¤§è½¯ä»¶ï¼Œå¦‚ QQ ç­‰ï¼Œéƒ½ä¼šåœ¨è‡ªåŠ¨æ›´æ–°çš„æ—¶å€™éƒ½ä¼šä½¿ç”¨æ–‡ä»¶å·®é‡æ›´æ–°å’ŒäºŒè¿›åˆ¶å·®é‡æ›´æ–°ä¸€èµ·ä½¿ç”¨çš„ç­–ç•¥ã€‚&lt;/p>
&lt;p>äºŒè¿›åˆ¶å·®åˆ†æ›´æ–°å¯¹äºå°±æ–‡ä»¶çš„çŠ¶æ€æœ‰ä¸¥æ ¼çš„è¦æ±‚ï¼Œè¿™æ˜¯å› ä¸ºä¸åŒç‰ˆæœ¬ä¹‹é—´çš„äºŒè¿›åˆ¶å·®å¼‚ä¸åŒã€‚&lt;br>
ä¸¾ä¸ªä¾‹å­ï¼šæŸä¸ªæ–°çš„æ–‡ä»¶Açš„ç‰ˆæœ¬æ˜¯3ï¼Œéœ€è¦æ›´æ–°åˆ°ç”¨æˆ·çš„æœºå™¨ä¸Šã€‚ä½†æ˜¯éƒ¨åˆ†ç”¨æˆ·æœºå™¨ä¸Šå®‰è£…çš„æ–‡ä»¶Aç‰ˆæœ¬æ˜¯1ï¼Œéƒ¨åˆ†ç”¨æˆ·çš„æ–‡ä»¶Aæ˜¯ç‰ˆæœ¬2ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œå°±éœ€è¦åˆ†åˆ«è®¡ç®—ç‰ˆæœ¬3å’Œç‰ˆæœ¬1çš„å·®å¼‚ï¼Œä»¥åŠç‰ˆæœ¬3å’Œç‰ˆæœ¬2çš„å·®å¼‚ã€‚ç„¶åæ ¹æ®ä¸åŒç”¨æˆ·çš„æƒ…å†µåˆ†åˆ«å‘é€ä¸åŒçš„äºŒè¿›åˆ¶å·®å¼‚æ–‡ä»¶ã€‚&lt;br>
æƒ³è¦è¿›è¡Œå¢é‡æ›´æ–°ï¼Œéœ€è¦æ„å»ºæ¨¡å—æ”¯æŒæ‰èƒ½å®ç°ã€‚ç¡®å®šæ€§æ„å»ºå°±æ˜¯åœ¨ä»£ç æ²¡æœ‰å˜æ›´çš„æ—¶å€™ï¼Œæ„å»ºè¾“å‡ºçš„ DLL æˆ– Exe ä¸€å®šæ˜¯ä¸å˜çš„ã€‚å¯¹åº”çš„ï¼Œè¿˜åº”åŠ å…¥ç¡®å®šæ€§æ··æ·†çš„æ”¯æŒï¼Œæœ‰ä¸€äº›ä»£ç æ¥å…¥äº†æ··æ·†è¿‡ç¨‹ï¼Œè¦æ±‚åœ¨ä»£ç æ²¡æœ‰å˜æ›´çš„æ—¶å€™ï¼Œæœ€åæ··æ·†è¾“å‡ºçš„æ–‡ä»¶ä¹Ÿæ²¡æœ‰å˜æ›´ã€‚&lt;/p>
&lt;p>å¢é‡æ›´æ–°ä¸èƒ½çƒ­æ›´æ–°ï¼Œéœ€è¦é‡å¯æ‰èƒ½ç”Ÿæ•ˆã€‚&lt;/p>
&lt;p>ç”¨åˆ°çš„ç®—æ³•ä¸»è¦æœ‰&lt;a href="https://www.daemonology.net/bsdiff/">bsdiff&lt;/a>ï¼Œ&lt;a href="https://github.com/OctopusDeploy/Octodiff">octodiff&lt;/a>ï¼Œxdeltaã€‚&lt;/p>
&lt;p>bsdiff ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦å’Œç©ºé—´å¤æ‚åº¦éƒ½å¾ˆé«˜ã€‚ä½†ä¼˜ç‚¹æ˜¯æ›´æ–°æ–‡ä»¶å¤§å°æ¯”è¾ƒå°ã€‚&lt;/p>
&lt;blockquote>
&lt;p>å¤„ç†å¤§æ–‡ä»¶é€‰æ‹©Octodiffï¼Œå¤„ç†å°æ–‡ä»¶é€‰æ‹©bsdiff.&lt;/p>
&lt;/blockquote>
&lt;hr>
&lt;h2 id="æ­£å‘é€†å‘å·®åˆ†æŠ€æœ¯">æ­£å‘/é€†å‘å·®åˆ†æŠ€æœ¯&lt;/h2>
&lt;p>åœ¨æ­¤ä¹‹å‰ï¼Œä¸ºäº†è§£å†³Windowsç´¯ç§¯æ›´æ–°ä½“ç§¯è¿‡å¤§çš„é—®é¢˜ï¼Œå¾®è½¯ä½¿ç”¨çš„æ˜¯Express UpdateæŠ€æœ¯ã€‚ExpressæŠ€æœ¯ç¡®å®å‡å°äº†ç´¯ç§¯æ›´æ–°çš„ä½“ç§¯ï¼Œä½†æ˜¯å´æå¤§çš„å¢åŠ äº†Windowæ›´æ–°æœåŠ¡å™¨çš„è®¡ç®—å‹åŠ›ä¸å­˜å‚¨å‹åŠ›ã€‚Expressæ›´æ–°æ–‡ä»¶åœ¨æ›´æ–°æœåŠ¡å™¨ä¸Šé€šå¸¸ä¼šæœ‰å¤§äº10GBçš„ä½“ç§¯ã€‚Express Updateæ­£æ˜¯ä½¿ç”¨çš„å¢é‡æ›´æ–°æ–¹å¼ï¼Œå¹¶ä¸”æŠŠæ‰€æœ‰æ–‡ä»¶çš„æ‰€æœ‰ç‰ˆæœ¬å·®å¼‚éƒ½å­˜å‚¨åˆ°äº†æ›´æ–°æœåŠ¡å™¨ä¸Šï¼ˆæµ·é‡çš„æ–‡ä»¶ï¼‰ã€‚&lt;/p>
&lt;p>Windows 10 1809ç‰ˆæœ¬ä¹‹åå¼•å…¥äº†åŸºäºäºŒè¿›åˆ¶çš„æ­£å‘/é€†å‘å·®åˆ†æŠ€æœ¯ã€‚&lt;/p>
&lt;p>äºŒè¿›åˆ¶å·®åˆ†æ˜¯éœ€è¦ä¸¥æ ¼æ¯”å¯¹æ–‡ä»¶çš„ç‰ˆæœ¬ä¿¡æ¯çš„ã€‚å¦‚æœè¢«æ›¿æ¢æ–‡ä»¶çš„ç‰ˆæœ¬ä¸ç¡®å®šï¼Œé‚£ä¹ˆå°±æ— æ³•åº”ç”¨äºŒè¿›åˆ¶å·®åˆ†ã€‚å¦‚æœæœ¬æ›¿æ¢æ–‡ä»¶çš„ç‰ˆæœ¬éå¸¸å¤šï¼Œé‚£ä¹ˆå°±éœ€è¦é’ˆå¯¹æ¯ä¸€ä¸ªç‰ˆæœ¬åˆ†åˆ«è®¡ç®—äºŒè¿›åˆ¶å·®åˆ†ï¼Œè¿™æ ·ä¸€æ¥ï¼Œä¸åŒç‰ˆæœ¬çš„äºŒè¿›åˆ¶å·®åˆ†çš„æ€»å’Œä½“ç§¯ä¹Ÿå¿…ç„¶ä¸ä¼šå°ï¼Œå› æ­¤å°±æŠµæ¶ˆæ‰å·®åˆ†å¸¦æ¥çš„ä½“ç§¯ä¼˜åŠ¿ã€‚&lt;/p>
&lt;p>æ­£å‘/é€†å‘å·®åˆ†æŠ€æœ¯çš„æ ¸å¿ƒæ€è·¯æ˜¯ï¼šå°†è¢«æ›¿æ¢æ–‡ä»¶çš„ç‰ˆæœ¬å›ºå®šï¼Œè¿™æ ·å°±èƒ½å”¯ä¸€ç¡®å®šä¸€ä¸ªäºŒè¿›åˆ¶å·®åˆ†äº†ã€‚é‚£ä¹ˆï¼Œå°†è¢«æ›¿æ¢çš„æ–‡ä»¶ç‰ˆæœ¬å›ºå®šæˆä»€ä¹ˆç‰ˆæœ¬å‘¢ï¼Ÿ&lt;br>
Windowsæ›´æ–°ç”¨çš„æ–¹æ³•æ˜¯ï¼Œå°†æ‰€æœ‰éœ€è¦è¢«æ›´æ–°çš„æ–‡ä»¶ç‰ˆæœ¬å›åˆ°Windows 10 åŸºçº¿ç‰ˆæœ¬ ã€‚ç„¶åï¼Œä»åŸºçº¿ç‰ˆæœ¬å®‰è£…äºŒè¿›åˆ¶å·®åˆ†ï¼Œå®Œæˆæ–‡ä»¶çš„æ›´æ–°ã€‚&lt;br>
è¿™é‡Œï¼Œä»å½“å‰çš„æ–‡ä»¶ç‰ˆæœ¬å›é€€åˆ°åŸºçº¿ç‰ˆæœ¬çš„è¿‡ç¨‹è¢«ç§°ä¸º&lt;strong>é€†å‘&lt;/strong>ï¼Œä»åŸºçº¿ç‰ˆæœ¬æ›´æ–°åˆ°æœ€æ–°çš„ç‰ˆæœ¬çš„è¿‡ç¨‹ç§°ä¸º&lt;strong>æ­£å‘&lt;/strong>ï¼Œä¹Ÿè¢«ç§°ä¸º&lt;strong>æ³¨æ°´&lt;/strong>ï¼ˆhydrationï¼‰ã€‚åˆ¶ä½œå·®åˆ†äºŒè¿›åˆ¶å«åš&lt;strong>è„±æ°´&lt;/strong>ï¼ˆdehydrationï¼‰ã€‚&lt;br>
è¿™ä¸¤æ¬¡æ–‡ä»¶æ›´æ–°çš„è¡Œä¸ºéƒ½ä½¿ç”¨å·®åˆ†äºŒè¿›åˆ¶æ¥å®Œæˆï¼Œå› æ­¤è¿™å°±æ˜¯æ­£å‘/é€†å‘äºŒè¿›åˆ¶å·®åˆ†æŠ€æœ¯ã€‚&lt;/p>
&lt;p>æ ¸å¿ƒé€»è¾‘åœ¨äºé€šè¿‡å›ºå®šåŸºçº¿ç‰ˆæœ¬ï¼ˆRTMï¼‰ä½œä¸ºå”¯ä¸€ä¸­é—´çŠ¶æ€ï¼Œè§„é¿å¤šç‰ˆæœ¬ç»„åˆå¸¦æ¥çš„å·®åˆ†æ•°çˆ†ç‚¸é—®é¢˜ã€‚&lt;br>
è¿™æ ·åªéœ€è¦å­˜å‚¨ä¸€ä¸ªå½“å‰ç‰ˆæœ¬åˆ°åŸºçº¿ç‰ˆæœ¬çš„äºŒè¿›åˆ¶å·®åˆ†ï¼Œç„¶åç»Ÿä¸€ä»åŸºçº¿ç‰ˆæœ¬å‡çº§åˆ°æ–°ç‰ˆæœ¬ã€‚&lt;br>
ï¼ˆ&lt;em>eg&lt;/em>. ä¾‹å¦‚æœ‰0ã€1ã€2ã€3ã€4ç‰ˆæœ¬ã€‚å¦‚æœç”¨è€åŠæ³•ï¼Œéœ€è¦å­˜å‚¨0-&amp;gt;1ï¼Œ0-&amp;gt;2ï¼Œ0-&amp;gt;3ï¼Œ0-&amp;gt;4ï¼Œ1-&amp;gt;2ï¼Œ1-&amp;gt;3ï¼Œ1-&amp;gt;4ï¼Œ2-&amp;gt;3ï¼Œ2-&amp;gt;4ï¼Œ3-&amp;gt;4çš„å·®åˆ†åŒ…ï¼Œå¤šäº†ä¹‹åæ•°é‡çˆ†ç‚¸ï¼Œå› ä¸º&lt;u>å¢åŠ æ–°ç‰ˆæœ¬çš„æ—¶å€™éœ€è¦å­˜å‚¨ä¹‹å‰æ‰€æœ‰ç‰ˆæœ¬åˆ°æ–°ç‰ˆæœ¬çš„å·®åˆ†åŒ…&lt;/u>ã€‚&lt;br>
å¦‚æœé‡‡ç”¨æ­£å‘/é€†å‘å·®åˆ†ï¼Œè¦å­˜å‚¨1-&amp;gt;0ï¼Œ2-&amp;gt;0ï¼Œ3-&amp;gt;0ï¼Œ4-&amp;gt;0ï¼Œç„¶åå­˜å‚¨0-&amp;gt;1ï¼Œ0-&amp;gt;2ï¼Œ0-&amp;gt;3ï¼Œ0-&amp;gt;4ã€‚å¢åŠ æ–°ç‰ˆæœ¬çš„æ—¶å€™ï¼Œåªéœ€è¦å¢åŠ 5-&amp;gt;0å’Œ0-&amp;gt;5ï¼Œä»nçš„ç´¯åŠ ä¼˜åŒ–åˆ°äº†nçš„çº¿æ€§å…³ç³»çš„å·®åˆ†åŒ…æ•°é‡ã€‚&lt;br>
ï¼‰&lt;/p>
&lt;p>åŸºäºæ­£å‘/é€†å‘äºŒè¿›åˆ¶å·®åˆ†çš„Windowsç´¯ç§¯æ›´æ–°å†…éƒ¨åŒ…å«ä»¥ä¸‹å†…å®¹ï¼š&lt;/p>
&lt;ul>
&lt;li>ä»åŸºçº¿ç‰ˆæœ¬åˆ°æœ€æ–°ç‰ˆæœ¬Nçš„æ­£å‘äºŒè¿›åˆ¶å·®åˆ†æ–‡ä»¶&lt;/li>
&lt;li>å›é€€åˆ°åŸºçº¿ç‰ˆæœ¬æ‰€éœ€çš„é€†å‘äºŒè¿›åˆ¶å·®åˆ†æ–‡ä»¶&lt;/li>
&lt;li>æ›´æ–°æ–‡ä»¶æ¸…å•ï¼ˆManifestï¼‰&lt;/li>
&lt;li>æ›´æ–°æ–‡ä»¶Metadata&lt;/li>
&lt;/ul>
&lt;p>å¦‚æœæ˜¯ç¦»çº¿æ›´æ–°MSUï¼Œè¿˜ä¼šå¤šä¸€äº›ç‰ˆæœ¬ä»¥åŠæ“ä½œç³»ç»Ÿé€‚åº”æ€§åˆ¤æ–­çš„å†…å®¹ã€‚&lt;/p>
&lt;hr>
&lt;h3 id="source--reference">Source &amp;amp;&amp;amp; Reference&lt;/h3>
&lt;p>&lt;a href="https://zhuanlan.zhihu.com/p/13382743061">äºŒè¿›åˆ¶å·®å¼‚æ–‡ä»¶ç®—æ³•&lt;/a>ã€‚&lt;/p>
&lt;p>&lt;a href="https://github.com/Squirrel/Squirrel.Windows">Squirrel.Windows: An installation and update framework for Windows desktop apps&lt;/a>ã€‚&lt;/p>
&lt;p>&lt;a href="https://zhuyie.github.io/posts/bsdiff-annotated/">bsdiffæºç è§£æ&lt;/a>ã€‚&lt;/p>
&lt;p>è¿™æ®µæ—¶é—´çœ‹åˆ°çš„æœ€ç‰›é€¼çš„æ–‡ç« ï¼š&lt;a href="https://jishuzhan.net/article/1874273746852777985#google_vignette">Windows å®¢æˆ·ç«¯è½¯ä»¶è‡ªåŠ¨æ›´æ–°æœåŠ¡çš„å¼€å‘æœ‰å“ªäº›éœ€æ±‚ï¼Ÿ&lt;/a>ã€‚&lt;/p>
&lt;p>å¾®è½¯å®˜æ–¹å¯¹æ­£å‘/é€†å‘äºŒè¿›åˆ¶å·®åˆ†Updatesçš„ä»‹ç»ï¼š&lt;a href="https://learn.microsoft.com/en-us/windows/deployment/update/forward-reverse-differentials">Windows Updates using forward and reverse differentials&lt;/a>ã€‚&lt;/p></description></item><item><title>Nginx çš„å¤šè¿›ç¨‹æ¨¡å‹</title><link>https://jekyulll.github.io/posts/web-nginx-%E7%9A%84%E5%A4%9A%E8%BF%9B%E7%A8%8B%E6%A8%A1%E5%9E%8B/</link><pubDate>Fri, 21 Mar 2025 12:05:47 +0800</pubDate><guid>https://jekyulll.github.io/posts/web-nginx-%E7%9A%84%E5%A4%9A%E8%BF%9B%E7%A8%8B%E6%A8%A1%E5%9E%8B/</guid><description>&lt;p>åœ¨WebæœåŠ¡å™¨é¢†åŸŸï¼ŒNginxå‡­å€Ÿå…¶é«˜å¹¶å‘ã€ä½èµ„æºæ¶ˆè€—çš„ç‰¹ç‚¹è„±é¢–è€Œå‡ºã€‚å…¶æ ¸å¿ƒè®¾è®¡é€‰æ‹©ä¹‹ä¸€ä¾¿æ˜¯&lt;strong>å¤šè¿›ç¨‹æ¨¡å‹&lt;/strong>ã€‚è¿™ä¸€è®¾è®¡çœ‹ä¼¼ä¸ä¼ ç»Ÿå¤šçº¿ç¨‹æ¨¡å‹èƒŒé“è€Œé©°ï¼Œå´æ°æ°æˆå°±äº†Nginxçš„å“è¶Šæ€§èƒ½ã€‚æœ¬æ–‡å°†ä»æŠ€æœ¯åŸç†ã€åœºæ™¯é€‚é…ã€æ¶æ„æƒè¡¡ç­‰è§’åº¦ï¼Œæ·±åº¦è§£æNginxåçˆ±å¤šè¿›ç¨‹çš„åº•å±‚é€»è¾‘ã€‚&lt;/p>
&lt;hr>
&lt;h4 id="ä¸€å¤šè¿›ç¨‹æ¨¡å‹çš„æ ¸å¿ƒæ¶æ„">ä¸€ã€å¤šè¿›ç¨‹æ¨¡å‹çš„æ ¸å¿ƒæ¶æ„&lt;/h4>
&lt;p>Nginxé‡‡ç”¨ç»å…¸çš„&lt;strong>Master-Workerå¤šè¿›ç¨‹æ¶æ„&lt;/strong>ï¼š&lt;/p>
&lt;ol>
&lt;li>&lt;strong>Masterè¿›ç¨‹&lt;/strong>ï¼šè´Ÿè´£å…¨å±€ç®¡ç†ï¼ŒåŒ…æ‹¬é…ç½®åŠ è½½ã€ä¿¡å·å¤„ç†ã€Workerè¿›ç¨‹ç›‘æ§ä¸é‡å¯ã€‚&lt;/li>
&lt;li>&lt;strong>Workerè¿›ç¨‹&lt;/strong>ï¼šå®é™…å¤„ç†è¯·æ±‚çš„â€œæˆ˜æ–—å•å…ƒâ€ï¼Œæ¯ä¸ªWorkerç‹¬ç«‹è¿è¡Œä¸”ç»‘å®šåˆ°ç‰¹å®šCPUæ ¸å¿ƒï¼Œé€šè¿‡&lt;strong>å¼‚æ­¥éé˜»å¡äº‹ä»¶é©±åŠ¨æ¨¡å‹&lt;/strong>å¤„ç†æˆåƒä¸Šä¸‡çš„å¹¶å‘è¿æ¥ã€‚&lt;br>
è¿™ç§è®¾è®¡å®ç°äº†&lt;strong>èµ„æºéš”ç¦»&lt;/strong>ä¸&lt;strong>èŒè´£åˆ†ç¦»&lt;/strong>ï¼ŒMasterçš„ç¨³å®šæ€§ä¸å—Workerä¸šåŠ¡é€»è¾‘å½±å“ï¼ŒWorkerçš„å´©æºƒä¹Ÿä¸ä¼šå¯¼è‡´æœåŠ¡ä¸­æ–­ã€‚&lt;/li>
&lt;/ol>
&lt;hr>
&lt;h4 id="äºŒé€‰æ‹©å¤šè¿›ç¨‹çš„äº”å¤§æ ¸å¿ƒåŸå› ">äºŒã€é€‰æ‹©å¤šè¿›ç¨‹çš„äº”å¤§æ ¸å¿ƒåŸå› &lt;/h4>
&lt;h5 id="1-æœ€å¤§åŒ–å¤šæ ¸cpuåˆ©ç”¨ç‡">1. &lt;strong>æœ€å¤§åŒ–å¤šæ ¸CPUåˆ©ç”¨ç‡&lt;/strong>&lt;/h5>
&lt;p>ç°ä»£æœåŠ¡å™¨æ™®éé‡‡ç”¨å¤šæ ¸æ¶æ„ï¼ŒNginxé€šè¿‡ä¸ºæ¯ä¸ªWorkerè¿›ç¨‹ç»‘å®šç‹¬ç«‹CPUæ ¸å¿ƒï¼Œé¿å…äº†çº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢çš„å¼€é”€ï¼Œä½¿ç¡¬ä»¶èµ„æºè¢«å……åˆ†è°ƒåº¦ã€‚ä¾‹å¦‚ï¼Œ8æ ¸æœåŠ¡å™¨å¯å¯åŠ¨8ä¸ªWorkerï¼Œæ¯ä¸ªè¿›ç¨‹ç‹¬å ä¸€æ ¸æ‰§è¡Œæ— é”åŒ–ä»»åŠ¡å¤„ç†ã€‚&lt;/p>
&lt;h5 id="2-è§„é¿å¤šçº¿ç¨‹é”ç«äº‰">2. &lt;strong>è§„é¿å¤šçº¿ç¨‹é”ç«äº‰&lt;/strong>&lt;/h5>
&lt;p>å¤šçº¿ç¨‹æ¨¡å‹ä¸­ï¼Œå…±äº«å†…å­˜çš„è®¿é—®éœ€é€šè¿‡é”æœºåˆ¶åŒæ­¥ï¼Œè€Œé”ç«äº‰ä¼šå¯¼è‡´æ€§èƒ½æ€¥å‰§ä¸‹é™ã€‚Nginxçš„å¤šè¿›ç¨‹æ¨¡å‹å¤©ç„¶éš”ç¦»äº†å†…å­˜ç©ºé—´ï¼ŒWorkerä¹‹é—´æ— éœ€åŠ é”ï¼Œæ¶ˆé™¤äº†è¿™ä¸€æ€§èƒ½ç“¶é¢ˆã€‚&lt;/p>
&lt;h5 id="3-æ•…éšœéš”ç¦»ä¸é«˜å¯ç”¨æ€§">3. &lt;strong>æ•…éšœéš”ç¦»ä¸é«˜å¯ç”¨æ€§&lt;/strong>&lt;/h5>
&lt;p>è‹¥æŸä¸ªWorkerè¿›ç¨‹å› ä»£ç ç¼ºé™·å´©æºƒï¼ŒMasterè¿›ç¨‹å¯ç«‹å³é‡å¯æ–°Workerï¼Œå…¶ä»–è¿›ç¨‹ä»æ­£å¸¸æœåŠ¡ã€‚è¿™ç§â€œå•ç‚¹æ•…éšœä¸å½±å“å…¨å±€â€çš„ç‰¹æ€§ï¼Œæ˜¾è‘—æå‡äº†ç³»ç»Ÿçš„å®¹é”™èƒ½åŠ›ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œå¤šçº¿ç¨‹æ¨¡å‹ä¸­çº¿ç¨‹å´©æºƒå¯èƒ½å¯¼è‡´æ•´ä¸ªè¿›ç¨‹å®•æœºã€‚&lt;/p>
&lt;h5 id="4-ç®€åŒ–å¼€å‘ä¸ç»´æŠ¤">4. &lt;strong>ç®€åŒ–å¼€å‘ä¸ç»´æŠ¤&lt;/strong>&lt;/h5>
&lt;p>å¤šè¿›ç¨‹æ¨¡å‹çš„ä»£ç ç»“æ„æ›´æ¸…æ™°ï¼š&lt;br>
â€¢ Workerä¹‹é—´æ— å…±äº«çŠ¶æ€ï¼Œé¿å…å¤æ‚çš„çº¿ç¨‹åŒæ­¥é€»è¾‘&lt;br>
â€¢ è°ƒè¯•æ—¶å¯é€šè¿‡&lt;code>gdb&lt;/code>å•ç‹¬é™„åŠ åˆ°æŸä¸ªWorkerè¿›ç¨‹ï¼Œæ— éœ€å¤„ç†çº¿ç¨‹äº¤ç»‡é—®é¢˜&lt;/p>
&lt;h5 id="5-ä¸äº‹ä»¶é©±åŠ¨æ¨¡å‹çš„å®Œç¾å¥‘åˆ">5. &lt;strong>ä¸äº‹ä»¶é©±åŠ¨æ¨¡å‹çš„å®Œç¾å¥‘åˆ&lt;/strong>&lt;/h5>
&lt;p>Nginxçš„&lt;strong>å¼‚æ­¥éé˜»å¡I/Oå¤šè·¯å¤ç”¨&lt;/strong>ï¼ˆå¦‚Linuxçš„epollï¼‰æ˜¯å…¶é«˜å¹¶å‘çš„å¦ä¸€åŸºçŸ³ã€‚æ¯ä¸ªWorkerè¿›ç¨‹é€šè¿‡å•çº¿ç¨‹å¾ªç¯å¤„ç†äº‹ä»¶ï¼Œé¿å…äº†ä¼ ç»Ÿå¤šè¿›ç¨‹æ¨¡å‹ä¸­â€œä¸€è¯·æ±‚ä¸€è¿›ç¨‹â€çš„èµ„æºæµªè´¹ã€‚è¿™ç§ç»„åˆä½¿å¾—å•ä¸ªWorkerå³å¯é«˜æ•ˆç®¡ç†æ•°ä¸‡è¿æ¥ã€‚&lt;/p>
&lt;hr>
&lt;h4 id="ä¸‰å¤šè¿›ç¨‹æ¨¡å‹çš„å±€é™æ€§">ä¸‰ã€å¤šè¿›ç¨‹æ¨¡å‹çš„å±€é™æ€§&lt;/h4>
&lt;p>å°½ç®¡ä¼˜åŠ¿æ˜¾è‘—ï¼Œè¯¥æ¨¡å‹ä¹Ÿå­˜åœ¨ä»¥ä¸‹æŒ‘æˆ˜ï¼š&lt;/p>
&lt;ol>
&lt;li>&lt;strong>å†…å­˜å ç”¨è¾ƒé«˜&lt;/strong>ï¼šæ¯ä¸ªWorkeréœ€ç‹¬ç«‹çš„å†…å­˜ç©ºé—´ï¼Œè¿æ¥æ•°æé«˜æ—¶å¯èƒ½äº§ç”Ÿå†—ä½™å¼€é”€ã€‚&lt;/li>
&lt;li>&lt;strong>è¿›ç¨‹é—´é€šä¿¡å¤æ‚&lt;/strong>ï¼šå…±äº«æ•°æ®éœ€é€šè¿‡IPCï¼ˆå¦‚å…±äº«å†…å­˜ï¼‰ï¼Œå¼€å‘å¤æ‚åº¦é«˜äºçº¿ç¨‹æ¨¡å‹ã€‚&lt;/li>
&lt;li>&lt;strong>è®¡ç®—å¯†é›†å‹åœºæ™¯åŠ£åŠ¿&lt;/strong>ï¼šè‹¥è¯·æ±‚æ¶‰åŠå¤§é‡CPUè¿ç®—ï¼ˆå¦‚åŠ å¯†è§£å¯†ï¼‰ï¼Œå¤šçº¿ç¨‹æ¨¡å‹å¯èƒ½æ›´é«˜æ•ˆã€‚&lt;/li>
&lt;/ol>
&lt;hr>
&lt;h4 id="å››ä¸å…¶ä»–æ¨¡å‹çš„å¯¹æ¯”åˆ†æ">å››ã€ä¸å…¶ä»–æ¨¡å‹çš„å¯¹æ¯”åˆ†æ&lt;/h4>
&lt;table>
 &lt;thead>
 &lt;tr>
 &lt;th>æ¨¡å‹ç±»å‹&lt;/th>
 &lt;th>å…¸å‹ä»£è¡¨&lt;/th>
 &lt;th>é€‚ç”¨åœºæ™¯&lt;/th>
 &lt;th>Nginxçš„é€‰æ‹©ä¾æ®&lt;/th>
 &lt;/tr>
 &lt;/thead>
 &lt;tbody>
 &lt;tr>
 &lt;td>&lt;strong>å¤šè¿›ç¨‹å•çº¿ç¨‹&lt;/strong>&lt;/td>
 &lt;td>Nginx&lt;/td>
 &lt;td>I/Oå¯†é›†å‹é«˜å¹¶å‘&lt;/td>
 &lt;td>è§„é¿é”ç«äº‰ï¼Œéš”ç¦»æ•…éšœ&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>&lt;strong>å•è¿›ç¨‹å¤šçº¿ç¨‹&lt;/strong>&lt;/td>
 &lt;td>Apache&lt;/td>
 &lt;td>è®¡ç®—å¯†é›†å‹ä»»åŠ¡&lt;/td>
 &lt;td>çº¿ç¨‹å´©æºƒé£é™©é«˜ï¼Œè°ƒè¯•å¤æ‚&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>&lt;strong>åç¨‹æ¨¡å‹&lt;/strong>&lt;/td>
 &lt;td>Go&lt;/td>
 &lt;td>é«˜å¹¶å‘å¾®æœåŠ¡&lt;/td>
 &lt;td>éœ€è¯­è¨€è¿è¡Œæ—¶æ”¯æŒï¼Œç”Ÿæ€å·®å¼‚&lt;/td>
 &lt;/tr>
 &lt;/tbody>
&lt;/table>
&lt;hr>
&lt;h4 id="äº”è®¾è®¡å¯ç¤ºå¦‚ä½•é€‰æ‹©å¹¶å‘æ¨¡å‹">äº”ã€è®¾è®¡å¯ç¤ºï¼šå¦‚ä½•é€‰æ‹©å¹¶å‘æ¨¡å‹ï¼Ÿ&lt;/h4>
&lt;p>Nginxçš„å®è·µä¸ºé«˜å¹¶å‘ç³»ç»Ÿè®¾è®¡æä¾›äº†é‡è¦å‚è€ƒï¼š&lt;/p>
&lt;ol>
&lt;li>&lt;strong>åŒºåˆ†ä»»åŠ¡ç±»å‹&lt;/strong>ï¼šI/Oå¯†é›†å‹é¦–é€‰äº‹ä»¶é©±åŠ¨+å¤šè¿›ç¨‹ï¼Œè®¡ç®—å¯†é›†å‹å¯è€ƒè™‘å¤šçº¿ç¨‹ã€‚&lt;/li>
&lt;li>&lt;strong>æƒè¡¡å¼€å‘æˆæœ¬&lt;/strong>ï¼šå¤šè¿›ç¨‹æ¨¡å‹æ›´æ˜“å®ç°ç¨³å®šæ€§ï¼Œä½†éœ€é¢å¤–å¤„ç†IPCï¼›å¤šçº¿ç¨‹å¼€å‘é—¨æ§›æ›´é«˜ã€‚&lt;/li>
&lt;li>&lt;strong>åˆ©ç”¨æ“ä½œç³»ç»Ÿç‰¹æ€§&lt;/strong>ï¼šå¦‚Linuxçš„CPUäº²å’Œæ€§ï¼ˆaffinityï¼‰å¯ä¼˜åŒ–å¤šè¿›ç¨‹ç»‘å®šã€‚&lt;/li>
&lt;/ol>
&lt;hr>
&lt;h4 id="ç»“è¯­">ç»“è¯­&lt;/h4>
&lt;p>Nginxçš„å¤šè¿›ç¨‹æ¨¡å‹å¹¶éå¶ç„¶ï¼Œè€Œæ˜¯é’ˆå¯¹WebæœåŠ¡å™¨&lt;strong>é«˜å¹¶å‘ã€ä½å»¶è¿Ÿã€å¼ºç¨³å®š&lt;/strong>çš„æ ¸å¿ƒéœ€æ±‚åšå‡ºçš„ç†æ€§æƒè¡¡ã€‚å®ƒé€šè¿‡èµ„æºéš”ç¦»ã€æ— é”æ¶æ„ä¸äº‹ä»¶é©±åŠ¨çš„ä¸‰é‡è®¾è®¡ï¼Œåœ¨I/Oå¯†é›†å‹åœºæ™¯ä¸­å±•ç°äº†æ— å¯æ›¿ä»£çš„ä¼˜åŠ¿ã€‚æ­£å¦‚å…¶ä½œè€…Igor Sysoevæ‰€è¨€ï¼šâ€œç®€å•æ€§æ˜¯å¯æ‰©å±•æ€§çš„åŸºçŸ³â€â€”â€”å¤šè¿›ç¨‹æ¨¡å‹æ­£æ˜¯è¿™ä¸€å“²å­¦çš„æœ€ä½³å®è·µã€‚&lt;/p>
&lt;blockquote>
&lt;p>&lt;strong>å‚è€ƒèµ„æ–™&lt;/strong>ï¼š&lt;br>
[1] å…¶å…¶ç½‘ã€ŠNginxä¸ºä½•åçˆ±å¤šè¿›ç¨‹æ¨¡å‹ã€‹&lt;br>
[4][6] CSDNåšå®¢ã€Šnginxä¸ºä»€ä¹ˆæ˜¯å¤šè¿›ç¨‹å•çº¿ç¨‹ã€‹&lt;br>
[2][3] CSDNåšå®¢ã€ŠNginxå·¥ä½œåŸç†ã€‹&lt;/p>
&lt;/blockquote></description></item><item><title>æµè®¡ç®—ä¸­çš„åå‘å‹åŠ›æ¨¡å‹ä¸ Reactive Streams --C++å®ç°</title><link>https://jekyulll.github.io/posts/web-%E6%B5%81%E8%AE%A1%E7%AE%97%E4%B8%AD%E7%9A%84%E5%8F%8D%E5%90%91%E5%8E%8B%E5%8A%9B%E6%A8%A1%E5%9E%8B%E4%B8%8E-reactive-streams---c++%E5%AE%9E%E7%8E%B0/</link><pubDate>Fri, 21 Mar 2025 12:05:47 +0800</pubDate><guid>https://jekyulll.github.io/posts/web-%E6%B5%81%E8%AE%A1%E7%AE%97%E4%B8%AD%E7%9A%84%E5%8F%8D%E5%90%91%E5%8E%8B%E5%8A%9B%E6%A8%A1%E5%9E%8B%E4%B8%8E-reactive-streams---c++%E5%AE%9E%E7%8E%B0/</guid><description>&lt;h2 id="ä¸€åå‘å‹åŠ›backpressureçš„æ ¸å¿ƒæ„ä¹‰">ä¸€ã€åå‘å‹åŠ›ï¼ˆBackpressureï¼‰çš„æ ¸å¿ƒæ„ä¹‰&lt;/h2>
&lt;p>åœ¨æµå¼è®¡ç®—ä¸­ï¼Œæ•°æ®ç”Ÿäº§è€…çš„ç”Ÿæˆé€Ÿç‡ä¸æ¶ˆè´¹è€…çš„å¤„ç†é€Ÿç‡å¾€å¾€ä¸åŒ¹é…ã€‚è‹¥ç”Ÿäº§è€…é€Ÿåº¦è¿œé«˜äºæ¶ˆè´¹è€…ï¼Œæ— é™åˆ¶çš„ç¼“å†²ä¼šå¯¼è‡´&lt;strong>å†…å­˜æº¢å‡º&lt;/strong>æˆ–&lt;strong>ç³»ç»Ÿå´©æºƒ&lt;/strong>ã€‚åå‘å‹åŠ›ï¼ˆBackpressureï¼‰æœºåˆ¶é€šè¿‡åŠ¨æ€è°ƒèŠ‚æ•°æ®æµé€Ÿï¼Œå®ç°ç”Ÿäº§è€…ä¸æ¶ˆè´¹è€…çš„&lt;strong>é€Ÿç‡é€‚é…&lt;/strong>ï¼Œä»è€Œä¿è¯ç³»ç»Ÿçš„ç¨³å®šæ€§ä¸èµ„æºå¯æ§æ€§ã€‚&lt;/p>
&lt;h3 id="11-èƒŒå‹çš„ä¸¤ç§å®ç°æ¨¡å¼">1.1 èƒŒå‹çš„ä¸¤ç§å®ç°æ¨¡å¼&lt;/h3>
&lt;ol>
&lt;li>&lt;strong>é˜»å¡å¼åé¦ˆ&lt;/strong>ï¼šé€šè¿‡é˜Ÿåˆ—å®¹é‡é™åˆ¶ç›´æ¥é˜»å¡ç”Ÿäº§è€…ï¼ˆå¦‚çº¿ç¨‹ç­‰å¾…ï¼‰ã€‚&lt;/li>
&lt;li>&lt;strong>éé˜»å¡å¼åå•†&lt;/strong>ï¼šé€šè¿‡å¼‚æ­¥ä¿¡å·ï¼ˆå¦‚è¯·æ±‚é‡åå•†ï¼‰åŠ¨æ€è°ƒæ•´ç”Ÿäº§è€…é€Ÿç‡ï¼ˆReactive Streamsçš„æ ¸å¿ƒæœºåˆ¶ï¼‰ã€‚&lt;/li>
&lt;/ol>
&lt;hr>
&lt;h2 id="äºŒreactive-streamsè§„èŒƒä¸cæ˜ å°„">äºŒã€Reactive Streamsè§„èŒƒä¸C++æ˜ å°„&lt;/h2>
&lt;p>Reactive Streamsæ˜¯å¼‚æ­¥æµå¤„ç†çš„&lt;strong>æ ‡å‡†åŒ–è§„èŒƒ&lt;/strong>ï¼Œå®šä¹‰äº†å››ä¸ªæ ¸å¿ƒç»„ä»¶ï¼š&lt;/p>
&lt;table>
 &lt;thead>
 &lt;tr>
 &lt;th>ç»„ä»¶&lt;/th>
 &lt;th>èŒè´£&lt;/th>
 &lt;th>C++ç±»è®¾è®¡ç¤ºä¾‹ï¼ˆä¼ªä»£ç ï¼‰&lt;/th>
 &lt;/tr>
 &lt;/thead>
 &lt;tbody>
 &lt;tr>
 &lt;td>&lt;strong>Publisher&lt;/strong>&lt;/td>
 &lt;td>æ•°æ®ç”Ÿäº§è€…ï¼ˆå¦‚ä¼ æ„Ÿå™¨ã€æ–‡ä»¶è¯»å–ï¼‰&lt;/td>
 &lt;td>&lt;code>class Publisher&amp;lt;T&amp;gt; { virtual void subscribe(Subscriber&amp;lt;T&amp;gt;&amp;amp;) = 0; };&lt;/code>&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>&lt;strong>Subscriber&lt;/strong>&lt;/td>
 &lt;td>æ•°æ®æ¶ˆè´¹è€…ï¼ˆå¦‚æ•°æ®åº“å†™å…¥ã€ç½‘ç»œå‘é€ï¼‰&lt;/td>
 &lt;td>&lt;code>class Subscriber&amp;lt;T&amp;gt; { virtual void onNext(const T&amp;amp;) = 0; };&lt;/code>&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>&lt;strong>Subscription&lt;/strong>&lt;/td>
 &lt;td>è®¢é˜…ä¸Šä¸‹æ–‡ï¼ˆèƒŒå‹åå•†ï¼‰&lt;/td>
 &lt;td>&lt;code>class Subscription { virtual void request(int n) = 0; };&lt;/code>&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>&lt;strong>Processor&lt;/strong>&lt;/td>
 &lt;td>ä¸­é—´å¤„ç†èŠ‚ç‚¹ï¼ˆå¦‚æ•°æ®è¿‡æ»¤ã€è½¬æ¢ï¼‰&lt;/td>
 &lt;td>&lt;code>class Processor&amp;lt;T, R&amp;gt; : public Subscriber&amp;lt;T&amp;gt;, Publisher&amp;lt;R&amp;gt; {};&lt;/code>&lt;/td>
 &lt;/tr>
 &lt;/tbody>
&lt;/table>
&lt;h3 id="21-cå®ç°çš„æ ¸å¿ƒé€»è¾‘">2.1 C++å®ç°çš„æ ¸å¿ƒé€»è¾‘&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// åŸºäºæ¡ä»¶å˜é‡çš„èƒŒå‹é˜Ÿåˆ—ï¼ˆç®€åŒ–ç‰ˆï¼‰ 
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">template&lt;/span>&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#66d9ef">typename&lt;/span> T&lt;span style="color:#f92672">&amp;gt;&lt;/span> 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">class&lt;/span> &lt;span style="color:#a6e22e">BoundedQueue&lt;/span> { 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">private&lt;/span>&lt;span style="color:#f92672">:&lt;/span> 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> std&lt;span style="color:#f92672">::&lt;/span>queue&lt;span style="color:#f92672">&amp;lt;&lt;/span>T&lt;span style="color:#f92672">&amp;gt;&lt;/span> buffer; 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> std&lt;span style="color:#f92672">::&lt;/span>mutex mtx; 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> std&lt;span style="color:#f92672">::&lt;/span>condition_variable not_full; 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> std&lt;span style="color:#f92672">::&lt;/span>condition_variable not_empty; 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> size_t capacity; 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">public&lt;/span>&lt;span style="color:#f92672">:&lt;/span> 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">void&lt;/span> push(&lt;span style="color:#66d9ef">const&lt;/span> T&lt;span style="color:#f92672">&amp;amp;&lt;/span> item) { 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> std&lt;span style="color:#f92672">::&lt;/span>unique_lock&lt;span style="color:#f92672">&amp;lt;&lt;/span>std&lt;span style="color:#f92672">::&lt;/span>mutex&lt;span style="color:#f92672">&amp;gt;&lt;/span> lock(mtx); 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> not_full.wait(lock, [&lt;span style="color:#66d9ef">this&lt;/span>] { &lt;span style="color:#66d9ef">return&lt;/span> buffer.size() &lt;span style="color:#f92672">&amp;lt;&lt;/span> capacity; }); 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> buffer.push(item); 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> not_empty.notify_one(); 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> } 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> T &lt;span style="color:#a6e22e">pop&lt;/span>() { 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> std&lt;span style="color:#f92672">::&lt;/span>unique_lock&lt;span style="color:#f92672">&amp;lt;&lt;/span>std&lt;span style="color:#f92672">::&lt;/span>mutex&lt;span style="color:#f92672">&amp;gt;&lt;/span> lock(mtx); 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> not_empty.wait(lock, [&lt;span style="color:#66d9ef">this&lt;/span>] { &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#f92672">!&lt;/span>buffer.empty(); }); 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> T val &lt;span style="color:#f92672">=&lt;/span> std&lt;span style="color:#f92672">::&lt;/span>move(buffer.front()); 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> buffer.pop(); 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> not_full.notify_one(); 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> val; 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> } 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}; 
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;strong>è¯´æ˜&lt;/strong>ï¼šé˜Ÿåˆ—æ»¡æ—¶é˜»å¡&lt;code>push&lt;/code>ï¼Œç©ºæ—¶é˜»å¡&lt;code>pop&lt;/code>ï¼Œé€šè¿‡æ¡ä»¶å˜é‡å®ç°ç”Ÿäº§è€…-æ¶ˆè´¹è€…çš„é€Ÿç‡åŒæ­¥ã€‚&lt;/p></description></item><item><title>ã€01ã€‘Flet å­¦ä¹ ç¬”è®° --FlutteråŸç†</title><link>https://jekyulll.github.io/posts/frontend-01flet-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0---flutter%E5%8E%9F%E7%90%86/</link><pubDate>Tue, 18 Mar 2025 06:05:47 +0800</pubDate><guid>https://jekyulll.github.io/posts/frontend-01flet-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0---flutter%E5%8E%9F%E7%90%86/</guid><description>&lt;p>Flutterä¸ºä½•èƒ½æ‘†è„±æµè§ˆå™¨ä¾èµ–ï¼Ÿ&lt;/p>
&lt;hr>
&lt;h3 id="ä¸€flutterçš„ä¸‰å±‚æ¶æ„ä»æ“ä½œç³»ç»Ÿåˆ°ç•Œé¢æ¸²æŸ“">ä¸€ã€Flutterçš„ä¸‰å±‚æ¶æ„ï¼šä»æ“ä½œç³»ç»Ÿåˆ°ç•Œé¢æ¸²æŸ“&lt;/h3>
&lt;p>&lt;strong>1. åµŒå…¥å±‚ï¼ˆEmbedderï¼‰&lt;/strong>&lt;br>
åµŒå…¥å±‚æ˜¯Flutterä¸æ“ä½œç³»ç»Ÿå¯¹è¯çš„&amp;quot;ç¿»è¯‘å®˜&amp;quot;ï¼Œè´Ÿè´£å°†Flutterå¼•æ“å®‰è£…åˆ°ç›®æ ‡å¹³å°ã€‚ä¾‹å¦‚åœ¨Androidä¸Šï¼Œå®ƒé€šè¿‡Java/C++ä¸Activityç”Ÿå‘½å‘¨æœŸäº¤äº’ï¼›åœ¨iOSä¸Šåˆ™é€šè¿‡Objective-Cæ¡¥æ¥UIKitäº‹ä»¶ã€‚è¿™ä¸€å±‚çš„å…³é”®ä»»åŠ¡æ˜¯åˆ›å»ºç»˜å›¾è¡¨é¢ï¼ˆSurfaceï¼‰å¹¶ç®¡ç†çº¿ç¨‹æ¨¡å‹ï¼ˆå¦‚UIçº¿ç¨‹ã€GPUçº¿ç¨‹ï¼‰ï¼Œä¸ºä¸Šå±‚æ¸²æŸ“æä¾›ç¨³å®šçš„è¿è¡Œç¯å¢ƒã€‚&lt;/p>
&lt;p>&lt;strong>2. å¼•æ“å±‚ï¼ˆEngineï¼‰&lt;/strong>&lt;br>
å¼•æ“å±‚æ˜¯Flutterçš„å¿ƒè„ï¼Œç”±C++ç¼–å†™ï¼ŒåŒ…å«ä¸‰å¤§æ ¸å¿ƒæ¨¡å—ï¼š&lt;br>
â€¢ &lt;strong>Skiaå›¾å½¢å¼•æ“&lt;/strong>ï¼šGoogleå¼€æºçš„2Dç»˜å›¾åº“ï¼Œç›´æ¥æ“æ§GPUè¿›è¡Œåƒç´ ç»˜åˆ¶ï¼Œæ— éœ€ç»è¿‡ç³»ç»ŸåŸç”Ÿæ§ä»¶&lt;br>
â€¢ &lt;strong>Dartè¿è¡Œæ—¶&lt;/strong>ï¼šæ”¯æŒJITï¼ˆå¼€å‘çƒ­é‡è½½ï¼‰ä¸AOTï¼ˆå‘å¸ƒé«˜æ€§èƒ½ï¼‰åŒæ¨¡å¼ç¼–è¯‘&lt;br>
â€¢ &lt;strong>æ–‡æœ¬æ¸²æŸ“å¼•æ“&lt;/strong>ï¼šç‹¬ç«‹å¤„ç†å¤æ‚æ–‡å­—æ’ç‰ˆï¼ˆå¦‚é˜¿æ‹‰ä¼¯è¯­ä»å³å‘å·¦æ’åˆ—ï¼‰&lt;br>
è¿™äº›ç»„ä»¶å…±åŒæ„å»ºäº†è·¨å¹³å°çš„ç»˜å›¾èƒ½åŠ›ï¼Œä¾‹å¦‚æ»‘åŠ¨åˆ—è¡¨æ—¶ï¼ŒSkiaä¼šå°†å›¾å±‚æ•°æ®ç›´æ¥æäº¤ç»™GPUæ¸²æŸ“ç®¡çº¿ã€‚&lt;/p>
&lt;p>&lt;strong>3. æ¡†æ¶å±‚ï¼ˆFrameworkï¼‰&lt;/strong>&lt;br>
å¼€å‘è€…ç›´æ¥æ¥è§¦çš„Dartè¯­è¨€å±‚ï¼Œæä¾›å£°æ˜å¼UIç»„ä»¶ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-dart" data-lang="dart">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// å…¸å‹Flutterç»„ä»¶æ ‘
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>Scaffold(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> appBar: AppBar(title: Text(&lt;span style="color:#e6db74">&amp;#39;Demo&amp;#39;&lt;/span>)),
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> body: ListView.builder(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> itemBuilder: (context, index) &lt;span style="color:#f92672">=&amp;gt;&lt;/span> ListTile(title: Text(&lt;span style="color:#e6db74">&amp;#39;Item &lt;/span>&lt;span style="color:#e6db74">$&lt;/span>index&lt;span style="color:#e6db74">&amp;#39;&lt;/span>))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> )
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ¡†æ¶å±‚å°†Widgetè½¬åŒ–ä¸ºæ¸²æŸ“æŒ‡ä»¤ï¼Œé€šè¿‡æ·±åº¦ä¼˜å…ˆéå†å®Œæˆå¸ƒå±€è®¡ç®—ï¼Œæœ€ç»ˆç”Ÿæˆä¾›Skiaå¤„ç†çš„å›¾å±‚æ•°æ®ã€‚&lt;/p>
&lt;hr>
&lt;h3 id="äºŒè‡ªæ¸²æŸ“æœºåˆ¶">äºŒã€è‡ªæ¸²æŸ“æœºåˆ¶&lt;/h3>
&lt;p>ä¼ ç»Ÿè·¨å¹³å°æ–¹æ¡ˆå¦‚React Nativeéœ€è¦å°†JavaScriptæ§ä»¶æ˜ å°„ä¸ºåŸç”Ÿç»„ä»¶ã€‚Flutterä¸åŒï¼š&lt;/p>
&lt;p>&lt;strong>1. åƒç´ çº§æ§åˆ¶&lt;/strong>&lt;br>
é€šè¿‡Skiaç›´æ¥å‘GPUæäº¤ç»˜å›¾æŒ‡ä»¤ï¼Œç»•è¿‡äº†æµè§ˆå™¨æ¸²æŸ“æµç¨‹ä¸­çš„HTMLè§£æã€CSSè®¡ç®—ã€åˆæˆå±‚å¤„ç†ç­‰ç¯èŠ‚ã€‚ä¾‹å¦‚åœ¨å®ç°æ¸å˜è‰²åŠ¨ç”»æ—¶ï¼ŒFlutterå¼•æ“ç›´æ¥æ“ä½œç€è‰²å™¨ï¼Œè€ŒWebæ–¹æ¡ˆéœ€è¦å¤„ç†å¤æ‚çš„CSSåŠ¨ç”»æ€§èƒ½ä¼˜åŒ–ã€‚&lt;/p>
&lt;p>&lt;strong>2. çº¿ç¨‹æ¨¡å‹ä¼˜åŒ–&lt;/strong>&lt;br>
â€¢ &lt;strong>UIçº¿ç¨‹&lt;/strong>ï¼šæ‰§è¡ŒDartä»£ç ï¼Œæ„å»ºå›¾å±‚æ ‘&lt;br>
â€¢ &lt;strong>GPUçº¿ç¨‹&lt;/strong>ï¼šè°ƒç”¨Skiaç”ŸæˆGLæŒ‡ä»¤&lt;br>
â€¢ &lt;strong>IOçº¿ç¨‹&lt;/strong>ï¼šå¼‚æ­¥åŠ è½½èµ„æº&lt;br>
ä¸‰çº¿ç¨‹é€šè¿‡VSyncä¿¡å·åŒæ­¥ï¼Œç¡®ä¿60FPSæµç•…æ¸²æŸ“ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œæµè§ˆå™¨å—é™äºå•çº¿ç¨‹JavaScriptå’Œæ ·å¼é‡è®¡ç®—ï¼Œå®¹æ˜“å‡ºç°å¡é¡¿ã€‚&lt;/p>
&lt;p>&lt;strong>3. è·¨å¹³å°ä¸€è‡´æ€§ä¿éšœ&lt;/strong>&lt;br>
è‡ªç ”æ¸²æŸ“å¼•æ“é¿å…äº†ä¸åŒå¹³å°WebViewçš„å·®å¼‚é—®é¢˜ã€‚ä¾‹å¦‚åœ¨å®ç°Material Designçš„æ³¢çº¹æ•ˆæœæ—¶ï¼ŒAndroidå’ŒiOSä¼šå‘ˆç°å®Œå…¨ç›¸åŒçš„åŠ¨ç”»ç»†èŠ‚ï¼Œè€Œä¼ ç»Ÿæ–¹æ¡ˆéœ€è¦åˆ†åˆ«é€‚é…å„å¹³å°åŸç”Ÿæ§ä»¶ã€‚&lt;/p>
&lt;hr>
&lt;h3 id="ä¸‰ä¸æµè§ˆå™¨æ–¹æ¡ˆçš„å¯¹æ¯”">ä¸‰ã€ä¸æµè§ˆå™¨æ–¹æ¡ˆçš„å¯¹æ¯”&lt;/h3>
&lt;p>é€šè¿‡å®é™…åœºæ™¯å¯¹æ¯”ä¼ ç»ŸWebæŠ€æœ¯ä¸Flutterçš„å·®å¼‚ï¼š&lt;/p>
&lt;table>
 &lt;thead>
 &lt;tr>
 &lt;th>åœºæ™¯&lt;/th>
 &lt;th>æµè§ˆå™¨æ–¹æ¡ˆ&lt;/th>
 &lt;th>Flutteræ–¹æ¡ˆ&lt;/th>
 &lt;/tr>
 &lt;/thead>
 &lt;tbody>
 &lt;tr>
 &lt;td>åˆ—è¡¨æ»šåŠ¨&lt;/td>
 &lt;td>ä¾èµ–DOMæ›´æ–°ï¼Œæ˜“å¡é¡¿&lt;/td>
 &lt;td>å›¾å±‚å¤ç”¨ï¼ŒGPUç›´æ¥åˆæˆ&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>äº¤äº’åŠ¨ç”»&lt;/td>
 &lt;td>CSSè¿‡æ¸¡å¯èƒ½ä¸¢å¸§&lt;/td>
 &lt;td>åŸºäºç‰©ç†çš„åŠ¨ç”»æ›²çº¿&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>é¦–å±åŠ è½½&lt;/td>
 &lt;td>éœ€ä¸‹è½½å®Œæ•´HTML/CSS/JS&lt;/td>
 &lt;td>é¢„ç¼–è¯‘Dartä»£ç å¿«é€Ÿå¯åŠ¨&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>å†…å­˜å ç”¨&lt;/td>
 &lt;td>WebViewå¸¸é©»å†…å­˜è¾ƒé«˜&lt;/td>
 &lt;td>åŸç”Ÿçº¿ç¨‹ç®¡ç†æ›´é«˜æ•ˆ&lt;/td>
 &lt;/tr>
 &lt;/tbody>
&lt;/table>
&lt;p>ä»¥ç”µå•†å•†å“åˆ—è¡¨ä¸ºä¾‹ï¼ŒFlutterå¯ç¨³å®šä¿æŒ120FPSæ»šåŠ¨å¸§ç‡ï¼Œè€ŒåŸºäºWebçš„æ–¹æ¡ˆåœ¨å¿«é€Ÿæ»‘åŠ¨æ—¶å®¹æ˜“å‡ºç°ç™½å±ã€‚&lt;/p></description></item><item><title>å¦‚ä½•é™åˆ¶C++å¯¹è±¡åªèƒ½åœ¨å †æˆ–æ ˆä¸Šåˆ›å»ºï¼Ÿheap only å’Œ stack only</title><link>https://jekyulll.github.io/posts/cpp-heap-only-%E5%92%8C-stack-only-%E7%9A%84-c++-%E5%AF%B9%E8%B1%A1/</link><pubDate>Sun, 16 Mar 2025 12:05:47 +0800</pubDate><guid>https://jekyulll.github.io/posts/cpp-heap-only-%E5%92%8C-stack-only-%E7%9A%84-c++-%E5%AF%B9%E8%B1%A1/</guid><description>&lt;h2 id="ä¸ºä»€ä¹ˆéœ€è¦é™åˆ¶å¯¹è±¡çš„åˆ›å»ºä½ç½®">ä¸ºä»€ä¹ˆéœ€è¦é™åˆ¶å¯¹è±¡çš„åˆ›å»ºä½ç½®ï¼Ÿ&lt;/h2>
&lt;p>ä¾‹å¦‚ä¸€ä¸ªéœ€è¦&lt;strong>æ‰‹åŠ¨æ§åˆ¶ç”Ÿå‘½å‘¨æœŸ&lt;/strong>çš„æ•°æ®åº“è¿æ¥æ± ï¼Œä¸å¸Œæœ›éšä¾¿åœ¨æ ˆä¸Šåˆ›å»ºä¸€ä¸ªç„¶åè‡ªåŠ¨é”€æ¯ã€‚åˆæˆ–è€…å†™äº†ä¸€ä¸ªè½»é‡çº§çš„ä¸´æ—¶è®¡ç®—å·¥å…·ç±»ï¼Œå¦‚æœæ¯æ¬¡éƒ½åœ¨å †ä¸Šåˆ›å»ºï¼Œæ€§èƒ½åè€Œä¼šä¸‹é™ã€‚&lt;/p>
&lt;p>â€¢ âœ… æ˜ç¡®ç”Ÿå‘½å‘¨æœŸç®¡ç†
â€¢ âœ… é¿å…èµ„æºæ³„æ¼
â€¢ âœ… æå‡å…³é”®è·¯å¾„æ€§èƒ½
â€¢ âœ… å¼ºåˆ¶ä½¿ç”¨æœ€ä½³å®è·µ&lt;/p>
&lt;hr>
&lt;h2 id="ä¸€heap-onlyå¿…é¡»ç”¨newåˆ›å»º">ä¸€ã€Heap Onlyï¼šå¿…é¡»ç”¨newåˆ›å»º&lt;/h2>
&lt;h4 id="æ–¹æ³•1ç§æœ‰åŒ–ææ„å‡½æ•°">æ–¹æ³•1ï¼šç§æœ‰åŒ–ææ„å‡½æ•°&lt;/h4>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">class&lt;/span> &lt;span style="color:#a6e22e">HeapOnly&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">public&lt;/span>&lt;span style="color:#f92672">:&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">static&lt;/span> HeapOnly&lt;span style="color:#f92672">*&lt;/span> Create() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#66d9ef">new&lt;/span> &lt;span style="color:#a6e22e">HeapOnly&lt;/span>(); &lt;span style="color:#75715e">// å·¥å‚æ–¹æ³•
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">void&lt;/span> &lt;span style="color:#a6e22e">Suicide&lt;/span>() { &lt;span style="color:#66d9ef">delete&lt;/span> &lt;span style="color:#66d9ef">this&lt;/span>; } &lt;span style="color:#75715e">// èµ·ä¸ªä¸­äºŒçš„åå­—æé†’è¦æ‰‹åŠ¨é‡Šæ”¾
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">private&lt;/span>&lt;span style="color:#f92672">:&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">~&lt;/span>HeapOnly() {} &lt;span style="color:#75715e">// å…³é”®ï¼æ ˆå¯¹è±¡æ— æ³•è‡ªåŠ¨è°ƒç”¨
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> HeapOnly() {} &lt;span style="color:#75715e">// ç§æœ‰æ„é€ 
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>};
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;strong>åŸç†&lt;/strong>ï¼šæ ˆå¯¹è±¡åœ¨ç¦»å¼€ä½œç”¨åŸŸæ—¶ä¼šè‡ªåŠ¨è°ƒç”¨ææ„å‡½æ•°ï¼Œå¦‚æœææ„æ˜¯ç§æœ‰çš„ï¼Œç¼–è¯‘å™¨ç›´æ¥æŠ¥é”™ã€‚å¿…é¡»é€šè¿‡&lt;code>new&lt;/code>åˆ›å»ºï¼Œæ‰‹åŠ¨è°ƒç”¨é‡Šæ”¾ã€‚&lt;/p>
&lt;h4 id="æ–¹æ³•2c11ç”¨-delete">æ–¹æ³•2ï¼šC++11ï¼Œç”¨&lt;code>= delete&lt;/code>&lt;/h4>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">class&lt;/span> &lt;span style="color:#a6e22e">HeapOnly&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">public&lt;/span>&lt;span style="color:#f92672">:&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">static&lt;/span> HeapOnly&lt;span style="color:#f92672">*&lt;/span> Create() { &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#66d9ef">new&lt;/span> HeapOnly; }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// ç›´æ¥ç¦ç”¨æ‹·è´æ„é€ å’Œèµ‹å€¼
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> HeapOnly(&lt;span style="color:#66d9ef">const&lt;/span> HeapOnly&lt;span style="color:#f92672">&amp;amp;&lt;/span>) &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">delete&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> HeapOnly&lt;span style="color:#f92672">&amp;amp;&lt;/span> &lt;span style="color:#66d9ef">operator&lt;/span>&lt;span style="color:#f92672">=&lt;/span>(&lt;span style="color:#66d9ef">const&lt;/span> HeapOnly&lt;span style="color:#f92672">&amp;amp;&lt;/span>) &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">delete&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">private&lt;/span>&lt;span style="color:#f92672">:&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> HeapOnly() &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">default&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="åº”ç”¨åœºæ™¯">åº”ç”¨åœºæ™¯&lt;/h3>
&lt;ol>
&lt;li>&lt;strong>å•ä¾‹æ¨¡å¼&lt;/strong>ï¼ˆæ¯”å¦‚å…¨å±€é…ç½®ç®¡ç†å™¨ï¼‰&lt;/li>
&lt;li>&lt;strong>éœ€è¦å¤šæ€çš„å¯¹è±¡&lt;/strong>ï¼ˆæ¯”å¦‚åŠ¨ç‰©åŸºç±»æ´¾ç”Ÿå‡ºçŒ«ç‹—å­ç±»ï¼‰&lt;/li>
&lt;li>&lt;strong>é‡é‡çº§èµ„æº&lt;/strong>ï¼ˆæ¯”å¦‚çº¿ç¨‹æ± ã€ç½‘ç»œè¿æ¥æ± ï¼‰&lt;/li>
&lt;li>&lt;strong>å»¶è¿Ÿåˆå§‹åŒ–&lt;/strong>çš„å¯¹è±¡ï¼ˆæŒ‰éœ€åˆ›å»ºï¼‰&lt;/li>
&lt;/ol>
&lt;p>eg. æ¸¸æˆå¼•æ“ä¸­çš„èµ„æºç®¡ç†å™¨ï¼Œæ‰€æœ‰è´´å›¾ã€æ¨¡å‹éƒ½é€šè¿‡&lt;code>ResourceManager::LoadTexture()&lt;/code>è¿™ç±»å·¥å‚æ–¹æ³•åˆ›å»ºï¼Œç¡®ä¿ç»Ÿä¸€ç®¡ç†ã€‚&lt;/p></description></item><item><title>è§£æLRUä¸LFUç®—æ³•åŠC++å®ç°</title><link>https://jekyulll.github.io/posts/web-%E8%A7%A3%E6%9E%90lru%E4%B8%8Elfu%E7%AE%97%E6%B3%95%E5%8F%8Ac++%E5%AE%9E%E7%8E%B0/</link><pubDate>Sun, 16 Mar 2025 12:05:47 +0800</pubDate><guid>https://jekyulll.github.io/posts/web-%E8%A7%A3%E6%9E%90lru%E4%B8%8Elfu%E7%AE%97%E6%B3%95%E5%8F%8Ac++%E5%AE%9E%E7%8E%B0/</guid><description>&lt;p>åœ¨è®¡ç®—æœºç³»ç»Ÿä¸­ï¼Œç¼“å­˜æ˜¯æå‡æ€§èƒ½çš„æ ¸å¿ƒæŠ€æœ¯ä¹‹ä¸€ã€‚å½“å†…å­˜èµ„æºæœ‰é™æ—¶ï¼Œå¦‚ä½•é«˜æ•ˆæ·˜æ±°æ— ç”¨æ•°æ®ã€ä¿ç•™çƒ­ç‚¹æ•°æ®ï¼Ÿ**LRUï¼ˆæœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼‰&lt;strong>å’Œ&lt;/strong>LFUï¼ˆæœ€ä¸é¢‘ç¹ä½¿ç”¨ï¼‰**ç®—æ³•ä¸ºæ­¤æä¾›äº†ç»å…¸è§£å†³æ–¹æ¡ˆã€‚æœ¬æ–‡å°†ä»åŸç†åˆ°å®è·µï¼Œè¯¦è§£è¿™ä¸¤ç§ç®—æ³•ï¼Œå¹¶é™„å®Œæ•´C++å®ç°ä»£ç ã€‚&lt;/p>
&lt;ul>
&lt;li>â€‹LRUï¼ˆLeast Recently Usedï¼‰â€‹
&lt;ul>
&lt;li>åŸºäºæ—¶é—´ç»´åº¦ï¼Œæ·˜æ±°æœ€ä¹…æœªè¢«è®¿é—®çš„æ•°æ®ã€‚ä¾‹å¦‚ï¼Œè‹¥ç¼“å­˜å®¹é‡ä¸º3ï¼Œä¾æ¬¡è®¿é—®Aâ†’Bâ†’Câ†’Aï¼Œåˆ™å†æ¬¡æ’å…¥æ–°æ•°æ®æ—¶ï¼Œæœ€ä¹…æœªè®¿é—®çš„Bä¼šè¢«æ·˜æ±°ã€‚å…¶æ ¸å¿ƒå‡è®¾æ˜¯ï¼šæœ€è¿‘è¢«è®¿é—®çš„æ•°æ®æœªæ¥æ›´å¯èƒ½è¢«ä½¿ç”¨ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>â€‹LFUï¼ˆLeast Frequently Usedï¼‰â€‹
&lt;ul>
&lt;li>åŸºäºé¢‘ç‡ç»´åº¦ï¼Œæ·˜æ±°è®¿é—®æ¬¡æ•°æœ€å°‘çš„æ•°æ®ã€‚ä¾‹å¦‚ï¼Œè‹¥æ•°æ®Aè¢«è®¿é—®5æ¬¡ï¼ŒBè¢«è®¿é—®3æ¬¡ï¼Œåˆ™ä¼˜å…ˆæ·˜æ±°Bã€‚LFUé€šè¿‡è®¡æ•°å™¨è®°å½•è®¿é—®é¢‘æ¬¡ï¼Œå¹¶å¯èƒ½ç»“åˆæ—¶é—´è¡°å‡æœºåˆ¶é¿å…æ—§é«˜é¢‘æ•°æ®é•¿æœŸå ç”¨ç¼“å­˜ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;hr>
&lt;h3 id="ä¸€lruç®—æ³•æ—¶é—´ç»´åº¦æ·˜æ±°ç­–ç•¥">&lt;strong>ä¸€ã€LRUç®—æ³•ï¼šæ—¶é—´ç»´åº¦æ·˜æ±°ç­–ç•¥&lt;/strong>&lt;/h3>
&lt;h4 id="æ ¸å¿ƒåŸç†">&lt;strong>æ ¸å¿ƒåŸç†&lt;/strong>&lt;/h4>
&lt;p>LRUåŸºäºâ€œæ—¶é—´å±€éƒ¨æ€§â€å‡è®¾ï¼š&lt;strong>æœ€è¿‘è¢«è®¿é—®çš„æ•°æ®æ›´å¯èƒ½è¢«å†æ¬¡ä½¿ç”¨&lt;/strong>ã€‚å…¶æ·˜æ±°ç­–ç•¥ç®€å•ç›´æ¥â€”â€”ç§»é™¤æœ€ä¹…æœªè®¿é—®çš„æ•°æ®ã€‚ä¾‹å¦‚ï¼Œè‹¥ç¼“å­˜å®¹é‡ä¸º3ï¼Œè®¿é—®é¡ºåºä¸ºAâ†’Bâ†’Câ†’Aï¼Œåˆ™æ–°æ•°æ®æ’å…¥æ—¶æ·˜æ±°æœ€æ—§çš„Bã€‚&lt;/p>
&lt;h4 id="cå®ç°">&lt;strong>C++å®ç°&lt;/strong>&lt;/h4>
&lt;p>LRUéœ€é«˜æ•ˆæ”¯æŒä¸¤ç§æ“ä½œï¼š&lt;/p>
&lt;ol>
&lt;li>&lt;strong>å¿«é€ŸæŸ¥è¯¢&lt;/strong>ï¼ˆå“ˆå¸Œè¡¨ï¼ŒO(1)ï¼‰&lt;/li>
&lt;li>&lt;strong>é¡ºåºç»´æŠ¤&lt;/strong>ï¼ˆåŒå‘é“¾è¡¨ï¼ŒO(1)è°ƒæ•´é¡ºåºï¼‰&lt;/li>
&lt;/ol>
&lt;p>&lt;strong>æ•°æ®ç»“æ„è®¾è®¡&lt;/strong>ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">struct&lt;/span> &lt;span style="color:#a6e22e">Node&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">int&lt;/span> key, value;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Node &lt;span style="color:#f92672">*&lt;/span>prev, &lt;span style="color:#f92672">*&lt;/span>next;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Node(&lt;span style="color:#66d9ef">int&lt;/span> k, &lt;span style="color:#66d9ef">int&lt;/span> v) &lt;span style="color:#f92672">:&lt;/span> key(k), value(v), prev(&lt;span style="color:#66d9ef">nullptr&lt;/span>), next(&lt;span style="color:#66d9ef">nullptr&lt;/span>) {}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">class&lt;/span> &lt;span style="color:#a6e22e">LRUCache&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">private&lt;/span>&lt;span style="color:#f92672">:&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">int&lt;/span> capacity;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> unordered_map&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#66d9ef">int&lt;/span>, Node&lt;span style="color:#f92672">*&amp;gt;&lt;/span> cache; &lt;span style="color:#75715e">// å“ˆå¸Œè¡¨ï¼šé”®åˆ°èŠ‚ç‚¹æ˜ å°„
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> Node &lt;span style="color:#f92672">*&lt;/span>head, &lt;span style="color:#f92672">*&lt;/span>tail; &lt;span style="color:#75715e">// åŒå‘é“¾è¡¨å¤´å°¾å“¨å…µèŠ‚ç‚¹
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">void&lt;/span> &lt;span style="color:#a6e22e">moveToHead&lt;/span>(Node&lt;span style="color:#f92672">*&lt;/span> node) { &lt;span style="color:#75715e">// å°†èŠ‚ç‚¹ç§»è‡³å¤´éƒ¨
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> removeNode(node);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> addToHead(node);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">void&lt;/span> &lt;span style="color:#a6e22e">removeNode&lt;/span>(Node&lt;span style="color:#f92672">*&lt;/span> node) { &lt;span style="color:#75715e">// ç§»é™¤èŠ‚ç‚¹
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> node&lt;span style="color:#f92672">-&amp;gt;&lt;/span>prev&lt;span style="color:#f92672">-&amp;gt;&lt;/span>next &lt;span style="color:#f92672">=&lt;/span> node&lt;span style="color:#f92672">-&amp;gt;&lt;/span>next;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> node&lt;span style="color:#f92672">-&amp;gt;&lt;/span>next&lt;span style="color:#f92672">-&amp;gt;&lt;/span>prev &lt;span style="color:#f92672">=&lt;/span> node&lt;span style="color:#f92672">-&amp;gt;&lt;/span>prev;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">void&lt;/span> &lt;span style="color:#a6e22e">addToHead&lt;/span>(Node&lt;span style="color:#f92672">*&lt;/span> node) { &lt;span style="color:#75715e">// å¤´éƒ¨æ’å…¥èŠ‚ç‚¹
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> node&lt;span style="color:#f92672">-&amp;gt;&lt;/span>next &lt;span style="color:#f92672">=&lt;/span> head&lt;span style="color:#f92672">-&amp;gt;&lt;/span>next;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> node&lt;span style="color:#f92672">-&amp;gt;&lt;/span>prev &lt;span style="color:#f92672">=&lt;/span> head;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> head&lt;span style="color:#f92672">-&amp;gt;&lt;/span>next&lt;span style="color:#f92672">-&amp;gt;&lt;/span>prev &lt;span style="color:#f92672">=&lt;/span> node;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> head&lt;span style="color:#f92672">-&amp;gt;&lt;/span>next &lt;span style="color:#f92672">=&lt;/span> node;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">public&lt;/span>&lt;span style="color:#f92672">:&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> LRUCache(&lt;span style="color:#66d9ef">int&lt;/span> cap) &lt;span style="color:#f92672">:&lt;/span> capacity(cap) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> head &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">new&lt;/span> Node(&lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>, &lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>); &lt;span style="color:#75715e">// åˆå§‹åŒ–å“¨å…µèŠ‚ç‚¹
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> tail &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">new&lt;/span> Node(&lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>, &lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> head&lt;span style="color:#f92672">-&amp;gt;&lt;/span>next &lt;span style="color:#f92672">=&lt;/span> tail;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> tail&lt;span style="color:#f92672">-&amp;gt;&lt;/span>prev &lt;span style="color:#f92672">=&lt;/span> head;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">int&lt;/span> &lt;span style="color:#a6e22e">get&lt;/span>(&lt;span style="color:#66d9ef">int&lt;/span> key) { &lt;span style="color:#75715e">// æŸ¥è¯¢æ“ä½œ
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">auto&lt;/span> it &lt;span style="color:#f92672">=&lt;/span> cache.find(key);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (it &lt;span style="color:#f92672">==&lt;/span> cache.end()) &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> moveToHead(it&lt;span style="color:#f92672">-&amp;gt;&lt;/span>second); &lt;span style="color:#75715e">// æ›´æ–°ä¸ºæœ€è¿‘è®¿é—®
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">return&lt;/span> it&lt;span style="color:#f92672">-&amp;gt;&lt;/span>second&lt;span style="color:#f92672">-&amp;gt;&lt;/span>value;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">void&lt;/span> &lt;span style="color:#a6e22e">put&lt;/span>(&lt;span style="color:#66d9ef">int&lt;/span> key, &lt;span style="color:#66d9ef">int&lt;/span> value) { &lt;span style="color:#75715e">// æ’å…¥/æ›´æ–°æ“ä½œ
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">if&lt;/span> (cache.find(key) &lt;span style="color:#f92672">!=&lt;/span> cache.end()) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> cache[key]&lt;span style="color:#f92672">-&amp;gt;&lt;/span>value &lt;span style="color:#f92672">=&lt;/span> value;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> moveToHead(cache[key]);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Node&lt;span style="color:#f92672">*&lt;/span> newNode &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">new&lt;/span> Node(key, value);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> cache[key] &lt;span style="color:#f92672">=&lt;/span> newNode;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> addToHead(newNode);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (cache.size() &lt;span style="color:#f92672">&amp;gt;&lt;/span> capacity) { &lt;span style="color:#75715e">// è§¦å‘æ·˜æ±°
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> Node&lt;span style="color:#f92672">*&lt;/span> toDelete &lt;span style="color:#f92672">=&lt;/span> tail&lt;span style="color:#f92672">-&amp;gt;&lt;/span>prev;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> cache.erase(toDelete&lt;span style="color:#f92672">-&amp;gt;&lt;/span>key);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> removeNode(toDelete);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">delete&lt;/span> toDelete;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;strong>å…³é”®ç‚¹&lt;/strong>ï¼š&lt;br>
â€¢ ä½¿ç”¨&lt;strong>å“ˆå¸Œè¡¨+åŒå‘é“¾è¡¨&lt;/strong>å®ç°O(1)æ“ä½œå¤æ‚åº¦&lt;br>
â€¢ å¤´èŠ‚ç‚¹å­˜æ”¾æœ€æ–°è®¿é—®æ•°æ®ï¼Œå°¾èŠ‚ç‚¹ä¸ºå¾…æ·˜æ±°æ•°æ®&lt;/p></description></item><item><title>ã€AIã€‘åŠè¡°æœŸç®—æ³•åœ¨åç«¯çš„åº”ç”¨</title><link>https://jekyulll.github.io/posts/web-%E5%8D%8A%E8%A1%B0%E6%9C%9F%E7%AE%97%E6%B3%95%E5%9C%A8%E5%90%8E%E7%AB%AF%E7%9A%84%E5%BA%94%E7%94%A8/</link><pubDate>Mon, 10 Mar 2025 21:05:47 +0800</pubDate><guid>https://jekyulll.github.io/posts/web-%E5%8D%8A%E8%A1%B0%E6%9C%9F%E7%AE%97%E6%B3%95%E5%9C%A8%E5%90%8E%E7%AB%AF%E7%9A%84%E5%BA%94%E7%94%A8/</guid><description>&lt;p>åœ¨åç«¯å¼€å‘ä¸­ï¼ŒåŠè¡°æœŸç®—æ³•å¸¸ç”¨äºåŠ¨æ€è°ƒæ•´æ•°æ®æƒé‡çš„åœºæ™¯ï¼Œå…¶æ ¸å¿ƒæ˜¯é€šè¿‡æ—¶é—´è¡°å‡æœºåˆ¶å¹³è¡¡å®æ—¶æ€§ä¸å†å²ä»·å€¼ã€‚ä»¥ä¸‹æ˜¯å…¶å…¸å‹åº”ç”¨åŠå®ç°é€»è¾‘ï¼š&lt;/p>
&lt;h3 id="ä¸€ç®—æ³•åŸç†ä¸å…¬å¼">ä¸€ã€ç®—æ³•åŸç†ä¸å…¬å¼&lt;/h3>
&lt;p>åŠè¡°æœŸç®—æ³•åŸºäºæ”¾å°„æ€§è¡°å˜å…¬å¼ï¼š&lt;strong>M * (1/2)^(t/T)&lt;/strong>ï¼Œå…¶ä¸­ï¼š
â€¢ &lt;strong>M&lt;/strong>ï¼šåˆå§‹å€¼ï¼ˆå¦‚ç‚¹å‡»é‡ï¼‰
â€¢ &lt;strong>t&lt;/strong>ï¼šæ—¶é—´é—´éš”ï¼ˆå¦‚å¤©æ•°ï¼‰
â€¢ &lt;strong>T&lt;/strong>ï¼šåŠè¡°æœŸå‘¨æœŸï¼ˆå¦‚7å¤©ï¼‰
è¯¥å…¬å¼ä½¿æ•°æ®æƒé‡éšæ—¶é—´å‘ˆæŒ‡æ•°è¡°å‡ï¼Œä¾‹å¦‚7å¤©åŠè¡°æœŸæ„å‘³ç€æƒé‡æ¯å¤©å‡å°‘çº¦10%ã€‚&lt;/p>
&lt;h3 id="äºŒæ ¸å¿ƒåº”ç”¨åœºæ™¯">äºŒã€æ ¸å¿ƒåº”ç”¨åœºæ™¯&lt;/h3>
&lt;ol>
&lt;li>
&lt;p>&lt;strong>çƒ­æœæ’åº&lt;/strong>ï¼ˆå¦‚å¾®åšã€è…¾è®¯å¹³å°ï¼‰
â€¢ åŠ¨æ€å¹³è¡¡ç‚¹å‡»é‡ä¸æ—¶é—´è¡°å‡ï¼šæ–°äº‹ä»¶ç‚¹å‡»é‡é«˜ä½†è¡°å‡å¿«ï¼Œæ—§äº‹ä»¶ç‚¹å‡»é‡ä½ä½†è¡°å‡æ…¢ã€‚ä¾‹å¦‚ï¼š
â—¦ ç”µå½±ç±»åŠè¡°æœŸè®¾ä¸º7å¤©ï¼ˆT=7ï¼‰ï¼Œåˆå§‹æƒé‡1000ï¼Œå•æ—¥ç‚¹å‡»é‡20000æ—¶ï¼Œ2å¤©åæƒé‡ä¸º &lt;code>(1000+20000) * (1/2)^(2/7) * 0.8 â‰ˆ 17474.56&lt;/code>ã€‚
â—¦ å°è¯´ç±»åŠè¡°æœŸ15å¤©ï¼ˆT=15ï¼‰ï¼Œæ±½è½¦ç±»30å¤©ï¼ˆT=30ï¼‰ï¼Œä½“ç°ä¸åŒå†…å®¹æ—¶æ•ˆæ€§å·®å¼‚ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>æ¨èç³»ç»Ÿå†·å¯åŠ¨&lt;/strong>
â€¢ æ–°å†…å®¹é€šè¿‡åˆå§‹æƒé‡ï¼ˆå¦‚1000ï¼‰è·å¾—æ›å…‰æœºä¼šï¼ŒåŒæ—¶éšæ—¶é—´è‡ªç„¶è¡°å‡ï¼Œé¿å…é•¿æœŸå æ®æ¨èä½ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>åŠ¨æ€æ’è¡Œæ¦œ&lt;/strong>
â€¢ ç»“åˆå®æ—¶æ•°æ®ä¸å†å²è¡¨ç°ï¼šä¾‹å¦‚æ¸¸æˆæ´»åŠ¨æ¦œå•ï¼Œè¿‘æœŸæ´»è·ƒç©å®¶é€šè¿‡åŠè¡°æœŸå¿«é€Ÿæå‡æ’åï¼Œè€ç©å®¶è´¡çŒ®é€æ­¥é™ä½ã€‚&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h3 id="ä¸‰åç«¯å®ç°è¦ç‚¹">ä¸‰ã€åç«¯å®ç°è¦ç‚¹&lt;/h3>
&lt;ol>
&lt;li>
&lt;p>&lt;strong>æ•°æ®æ¨¡å‹è®¾è®¡&lt;/strong>
â€¢ æ•°æ®åº“éœ€å­˜å‚¨&lt;strong>åŸå§‹ç‚¹å‡»é‡&lt;/strong>å’Œ&lt;strong>è®¡ç®—åçš„æ’åºæƒé‡å­—æ®µ&lt;/strong>ï¼ˆå¦‚&lt;code>sort_info&lt;/code>ï¼‰ï¼Œé€šè¿‡å®šæ—¶ä»»åŠ¡ï¼ˆå¦‚æ¯å°æ—¶ï¼‰æ›´æ–°æƒé‡å€¼ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>å‚æ•°å¯é…ç½®åŒ–&lt;/strong>
â€¢ ä¸åŒä¸šåŠ¡ç±»å‹è®¾ç½®ç‹¬ç«‹å‚æ•°ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-php" data-lang="php">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">class&lt;/span> &lt;span style="color:#a6e22e">filmHalfLife&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">private&lt;/span> &lt;span style="color:#66d9ef">static&lt;/span> &lt;span style="color:#a6e22e">T&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">7&lt;/span>; &lt;span style="color:#75715e">//åŠè¡°æœŸå‘¨æœŸ
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">private&lt;/span> &lt;span style="color:#66d9ef">static&lt;/span> &lt;span style="color:#a6e22e">weight&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0.8&lt;/span>; &lt;span style="color:#75715e">//ç±»å‹æƒé‡
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>é€šè¿‡æ¥å£&lt;code>halfLifeFactory&lt;/code>å®ç°å¤šæ€ï¼Œæ”¯æŒæ‰©å±•æ–°ç±»å‹ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>é˜²ä½œå¼Šæœºåˆ¶&lt;/strong>
â€¢ å¼•å…¥&lt;strong>ç±»å‹æƒé‡ç³»æ•°&lt;/strong>ï¼ˆå¦‚ç”µå½±0.8ã€æ±½è½¦0.85ï¼‰ï¼Œé™ä½åˆ·é‡å¯¹æ’åºçš„å½±å“ã€‚
â€¢ ç»“åˆIPé¢‘ç‡é™åˆ¶ã€å¼‚å¸¸ç‚¹å‡»æ£€æµ‹ç­‰è¡¥å……æªæ–½ã€‚&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h3 id="å››æ‰©å±•ä¼˜åŒ–æ–¹å‘">å››ã€æ‰©å±•ä¼˜åŒ–æ–¹å‘&lt;/h3>
&lt;p>â€¢ &lt;strong>æ—¶é—´ç²’åº¦ç»†åŒ–&lt;/strong>ï¼šå°†å¤©çº§è®¡ç®—æ”¹ä¸ºå°æ—¶çº§ï¼Œé€‚åº”é«˜å®æ—¶æ€§åœºæ™¯ï¼ˆå¦‚çªå‘æ–°é—»ï¼‰ã€‚
â€¢ &lt;strong>å¤åˆè¡°å‡ç­–ç•¥&lt;/strong>ï¼šå åŠ å¤šä¸ªåŠè¡°æœŸå…¬å¼ï¼Œå¤„ç†å¤æ‚ä¸šåŠ¡é€»è¾‘ï¼ˆå¦‚çŸ­è§†é¢‘çƒ­åº¦éœ€åŒæ—¶è€ƒè™‘æ’­æ”¾ã€ç‚¹èµã€åˆ†äº«ï¼‰ã€‚
â€¢ &lt;strong>åŠ¨æ€è°ƒæ•´åŠè¡°æœŸ&lt;/strong>ï¼šé€šè¿‡æœºå™¨å­¦ä¹ æ ¹æ®å†å²æ•°æ®è‡ªåŠ¨ä¼˜åŒ–Tå€¼ã€‚&lt;/p>
&lt;blockquote>
&lt;p>è¯¥ç®—æ³•å·²åœ¨å®é™…å·¥ç¨‹ä¸­éªŒè¯å¯è¡Œæ€§ï¼Œä¾‹å¦‚æŸåšå®¢ç¤ºä¾‹ä¸­ï¼Œç”µå½±ç±»å†…å®¹åœ¨7å¤©å†…æƒé‡ä»1000è¡°å‡è‡³çº¦400ï¼Œè€Œæ±½è½¦ç±»å†…å®¹30å¤©åä»ä¿ç•™çº¦300æƒé‡ã€‚å¼€å‘è€…å¯æ ¹æ®ä¸šåŠ¡éœ€æ±‚è°ƒæ•´å…¬å¼å‚æ•°ï¼Œå¹³è¡¡æ—¶æ•ˆæ€§ä¸é•¿å°¾æ•ˆåº”ã€‚&lt;/p>
&lt;/blockquote></description></item><item><title>ã€AIã€‘C++å…«è‚¡ï¼šmainå‡½æ•°ä¹‹å‰æ‰§è¡Œäº†ä»€ä¹ˆï¼Ÿ</title><link>https://jekyulll.github.io/posts/cpp-c++%E5%85%AB%E8%82%A1main%E5%87%BD%E6%95%B0%E4%B9%8B%E5%89%8D%E6%89%A7%E8%A1%8C%E4%BA%86%E4%BB%80%E4%B9%88/</link><pubDate>Mon, 10 Mar 2025 12:05:47 +0800</pubDate><guid>https://jekyulll.github.io/posts/cpp-c++%E5%85%AB%E8%82%A1main%E5%87%BD%E6%95%B0%E4%B9%8B%E5%89%8D%E6%89%A7%E8%A1%8C%E4%BA%86%E4%BB%80%E4%B9%88/</guid><description>&lt;h3 id="ä¸€_startä¸__libc_start_call_mainçš„ä½œç”¨">ä¸€ã€&lt;code>_start&lt;/code>ä¸&lt;code>__libc_start_call_main&lt;/code>çš„ä½œç”¨&lt;/h3>
&lt;ol>
&lt;li>
&lt;p>&lt;strong>&lt;code>_start&lt;/code>ï¼šç¨‹åºçš„å…¥å£ç‚¹&lt;/strong>&lt;br>
&lt;u>&lt;code>_start&lt;/code>æ˜¯Linuxç¯å¢ƒä¸‹C/C++ç¨‹åºçš„&lt;strong>å®é™…å…¥å£å‡½æ•°&lt;/strong>ï¼Œç”±é“¾æ¥å™¨è‡ªåŠ¨æ·»åŠ åˆ°å¯æ‰§è¡Œæ–‡ä»¶ä¸­ï¼Œè´Ÿè´£åˆå§‹åŒ–è¿è¡Œæ—¶ç¯å¢ƒå¹¶è°ƒç”¨&lt;code>__libc_start_main&lt;/code>ã€‚&lt;/u>&lt;br>
å®ƒçš„æ ¸å¿ƒä»»åŠ¡åŒ…æ‹¬ï¼š&lt;br>
â€¢ è®¾ç½®æ ˆæŒ‡é’ˆï¼ˆ&lt;code>%ebp&lt;/code>æ¸…é›¶ï¼‰ã€ä¼ é€’å‚æ•°ï¼ˆå¦‚&lt;code>argc&lt;/code>å’Œ&lt;code>argv&lt;/code>ï¼‰åˆ°å¯„å­˜å™¨ã€‚&lt;br>
â€¢ åŠ è½½å…¨å±€åˆå§‹åŒ–å‡½æ•°ï¼ˆå¦‚&lt;code>__libc_csu_init&lt;/code>ï¼‰å’Œæ¸…ç†å‡½æ•°ï¼ˆå¦‚&lt;code>__libc_csu_fini&lt;/code>ï¼‰ã€‚&lt;br>
â€¢ è°ƒç”¨&lt;code>__libc_start_main&lt;/code>ï¼Œå¹¶å°†&lt;code>main&lt;/code>å‡½æ•°åœ°å€ä½œä¸ºå‚æ•°ä¼ é€’ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>&lt;code>__libc_start_call_main&lt;/code>ï¼šéæ‰˜ç®¡å…¥å£çš„æ¡¥æ¢&lt;/strong>&lt;br>
è¯¥å‡½æ•°ä½äº&lt;code>libc.so&lt;/code>ä¸­ï¼Œæ˜¯&lt;code>__libc_start_main&lt;/code>å†…éƒ¨è°ƒç”¨çš„å…³é”®æ­¥éª¤ï¼Œè´Ÿè´£&lt;strong>ç›´æ¥è§¦å‘éæ‰˜ç®¡&lt;code>main&lt;/code>å‡½æ•°çš„æ‰§è¡Œ&lt;/strong>ï¼ˆä¾‹å¦‚C++ä¸­çš„å…¨å±€æ„é€ å‡½æ•°å®Œæˆåï¼Œæœ€ç»ˆè°ƒç”¨ç”¨æˆ·ç¼–å†™çš„&lt;code>main&lt;/code>å‡½æ•°ï¼‰ã€‚åœ¨Linuxä¸‹ï¼Œå®ƒä¸&lt;code>__libc_start_main_impl&lt;/code>å…±åŒå®Œæˆç”¨æˆ·æ€åˆ°ç¨‹åºä¸»é€»è¾‘çš„è¿‡æ¸¡ã€‚&lt;/p>
&lt;/li>
&lt;/ol>
&lt;hr>
&lt;h3 id="äºŒcç¨‹åºåœ¨mainå‡½æ•°å‰çš„æ‰§è¡Œæµç¨‹">äºŒã€C++ç¨‹åºåœ¨&lt;code>main&lt;/code>å‡½æ•°å‰çš„æ‰§è¡Œæµç¨‹&lt;/h3>
&lt;ol>
&lt;li>
&lt;p>&lt;strong>æ“ä½œç³»ç»ŸåŠ è½½ä¸å†…å­˜åˆ†é…&lt;/strong>&lt;br>
â€¢ å¯æ‰§è¡Œæ–‡ä»¶è¢«åŠ è½½åˆ°å†…å­˜ï¼Œæ“ä½œç³»ç»Ÿåˆ†é…æ ˆã€å †ç©ºé—´ï¼Œå¹¶åˆå§‹åŒ–&lt;code>.data&lt;/code>ï¼ˆå·²åˆå§‹åŒ–å…¨å±€å˜é‡ï¼‰å’Œ&lt;code>.bss&lt;/code>ï¼ˆæœªåˆå§‹åŒ–å…¨å±€å˜é‡ï¼‰æ®µã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>å…¨å±€å˜é‡ä¸é™æ€å¯¹è±¡çš„åˆå§‹åŒ–&lt;/strong>&lt;br>
â€¢ &lt;strong>&lt;code>.data&lt;/code>æ®µå˜é‡&lt;/strong>ï¼šç›´æ¥èµ‹åˆå€¼ï¼ˆå¦‚&lt;code>float global_float = 3.14&lt;/code>ï¼‰ã€‚&lt;br>
â€¢ &lt;strong>&lt;code>.bss&lt;/code>æ®µå˜é‡&lt;/strong>ï¼šæ•°å€¼ç±»å‹åˆå§‹åŒ–ä¸º0ï¼ŒæŒ‡é’ˆåˆå§‹åŒ–ä¸º&lt;code>NULL&lt;/code>ã€‚&lt;br>
â€¢ &lt;strong>å…¨å±€å¯¹è±¡æ„é€ å‡½æ•°&lt;/strong>ï¼šåœ¨&lt;code>main&lt;/code>å‰æŒ‰å®šä¹‰é¡ºåºè°ƒç”¨ï¼ˆä¾‹å¦‚&lt;code>AnotherClass another_global_object&lt;/code>çš„æ„é€ å‡½æ•°ï¼‰ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>è¿è¡Œæ—¶åº“çš„åˆå§‹åŒ–&lt;/strong>&lt;br>
â€¢ C++è¿è¡Œæ—¶åº“ï¼ˆå¦‚&lt;code>libstdc++&lt;/code>ï¼‰æ‰§è¡Œåˆå§‹åŒ–ï¼ŒåŒ…æ‹¬å †ç®¡ç†ã€å¼‚å¸¸å¤„ç†æ¡†æ¶ç­‰ã€‚&lt;br>
â€¢ é™æ€æˆå‘˜å˜é‡çš„åˆå§‹åŒ–ï¼ˆå¦‚&lt;code>AnotherClass::static_double = 2.718&lt;/code>ï¼‰ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>å‚æ•°ä¼ é€’ä¸å…¥å£è·³è½¬&lt;/strong>&lt;br>
â€¢ &lt;code>_start&lt;/code>é€šè¿‡&lt;code>__libc_start_main&lt;/code>å°†&lt;code>argc&lt;/code>ã€&lt;code>argv&lt;/code>å’Œ&lt;code>envp&lt;/code>ä¼ é€’ç»™&lt;code>main&lt;/code>å‡½æ•°ï¼Œæœ€ç»ˆé€šè¿‡&lt;code>__libc_start_call_main&lt;/code>è§¦å‘&lt;code>main&lt;/code>çš„æ‰§è¡Œã€‚&lt;/p>
&lt;/li>
&lt;/ol>
&lt;hr>
&lt;h3 id="ä¸‰å…³é”®å·®å¼‚ä¸æ³¨æ„äº‹é¡¹">ä¸‰ã€å…³é”®å·®å¼‚ä¸æ³¨æ„äº‹é¡¹&lt;/h3>
&lt;ol>
&lt;li>
&lt;p>&lt;strong>ä¸Windowsçš„å¯¹æ¯”&lt;/strong>&lt;br>
â€¢ &lt;strong>Linux&lt;/strong>ï¼šå…¥å£é“¾ä¸º&lt;code>_start â†’ __libc_start_main â†’ __libc_start_call_main â†’ main&lt;/code>ã€‚&lt;br>
â€¢ &lt;strong>Windows&lt;/strong>ï¼šå…¥å£å‡½æ•°ä¸º&lt;code>RtlUserThreadStart&lt;/code>ï¼ˆ&lt;code>ntdll.dll&lt;/code>ï¼‰ï¼Œéæ‰˜ç®¡å…¥å£é€šè¿‡&lt;code>BaseThreadInitThunk&lt;/code>ï¼ˆ&lt;code>kernel32.dll&lt;/code>ï¼‰è°ƒç”¨ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>åˆå§‹åŒ–é¡ºåºçš„æ½œåœ¨é—®é¢˜&lt;/strong>&lt;br>
è‹¥å…¨å±€å¯¹è±¡ä¹‹é—´å­˜åœ¨ä¾èµ–ï¼ˆå¦‚Aä¾èµ–Bï¼‰ï¼Œéœ€é€šè¿‡&lt;strong>ç¼–è¯‘å•å…ƒé¡ºåºæ§åˆ¶&lt;/strong>æˆ–&lt;code>__attribute__((init_priority))&lt;/code>ï¼ˆGCCæ‰©å±•ï¼‰å¼ºåˆ¶æŒ‡å®šåˆå§‹åŒ–é¡ºåºï¼Œé¿å…æœªå®šä¹‰è¡Œä¸ºã€‚&lt;/p>
&lt;/li>
&lt;/ol>
&lt;hr>
&lt;h3 id="æ€»ç»“">æ€»ç»“&lt;/h3>
&lt;p>C++ç¨‹åºçš„å¯åŠ¨è¿‡ç¨‹è¿œä¸æ­¢&lt;code>main&lt;/code>å‡½æ•°çš„æ‰§è¡Œï¼Œå…¶æ ¸å¿ƒåœ¨äºæ“ä½œç³»ç»Ÿå’Œè¿è¡Œæ—¶åº“çš„åä½œåˆå§‹åŒ–ã€‚ç†è§£&lt;code>_start&lt;/code>ä¸&lt;code>__libc_start_call_main&lt;/code>çš„ä½œç”¨ï¼Œä»¥åŠå…¨å±€å¯¹è±¡çš„æ„é€ é¡ºåºï¼Œå¯¹äºè°ƒè¯•å¯åŠ¨å´©æºƒã€ä¼˜åŒ–èµ„æºåˆå§‹åŒ–è‡³å…³é‡è¦ã€‚ä¾‹å¦‚ï¼Œè‹¥ç¨‹åºåœ¨&lt;code>main&lt;/code>å‰å´©æºƒï¼Œéœ€ä¼˜å…ˆæ’æŸ¥å…¨å±€å¯¹è±¡çš„æ„é€ å‡½æ•°æˆ–é™æ€å˜é‡åˆå§‹åŒ–é€»è¾‘ã€‚&lt;/p></description></item><item><title>ã€AIã€‘ä½¿ç”¨æ™®é€šçš„äº’æ–¥é”å®ç°è¯»å†™é”</title><link>https://jekyulll.github.io/posts/cpp-%E4%BD%BF%E7%94%A8%E6%99%AE%E9%80%9A%E7%9A%84%E4%BA%92%E6%96%A5%E9%94%81%E5%AE%9E%E7%8E%B0%E8%AF%BB%E5%86%99%E9%94%81/</link><pubDate>Mon, 10 Mar 2025 12:05:47 +0800</pubDate><guid>https://jekyulll.github.io/posts/cpp-%E4%BD%BF%E7%94%A8%E6%99%AE%E9%80%9A%E7%9A%84%E4%BA%92%E6%96%A5%E9%94%81%E5%AE%9E%E7%8E%B0%E8%AF%BB%E5%86%99%E9%94%81/</guid><description>&lt;p>æ ¸å¿ƒåœ¨äºé€šè¿‡&lt;strong>çŠ¶æ€ç®¡ç†&lt;/strong>å’Œ&lt;strong>é”çš„ç»„åˆ&lt;/strong>æ¥æ¨¡æ‹Ÿè¯»å†™é”çš„â€œè¯»å…±äº«ã€å†™ç‹¬å â€ç‰¹æ€§ã€‚ä»¥ä¸‹æ˜¯å®ç°æ€è·¯å’Œå…·ä½“æ–¹æ³•ï¼š&lt;/p>
&lt;hr>
&lt;h3 id="ä¸€å®ç°åŸç†">ä¸€ã€å®ç°åŸç†&lt;/h3>
&lt;p>è¯»å†™é”çš„æ ¸å¿ƒè§„åˆ™æ˜¯ï¼š&lt;/p>
&lt;ol>
&lt;li>&lt;strong>è¯»è¯»å…±äº«&lt;/strong>ï¼šå…è®¸å¤šä¸ªè¯»çº¿ç¨‹å¹¶å‘è®¿é—®ã€‚&lt;/li>
&lt;li>&lt;strong>è¯»å†™äº’æ–¥&lt;/strong>ï¼šè¯»çº¿ç¨‹å’Œå†™çº¿ç¨‹ä¸èƒ½åŒæ—¶è®¿é—®ã€‚&lt;/li>
&lt;li>&lt;strong>å†™å†™äº’æ–¥&lt;/strong>ï¼šåŒä¸€æ—¶é—´åªèƒ½æœ‰ä¸€ä¸ªå†™çº¿ç¨‹è®¿é—®ã€‚&lt;/li>
&lt;/ol>
&lt;p>ä½¿ç”¨æ™®é€šäº’æ–¥é”ï¼ˆ&lt;code>std::mutex&lt;/code>ï¼‰å’Œè®¡æ•°å™¨å¯ä»¥å®ç°è¿™ä¸€é€»è¾‘ï¼š&lt;br>
â€¢ &lt;strong>è¯»è®¡æ•°å™¨&lt;/strong>ï¼šç»Ÿè®¡å½“å‰æ´»è·ƒçš„è¯»çº¿ç¨‹æ•°é‡ã€‚&lt;br>
â€¢ &lt;strong>å†™äº’æ–¥é”&lt;/strong>ï¼šç¡®ä¿å†™æ“ä½œçš„ç‹¬å æ€§ã€‚&lt;br>
â€¢ &lt;strong>çŠ¶æ€ä¿æŠ¤é”&lt;/strong>ï¼šä¿æŠ¤è¯»è®¡æ•°å™¨å’Œå†™é”çŠ¶æ€çš„åŸå­æ€§ã€‚&lt;/p>
&lt;hr>
&lt;h3 id="äºŒå®ç°æ­¥éª¤">äºŒã€å®ç°æ­¥éª¤&lt;/h3>
&lt;h4 id="1-å®šä¹‰å…³é”®æˆå‘˜å˜é‡">1. å®šä¹‰å…³é”®æˆå‘˜å˜é‡&lt;/h4>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;mutex&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;condition_variable&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">class&lt;/span> &lt;span style="color:#a6e22e">ReadWriteLock&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">private&lt;/span>&lt;span style="color:#f92672">:&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> std&lt;span style="color:#f92672">::&lt;/span>mutex counter_mutex; &lt;span style="color:#75715e">// ä¿æŠ¤è¯»è®¡æ•°å™¨å’Œå†™æ ‡å¿—
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> std&lt;span style="color:#f92672">::&lt;/span>mutex write_mutex; &lt;span style="color:#75715e">// å†™æ“ä½œçš„ç‹¬å é”
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">int&lt;/span> reader_count &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>; &lt;span style="color:#75715e">// å½“å‰æ´»è·ƒçš„è¯»çº¿ç¨‹æ•°é‡
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">bool&lt;/span> write_pending &lt;span style="color:#f92672">=&lt;/span> false; &lt;span style="color:#75715e">// æ˜¯å¦æœ‰å†™çº¿ç¨‹åœ¨ç­‰å¾…
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> std&lt;span style="color:#f92672">::&lt;/span>condition_variable read_cv, write_cv;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h4 id="2-è¯»é”çš„è·å–ä¸é‡Šæ”¾">2. è¯»é”çš„è·å–ä¸é‡Šæ”¾&lt;/h4>
&lt;p>â€¢ &lt;strong>è·å–è¯»é”&lt;/strong>ï¼š&lt;br>
å½“æ— å†™çº¿ç¨‹è¿è¡Œæ—¶ï¼Œå…è®¸è¯»çº¿ç¨‹è¿›å…¥ï¼›è‹¥å­˜åœ¨å†™çº¿ç¨‹ç­‰å¾…ï¼Œåˆ™é˜»å¡æ–°è¯»çº¿ç¨‹ï¼ˆé¿å…å†™é¥¥é¥¿ï¼‰ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">void&lt;/span> &lt;span style="color:#a6e22e">read_lock&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> std&lt;span style="color:#f92672">::&lt;/span>unique_lock&lt;span style="color:#f92672">&amp;lt;&lt;/span>std&lt;span style="color:#f92672">::&lt;/span>mutex&lt;span style="color:#f92672">&amp;gt;&lt;/span> lock(counter_mutex);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// ç­‰å¾…ç›´åˆ°æ²¡æœ‰å†™çº¿ç¨‹åœ¨ç­‰å¾…æˆ–è¿è¡Œ
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> read_cv.wait(lock, [&lt;span style="color:#66d9ef">this&lt;/span>] { &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#f92672">!&lt;/span>write_pending; });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> reader_count&lt;span style="color:#f92672">++&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (reader_count &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> write_mutex.lock(); &lt;span style="color:#75715e">// ç¬¬ä¸€ä¸ªè¯»çº¿ç¨‹è·å–å†™é”ï¼Œé˜»æ­¢å†™æ“ä½œ
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>â€¢ &lt;strong>é‡Šæ”¾è¯»é”&lt;/strong>ï¼š&lt;br>
å‡å°‘è¯»è®¡æ•°å™¨ï¼Œè‹¥æœ€åä¸€ä¸ªè¯»çº¿ç¨‹é€€å‡ºï¼Œåˆ™é‡Šæ”¾å†™é”å¹¶é€šçŸ¥å¯èƒ½çš„ç­‰å¾…å†™çº¿ç¨‹ã€‚&lt;/p></description></item><item><title>ã€AIã€‘mmap å’Œé›¶æ‹·è´</title><link>https://jekyulll.github.io/posts/linux-mmap-%E5%92%8C%E9%9B%B6%E6%8B%B7%E8%B4%9D/</link><pubDate>Fri, 07 Mar 2025 20:05:47 +0800</pubDate><guid>https://jekyulll.github.io/posts/linux-mmap-%E5%92%8C%E9%9B%B6%E6%8B%B7%E8%B4%9D/</guid><description>&lt;p>mmapï¼ˆMemory Mappingï¼‰æ˜¯Unix/Linuxç³»ç»Ÿä¸­çš„ä¸€ç§é‡è¦æœºåˆ¶ï¼Œå®ƒå…è®¸å°†æ–‡ä»¶æˆ–è®¾å¤‡ç›´æ¥æ˜ å°„åˆ°è¿›ç¨‹çš„è™šæ‹Ÿåœ°å€ç©ºé—´ï¼Œä»è€Œå°†æ–‡ä»¶æ“ä½œä¸å†…å­˜æ“ä½œé«˜æ•ˆç»“åˆã€‚ä»¥ä¸‹ä»æ ¸å¿ƒæœºåˆ¶ã€ä¸IOçš„å…³ç³»ã€ä¸å†…å­˜åˆ†é…çš„å…³ç³»ä¸‰ä¸ªæ–¹é¢è¯¦ç»†è§£æï¼š&lt;/p>
&lt;hr>
&lt;h3 id="ä¸€mmapçš„æ ¸å¿ƒæœºåˆ¶">ä¸€ã€mmapçš„æ ¸å¿ƒæœºåˆ¶&lt;/h3>
&lt;ol>
&lt;li>
&lt;p>&lt;strong>ç³»ç»Ÿè°ƒç”¨ä¸æ˜ å°„æ–¹å¼&lt;/strong>ï¼š
â€¢ &lt;strong>å‡½æ•°åŸå‹&lt;/strong>ï¼š&lt;code>void *mmap(void *addr, size_t length, int prot, int flags, int fd, off_t offset);&lt;/code>
â€¢ &lt;strong>å…³é”®å‚æ•°&lt;/strong>ï¼š
â—¦ &lt;code>prot&lt;/code>ï¼šæ§åˆ¶è¯»å†™æƒé™ï¼ˆå¦‚&lt;code>PROT_READ&lt;/code>ã€&lt;code>PROT_WRITE&lt;/code>ï¼‰ã€‚
â—¦ &lt;code>flags&lt;/code>ï¼šå†³å®šæ˜ å°„ç±»å‹ï¼ˆ&lt;code>MAP_SHARED&lt;/code>ã€&lt;code>MAP_PRIVATE&lt;/code>ã€&lt;code>MAP_ANONYMOUS&lt;/code>ï¼‰ã€‚
â€¢ &lt;strong>ä¸¤ç§ä¸»è¦æ˜ å°„&lt;/strong>ï¼š
â—¦ &lt;strong>æ–‡ä»¶æ˜ å°„&lt;/strong>ï¼šå°†æ–‡ä»¶æ˜ å°„åˆ°å†…å­˜ï¼Œä¿®æ”¹å¯åŒæ­¥åˆ°æ–‡ä»¶ï¼ˆ&lt;code>MAP_SHARED&lt;/code>ï¼‰æˆ–ä»…è¿›ç¨‹å¯è§ï¼ˆ&lt;code>MAP_PRIVATE&lt;/code>ï¼‰ã€‚
â—¦ &lt;strong>åŒ¿åæ˜ å°„&lt;/strong>ï¼šä¸å…³è”æ–‡ä»¶ï¼Œç”¨äºè¿›ç¨‹é—´å…±äº«å†…å­˜æˆ–åŠ¨æ€å†…å­˜åˆ†é…ï¼ˆ&lt;code>MAP_ANONYMOUS&lt;/code>ï¼‰ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>å®ç°åŸç†&lt;/strong>ï¼š
â€¢ &lt;strong>è™šæ‹Ÿå†…å­˜ç®¡ç†&lt;/strong>ï¼šmmapåœ¨è¿›ç¨‹çš„è™šæ‹Ÿåœ°å€ç©ºé—´ä¸­åˆ’åˆ†ä¸€æ®µåŒºåŸŸï¼ˆé€šå¸¸ä½äºå †ä¸æ ˆä¹‹é—´ï¼‰ï¼Œé€šè¿‡é¡µè¡¨æ˜ å°„åˆ°ç‰©ç†å†…å­˜æˆ–æ–‡ä»¶çš„é¡µç¼“å­˜ã€‚
â€¢ &lt;strong>æŒ‰éœ€åŠ è½½ï¼ˆDemand Pagingï¼‰&lt;/strong>ï¼šè®¿é—®æ˜ å°„å†…å­˜æ—¶è§¦å‘ç¼ºé¡µä¸­æ–­ï¼Œå†…æ ¸è‡ªåŠ¨å°†æ–‡ä»¶æ•°æ®åŠ è½½åˆ°ç‰©ç†å†…å­˜ï¼Œå‡å°‘ä¸€æ¬¡æ€§åŠ è½½å¼€é”€ã€‚
â€¢ &lt;strong>åŒæ­¥æœºåˆ¶&lt;/strong>ï¼šä¿®æ”¹åçš„æ•°æ®ç”±å†…æ ¸å¼‚æ­¥å†™å›æ–‡ä»¶ï¼Œä¹Ÿå¯é€šè¿‡&lt;code>msync()&lt;/code>å¼ºåˆ¶åŒæ­¥ã€‚&lt;/p>
&lt;/li>
&lt;/ol>
&lt;hr>
&lt;h3 id="äºŒmmapä¸ioçš„å…³ç³»">äºŒã€mmapä¸IOçš„å…³ç³»&lt;/h3>
&lt;ol>
&lt;li>
&lt;p>&lt;strong>ä¼ ç»ŸIOçš„ç“¶é¢ˆ&lt;/strong>ï¼š
â€¢ &lt;strong>æ•°æ®æ‹·è´å¼€é”€&lt;/strong>ï¼š&lt;code>read()&lt;/code>/&lt;code>write()&lt;/code>éœ€è¦åœ¨å†…æ ¸ç¼“å†²åŒºï¼ˆé¡µç¼“å­˜ï¼‰ä¸ç”¨æˆ·ç©ºé—´ä¹‹é—´å¤åˆ¶æ•°æ®ï¼Œé¢‘ç¹ç³»ç»Ÿè°ƒç”¨å’Œæ‹·è´é™ä½æ€§èƒ½ã€‚
â€¢ &lt;strong>å°æ–‡ä»¶é—®é¢˜&lt;/strong>ï¼šå¤šæ¬¡ç³»ç»Ÿè°ƒç”¨å¯¹å°æ–‡ä»¶ä¸å‹å¥½ï¼Œå¢åŠ ä¸Šä¸‹æ–‡åˆ‡æ¢å¼€é”€ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>mmapçš„ä¼˜åŠ¿&lt;/strong>ï¼š
â€¢ &lt;strong>é›¶æ‹·è´ï¼ˆZero-Copyï¼‰&lt;/strong>ï¼šç›´æ¥æ“ä½œæ˜ å°„å†…å­˜ï¼Œçœå»ç”¨æˆ·æ€ä¸å†…æ ¸æ€çš„æ•°æ®æ‹·è´ã€‚
â€¢ &lt;strong>å‡å°‘ç³»ç»Ÿè°ƒç”¨&lt;/strong>ï¼šé€šè¿‡å†…å­˜è®¿é—®éšå¼å®Œæˆæ–‡ä»¶è¯»å†™ï¼Œæ— éœ€æ˜¾å¼è°ƒç”¨&lt;code>read()&lt;/code>/&lt;code>write()&lt;/code>ã€‚
â€¢ &lt;strong>é«˜æ•ˆå¤§æ–‡ä»¶å¤„ç†&lt;/strong>ï¼šæŒ‰éœ€åŠ è½½ï¼Œé¿å…ä¸€æ¬¡æ€§åŠ è½½å¤§æ–‡ä»¶çš„å»¶è¿Ÿå’Œå†…å­˜æµªè´¹ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>æ€§èƒ½å¯¹æ¯”&lt;/strong>ï¼š
â€¢ &lt;strong>é¡ºåºè®¿é—®&lt;/strong>ï¼šmmapä¸&lt;code>read()&lt;/code>æ€§èƒ½æ¥è¿‘ï¼Œä½†çœå»æ‹·è´æ—¶é—´ã€‚
â€¢ &lt;strong>éšæœºè®¿é—®&lt;/strong>ï¼šmmapæ˜¾è‘—ä¼˜äºä¼ ç»ŸIOï¼Œå‡å°‘å¤šæ¬¡&lt;code>lseek()&lt;/code>å’Œ&lt;code>read()&lt;/code>çš„å¼€é”€ã€‚
â€¢ &lt;strong>é€‚ç”¨åœºæ™¯&lt;/strong>ï¼šé€‚åˆé¢‘ç¹è¯»å†™æˆ–éœ€è¦éšæœºè®¿é—®çš„å¤§æ–‡ä»¶ï¼ˆå¦‚æ•°æ®åº“ã€å›¾åƒå¤„ç†ï¼‰ã€‚&lt;/p>
&lt;/li>
&lt;/ol>
&lt;hr>
&lt;h3 id="ä¸‰mmapä¸å†…å­˜åˆ†é…çš„å…³ç³»">ä¸‰ã€mmapä¸å†…å­˜åˆ†é…çš„å…³ç³»&lt;/h3>
&lt;ol>
&lt;li>
&lt;p>&lt;strong>åŠ¨æ€å†…å­˜åˆ†é…&lt;/strong>ï¼š
â€¢ &lt;strong>glibcçš„mallocç­–ç•¥&lt;/strong>ï¼š
â—¦ å°å—å†…å­˜ï¼ˆå¦‚&amp;lt;128KBï¼‰ä½¿ç”¨&lt;code>brk()&lt;/code>æ‰©å±•å †å†…å­˜ã€‚
â—¦ å¤§å—å†…å­˜ä½¿ç”¨&lt;code>mmap(MAP_ANONYMOUS)&lt;/code>ç‹¬ç«‹æ˜ å°„ï¼Œé¿å…å†…å­˜ç¢ç‰‡ã€‚
â€¢ &lt;strong>ä¼˜åŠ¿&lt;/strong>ï¼š&lt;code>mmap&lt;/code>åˆ†é…çš„å†…å­˜å¯ç‹¬ç«‹é‡Šæ”¾ï¼ˆ&lt;code>munmap()&lt;/code>ï¼‰ï¼Œè€Œ&lt;code>brk()&lt;/code>é‡Šæ”¾éœ€ä¾èµ–å †é¡¶å†…å­˜é‡Šæ”¾é¡ºåºã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>åŒ¿åæ˜ å°„çš„åº”ç”¨&lt;/strong>ï¼š
â€¢ &lt;strong>è¿›ç¨‹é—´å…±äº«å†…å­˜&lt;/strong>ï¼šé€šè¿‡&lt;code>MAP_SHARED&lt;/code>æ ‡å¿—ï¼Œå¤šä¸ªè¿›ç¨‹å¯å…±äº«åŒä¸€ç‰©ç†å†…å­˜ï¼Œé«˜æ•ˆé€šä¿¡ã€‚
â€¢ &lt;strong>è‡ªå®šä¹‰å†…å­˜ç®¡ç†&lt;/strong>ï¼šæ›¿ä»£&lt;code>malloc&lt;/code>ï¼Œç”¨äºéœ€è¦ç²¾ç»†æ§åˆ¶çš„å¤§å†…å­˜åˆ†é…ï¼ˆå¦‚å†…å­˜æ± ï¼‰ã€‚&lt;/p></description></item><item><title>å†…æ ¸çš„ç”¨æˆ·æ€å’Œå†…æ ¸æ€</title><link>https://jekyulll.github.io/posts/linux-%E5%86%85%E6%A0%B8%E7%9A%84%E7%94%A8%E6%88%B7%E6%80%81%E5%92%8C%E5%86%85%E6%A0%B8%E6%80%81/</link><pubDate>Fri, 07 Mar 2025 20:05:47 +0800</pubDate><guid>https://jekyulll.github.io/posts/linux-%E5%86%85%E6%A0%B8%E7%9A%84%E7%94%A8%E6%88%B7%E6%80%81%E5%92%8C%E5%86%85%E6%A0%B8%E6%80%81/</guid><description>&lt;p>çº¿ç¨‹çš„ç®¡ç†å’Œè°ƒåº¦æ¶‰åŠç”¨æˆ·æ€ä¸å†…æ ¸æ€çš„åä½œï¼Œä¸åŒç¼–ç¨‹è¯­è¨€å’Œæ“ä½œç³»ç»Ÿå¯¹çº¿ç¨‹çš„å¤„ç†æ–¹å¼ä¹Ÿæœ‰æ‰€å·®å¼‚ã€‚&lt;/p>
&lt;hr>
&lt;h3 id="ä¸€çº¿ç¨‹æ¦‚å¿µçš„åŒé‡æ€§ç”¨æˆ·æ€ä¸å†…æ ¸æ€çš„äº¤ç»‡">ä¸€ã€çº¿ç¨‹æ¦‚å¿µçš„åŒé‡æ€§ï¼šç”¨æˆ·æ€ä¸å†…æ ¸æ€çš„äº¤ç»‡&lt;/h3>
&lt;ol>
&lt;li>
&lt;p>&lt;strong>ç”¨æˆ·æ€çº¿ç¨‹ï¼ˆç”¨æˆ·çº§çº¿ç¨‹ï¼‰&lt;/strong>&lt;br>
ç”¨æˆ·æ€çº¿ç¨‹ç”±ç”¨æˆ·ç©ºé—´çš„çº¿ç¨‹åº“ç›´æ¥ç®¡ç†ï¼Œå†…æ ¸å¯¹å…¶æ— æ„ŸçŸ¥ã€‚è¿™ç±»çº¿ç¨‹çš„åˆ›å»ºã€è°ƒåº¦ã€åŒæ­¥ç­‰æ“ä½œå®Œå…¨åœ¨ç”¨æˆ·ç©ºé—´å®Œæˆï¼Œæ— éœ€å†…æ ¸ä»‹å…¥ã€‚&lt;br>
å­˜åœ¨æ˜æ˜¾å±€é™æ€§ï¼š&lt;br>
â€¢ &lt;strong>é˜»å¡é—®é¢˜&lt;/strong>ï¼šè‹¥ä¸€ä¸ªç”¨æˆ·æ€çº¿ç¨‹å› ç³»ç»Ÿè°ƒç”¨é˜»å¡ï¼ˆå¦‚I/Oæ“ä½œï¼‰ï¼Œæ•´ä¸ªè¿›ç¨‹çš„æ‰€æœ‰çº¿ç¨‹éƒ½ä¼šè¢«é˜»å¡ï¼›
â€¢ &lt;strong>å¤šæ ¸åˆ©ç”¨ç‡ä½&lt;/strong>ï¼šå†…æ ¸æ— æ³•å°†ç”¨æˆ·æ€çº¿ç¨‹è°ƒåº¦åˆ°å¤šä¸ªCPUæ ¸å¿ƒä¸Šè¿è¡Œã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>å†…æ ¸æ€çº¿ç¨‹ï¼ˆå†…æ ¸çº§çº¿ç¨‹ï¼‰&lt;/strong>&lt;br>
å†…æ ¸ç›´æ¥ç®¡ç†çº¿ç¨‹çš„åˆ›å»ºã€è°ƒåº¦å’Œé”€æ¯ï¼Œæ¯ä¸ªçº¿ç¨‹å¯¹åº”ä¸€ä¸ªå†…æ ¸çº¿ç¨‹ï¼ˆå¦‚Linuxçš„è½»é‡çº§è¿›ç¨‹LWPï¼‰ã€‚&lt;/p>
&lt;blockquote>
&lt;p>&lt;em>è½»é‡çº§è¿›ç¨‹&lt;/em>ï¼ˆLight Weight Process, LWPï¼‰ä½œä¸ºç”¨æˆ·çº¿ç¨‹ä¸å†…æ ¸çº¿ç¨‹çš„æ¡¥æ¢ï¼Œè´Ÿè´£å¤„ç†ç³»ç»Ÿè°ƒç”¨ã€èµ„æºåˆ†é…å’ŒCPUæ˜ å°„ã€‚å½“ç”¨æˆ·çº¿ç¨‹å‘èµ·ç³»ç»Ÿè°ƒç”¨æ—¶ï¼ŒLWPæ¥ç®¡è¯·æ±‚ï¼Œé¿å…å› å•ä¸ªç”¨æˆ·çº¿ç¨‹é˜»å¡å¯¼è‡´æ•´ä¸ªè¿›ç¨‹æŒ‚èµ·ã€‚&lt;/p>
&lt;/blockquote>
&lt;p>â€¢ &lt;strong>å¤šæ ¸å¹¶è¡Œ&lt;/strong>ï¼šå†…æ ¸å¯å°†ä¸åŒçº¿ç¨‹åˆ†é…åˆ°å¤šä¸ªCPUæ ¸å¿ƒï¼›
â€¢ &lt;strong>ç‹¬ç«‹é˜»å¡&lt;/strong>ï¼šå•ä¸ªçº¿ç¨‹é˜»å¡ä¸ä¼šå½±å“å…¶ä»–çº¿ç¨‹ï¼›
â€¢ &lt;strong>åˆ‡æ¢å¼€é”€å¤§&lt;/strong>ï¼šçº¿ç¨‹åˆ‡æ¢éœ€é€šè¿‡å†…æ ¸æ€ï¼Œæ¶‰åŠç”¨æˆ·æ ˆå’Œå†…æ ¸æ ˆçš„åˆ‡æ¢ã€å¯„å­˜å™¨ä¿å­˜ä¸æ¢å¤ç­‰æ“ä½œã€‚&lt;/p>
&lt;/li>
&lt;/ol>
&lt;hr>
&lt;h3 id="äºŒå†…æ ¸å¦‚ä½•å¤„ç†çº¿ç¨‹">äºŒã€å†…æ ¸å¦‚ä½•å¤„ç†çº¿ç¨‹ï¼Ÿ&lt;/h3>
&lt;ol>
&lt;li>
&lt;p>&lt;strong>çº¿ç¨‹æ¨¡å‹çš„æ˜ å°„å…³ç³»&lt;/strong>&lt;br>
ç°ä»£æ“ä½œç³»ç»Ÿï¼ˆå¦‚Linuxï¼‰é€šå¸¸é‡‡ç”¨&lt;strong>æ··åˆå‹çº¿ç¨‹æ¨¡å‹&lt;/strong>ã€‚å†…æ ¸é€šè¿‡ä»¥ä¸‹æœºåˆ¶ç®¡ç†çº¿ç¨‹ï¼š&lt;br>
â€¢ &lt;strong>TCBï¼ˆçº¿ç¨‹æ§åˆ¶å—ï¼‰&lt;/strong>ï¼šå­˜å‚¨çº¿ç¨‹çš„å†…æ ¸æ ˆæŒ‡é’ˆã€çŠ¶æ€ã€ä¼˜å…ˆçº§ç­‰ä¿¡æ¯ï¼ˆè¿›ç¨‹æ§åˆ¶å—æ˜¯PCBï¼‰ï¼›
â€¢ &lt;strong>è°ƒåº¦å™¨&lt;/strong>ï¼šåŸºäºæ—¶é—´ç‰‡è½®è½¬æˆ–ä¼˜å…ˆçº§ç­–ç•¥åˆ†é…CPUèµ„æºï¼Œè§¦å‘ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚&lt;/p>
&lt;blockquote>
&lt;p>&lt;em>æ··åˆå‹çº¿ç¨‹æ¨¡å‹&lt;/em>ï¼ˆHybrid Thread Modelï¼‰æ˜¯ä¸€ç§ç»“åˆç”¨æˆ·çº§çº¿ç¨‹ï¼ˆULTï¼‰å’Œå†…æ ¸çº§çº¿ç¨‹ï¼ˆKLTï¼‰ä¼˜åŠ¿çš„çº¿ç¨‹å®ç°æ–¹å¼ã€‚é€šè¿‡N:Mæ˜ å°„å®ç°ç”¨æˆ·çº¿ç¨‹ä¸å†…æ ¸çº¿ç¨‹çš„å…³è”ï¼Œå³å¤šä¸ªç”¨æˆ·çº¿ç¨‹ï¼ˆNï¼‰åŠ¨æ€ç»‘å®šåˆ°å°‘é‡å†…æ ¸çº¿ç¨‹ï¼ˆMï¼‰ã€‚&lt;/p>
&lt;/blockquote>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>ç”¨æˆ·æ€ä¸å†…æ ¸æ€çš„åˆ‡æ¢æœºåˆ¶&lt;/strong>&lt;br>
å½“çº¿ç¨‹æ‰§è¡Œç³»ç»Ÿè°ƒç”¨ã€å‘ç”Ÿå¼‚å¸¸æˆ–ä¸­æ–­æ—¶ï¼Œä¼šè§¦å‘ç”¨æˆ·æ€åˆ°å†…æ ¸æ€çš„åˆ‡æ¢ï¼š&lt;br>
â€¢ &lt;strong>ç³»ç»Ÿè°ƒç”¨æµç¨‹&lt;/strong>ï¼šç”¨æˆ·çº¿ç¨‹é€šè¿‡ä¸­æ–­ï¼ˆå¦‚Linuxçš„&lt;code>int 80h&lt;/code>ï¼‰è¿›å…¥å†…æ ¸æ€ï¼Œå†…æ ¸å®Œæˆæ“ä½œåæ¢å¤ç”¨æˆ·æ€æ‰§è¡Œï¼›
â€¢ &lt;strong>ä¸Šä¸‹æ–‡ä¿å­˜&lt;/strong>ï¼šåˆ‡æ¢æ—¶éœ€è¦ä¿å­˜ç”¨æˆ·æ ˆçš„å¯„å­˜å™¨çŠ¶æ€ï¼ˆå¦‚ç¨‹åºè®¡æ•°å™¨ã€æ ˆæŒ‡é’ˆï¼‰åˆ°å†…å­˜ï¼Œå¹¶åŠ è½½å†…æ ¸æ ˆä¿¡æ¯ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>æ€§èƒ½ä¼˜åŒ–ç­–ç•¥&lt;/strong>&lt;br>
å†…æ ¸é€šè¿‡ä»¥ä¸‹æ–¹å¼å‡å°‘åˆ‡æ¢å¼€é”€ï¼š&lt;br>
â€¢ &lt;strong>é¿å…é¢‘ç¹åˆ‡æ¢&lt;/strong>ï¼šé‡‡ç”¨æ— é”ç¼–ç¨‹ã€CASç®—æ³•ç­‰å‡å°‘çº¿ç¨‹ç«äº‰ï¼›
â€¢ &lt;strong>è½»é‡çº§è¿›ç¨‹ï¼ˆLWPï¼‰&lt;/strong>ï¼šé€šè¿‡çº¿ç¨‹æ± å¤ç”¨å†…æ ¸çº¿ç¨‹ï¼Œé™ä½åˆ›å»ºé”€æ¯æˆæœ¬ã€‚&lt;/p>
&lt;/li>
&lt;/ol>
&lt;hr>
&lt;h3 id="ä¸‰è¯­è¨€æ¡ˆä¾‹">ä¸‰ã€è¯­è¨€æ¡ˆä¾‹&lt;/h3>
&lt;p>Javaçº¿ç¨‹åœ¨JDK1.2ä¹‹åé‡‡ç”¨&lt;em>1:1æ¨¡å‹&lt;/em>ï¼Œæ¯ä¸ªJavaçº¿ç¨‹å¯¹åº”ä¸€ä¸ªå†…æ ¸çº¿ç¨‹ã€‚
æ”¯æŒå¤šæ ¸å¹¶è¡Œã€é¿å…å•çº¿ç¨‹é˜»å¡å½±å“æ•´ä½“è¿›ç¨‹ï¼›çº¿ç¨‹åˆ›å»ºå’Œåˆ‡æ¢éœ€è¦å†…æ ¸ä»‹å…¥ã€‚&lt;/p>
&lt;p>C++11åŠä¹‹åçš„æ ‡å‡†åº“ï¼ˆå¦‚&lt;code>&amp;lt;thread&amp;gt;&lt;/code>ï¼‰é€šè¿‡&lt;code>std::thread&lt;/code>ç›´æ¥è°ƒç”¨æ“ä½œç³»ç»Ÿçº¿ç¨‹ï¼ˆå¦‚Linuxçš„POSIXçº¿ç¨‹æˆ–Windowsçº¿ç¨‹ï¼‰ï¼Œé‡‡ç”¨&lt;em>1:1çº¿ç¨‹æ¨¡å‹&lt;/em>ã€‚&lt;/p>
&lt;p>Goæœªç›´æ¥ä½¿ç”¨æ“ä½œç³»ç»Ÿçº¿ç¨‹ï¼Œè€Œæ˜¯é€šè¿‡Goroutineå®ç°å¹¶å‘ã€‚Goroutineç”±Goè¿è¡Œæ—¶è°ƒåº¦ï¼Œé‡‡ç”¨M:Nçº¿ç¨‹æ¨¡å‹â€‹ï¼ˆå¤šä¸ªGoroutineæ˜ å°„åˆ°å°‘é‡å†…æ ¸çº¿ç¨‹ï¼‰ï¼Œç”±è¿è¡Œæ—¶åŠ¨æ€åˆ†é…CPUæ—¶é—´ç‰‡ã€‚&lt;/p></description></item><item><title>è¿›ç¨‹ã€çº¿ç¨‹ã€åç¨‹çš„èµ„æºæ¶ˆè€—ç®€è¿°</title><link>https://jekyulll.github.io/posts/linux-%E8%BF%9B%E7%A8%8B%E7%BA%BF%E7%A8%8B%E5%8D%8F%E7%A8%8B%E7%9A%84%E8%B5%84%E6%BA%90%E6%B6%88%E8%80%97%E7%AE%80%E8%BF%B0/</link><pubDate>Fri, 07 Mar 2025 20:05:47 +0800</pubDate><guid>https://jekyulll.github.io/posts/linux-%E8%BF%9B%E7%A8%8B%E7%BA%BF%E7%A8%8B%E5%8D%8F%E7%A8%8B%E7%9A%84%E8%B5%84%E6%BA%90%E6%B6%88%E8%80%97%E7%AE%80%E8%BF%B0/</guid><description>&lt;p>&lt;strong>ä¸€ã€çº¿ç¨‹åˆ‡æ¢ vs è¿›ç¨‹åˆ‡æ¢&lt;/strong>&lt;/p>
&lt;ol>
&lt;li>
&lt;p>&lt;strong>åœ°å€ç©ºé—´ä¸é¡µè¡¨&lt;/strong>&lt;br>
è¿›ç¨‹æ‹¥æœ‰ç‹¬ç«‹çš„è™šæ‹Ÿåœ°å€ç©ºé—´å’Œé¡µè¡¨ï¼Œåˆ‡æ¢è¿›ç¨‹æ—¶éœ€æ›´æ–°é¡µè¡¨å¹¶åˆ·æ–° &lt;strong>TLBï¼ˆåœ°å€è½¬æ¢ç¼“å­˜ï¼‰&lt;/strong>ï¼Œå¯¼è‡´å†…å­˜è®¿é—®é€Ÿåº¦ä¸‹é™ã€‚è€Œçº¿ç¨‹å…±äº«è¿›ç¨‹çš„åœ°å€ç©ºé—´å’Œé¡µè¡¨ï¼Œåˆ‡æ¢æ—¶æ— éœ€æ­¤æ“ä½œï¼ŒTLB ç¼“å­˜ä¿æŒæœ‰æ•ˆã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>ä¸Šä¸‹æ–‡ä¿å­˜çš„å†…å®¹&lt;/strong>&lt;br>
â€¢ &lt;strong>è¿›ç¨‹åˆ‡æ¢&lt;/strong>ï¼šéœ€ä¿å­˜å®Œæ•´çš„ä¸Šä¸‹æ–‡ï¼ŒåŒ…æ‹¬å¯„å­˜å™¨ã€ç¨‹åºè®¡æ•°å™¨ã€æ ˆæŒ‡é’ˆã€å†…å­˜æ˜ å°„ã€æ–‡ä»¶æè¿°ç¬¦ç­‰ã€‚&lt;br>
â€¢ &lt;strong>çº¿ç¨‹åˆ‡æ¢&lt;/strong>ï¼šä»…éœ€ä¿å­˜çº¿ç¨‹ç§æœ‰çš„å¯„å­˜å™¨ã€æ ˆå’Œç¨‹åºè®¡æ•°å™¨ï¼Œå…±äº«èµ„æºï¼ˆå¦‚ä»£ç æ®µã€æ–‡ä»¶ï¼‰æ— éœ€å¤„ç†ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>ç¼“å­˜åˆ©ç”¨ç‡&lt;/strong>&lt;br>
è¿›ç¨‹åˆ‡æ¢ä¼šå¯¼è‡´ CPU ç¼“å­˜ï¼ˆå¦‚ L1/L2/L3ï¼‰å¤±æ•ˆï¼Œéœ€é‡æ–°åŠ è½½æ•°æ®ï¼Œé™ä½æ€§èƒ½ã€‚çº¿ç¨‹åˆ‡æ¢æ—¶ï¼Œç¼“å­˜å› å…±äº«åœ°å€ç©ºé—´ä»æœ‰æ•ˆï¼Œå‡å°‘äº†æ•°æ®é‡è½½çš„å¼€é”€ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>èµ„æºåˆ†é…&lt;/strong>&lt;br>
è¿›ç¨‹æ˜¯èµ„æºåˆ†é…çš„åŸºæœ¬å•ä½ï¼ˆå¦‚å†…å­˜ã€æ–‡ä»¶ï¼‰ï¼Œåˆ‡æ¢æ—¶éœ€é‡æ–°åˆ†é…èµ„æºï¼›çº¿ç¨‹å…±äº«è¿›ç¨‹èµ„æºï¼Œåˆ‡æ¢ä»…æ¶‰åŠæ‰§è¡Œæµè°ƒåº¦ã€‚&lt;/p>
&lt;/li>
&lt;/ol>
&lt;p>&lt;strong>äºŒã€åç¨‹åˆ‡æ¢ vs çº¿ç¨‹åˆ‡æ¢&lt;/strong>&lt;/p>
&lt;p>åç¨‹çš„åˆ‡æ¢å¼€é”€æ›´å°ï¼ŒåŸå› åœ¨äºå…¶ &lt;strong>ç”¨æˆ·æ€è°ƒåº¦&lt;/strong> å’Œ &lt;strong>è½»é‡çº§è®¾è®¡&lt;/strong>ï¼š&lt;/p>
&lt;ol>
&lt;li>
&lt;p>&lt;strong>ç”¨æˆ·æ€è°ƒåº¦&lt;/strong>&lt;br>
åç¨‹åˆ‡æ¢å®Œå…¨ç”±ç”¨æˆ·æ€ä»£ç æ§åˆ¶ï¼Œæ— éœ€é™·å…¥å†…æ ¸æ€ï¼Œé¿å…äº† &lt;strong>ç”¨æˆ·æ€-å†…æ ¸æ€åˆ‡æ¢&lt;/strong> çš„å¼€é”€ã€‚è€Œçº¿ç¨‹åˆ‡æ¢éœ€æ“ä½œç³»ç»Ÿä»‹å…¥ï¼Œæ¶‰åŠæ¨¡å¼åˆ‡æ¢å’Œå†…æ ¸è°ƒåº¦ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>ä¸Šä¸‹æ–‡ä¿¡æ¯æ›´å°‘&lt;/strong>&lt;br>
åç¨‹åªéœ€ä¿å­˜å°‘é‡å¯„å­˜å™¨ï¼ˆå¦‚ PCã€SPï¼‰å’Œæ ˆæŒ‡é’ˆï¼Œä¸”æ ˆç©ºé—´é€šå¸¸ä»…éœ€ KB çº§åˆ«ï¼ˆçº¿ç¨‹æ ˆä¸º MB çº§åˆ«ï¼‰ã€‚ä¾‹å¦‚ï¼ŒGo åç¨‹çš„åˆå§‹æ ˆä»… 2KBï¼Œè€Œ Java çº¿ç¨‹é»˜è®¤ä¸º 1MBã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>éé˜»å¡ä¸åä½œå¼è°ƒåº¦&lt;/strong>&lt;br>
åç¨‹é€šè¿‡ä¸»åŠ¨è®©å‡ºï¼ˆå¦‚ &lt;code>yield&lt;/code> æˆ– &lt;code>await&lt;/code>ï¼‰å®ç°åä½œå¼è°ƒåº¦ï¼Œå‡å°‘æŠ¢å å¼è°ƒåº¦çš„ç«äº‰å’Œé”éœ€æ±‚ã€‚çº¿ç¨‹é€šå¸¸ä¾èµ–æ“ä½œç³»ç»Ÿçš„æŠ¢å å¼è°ƒåº¦ï¼Œå¯èƒ½å› é¢‘ç¹åˆ‡æ¢å¯¼è‡´æ€§èƒ½æŸè€—ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>å†…å­˜ä¸å¹¶å‘æ•ˆç‡&lt;/strong>&lt;br>
å•çº¿ç¨‹å¯è¿è¡Œæ•°ä¸‡åç¨‹ï¼ˆå¦‚ Go çš„ Goroutineï¼‰ï¼Œè€ŒåŒç­‰æ•°é‡çº¿ç¨‹ä¼šå› å†…å­˜å’Œè°ƒåº¦å¼€é”€è¿‡å¤§è€Œå´©æºƒã€‚åç¨‹çš„è½»é‡çº§ç‰¹æ€§å°¤å…¶é€‚åˆé«˜å¹¶å‘ I/O å¯†é›†å‹ä»»åŠ¡ã€‚&lt;/p>
&lt;/li>
&lt;/ol>
&lt;table>
 &lt;thead>
 &lt;tr>
 &lt;th>&lt;strong>ç»´åº¦&lt;/strong>&lt;/th>
 &lt;th>&lt;strong>è¿›ç¨‹åˆ‡æ¢&lt;/strong>&lt;/th>
 &lt;th>&lt;strong>çº¿ç¨‹åˆ‡æ¢&lt;/strong>&lt;/th>
 &lt;th>&lt;strong>åç¨‹åˆ‡æ¢&lt;/strong>&lt;/th>
 &lt;/tr>
 &lt;/thead>
 &lt;tbody>
 &lt;tr>
 &lt;td>&lt;strong>åœ°å€ç©ºé—´&lt;/strong>&lt;/td>
 &lt;td>åˆ‡æ¢ï¼ˆç‹¬ç«‹ï¼‰&lt;/td>
 &lt;td>ä¸åˆ‡æ¢ï¼ˆå…±äº«ï¼‰&lt;/td>
 &lt;td>ä¸åˆ‡æ¢ï¼ˆå…±äº«ï¼‰&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>&lt;strong>ä¸Šä¸‹æ–‡å¤§å°&lt;/strong>&lt;/td>
 &lt;td>å¤§ï¼ˆå«å…¨éƒ¨èµ„æºï¼‰&lt;/td>
 &lt;td>è¾ƒå°ï¼ˆä»…å¯„å­˜å™¨ï¼‰&lt;/td>
 &lt;td>æå°ï¼ˆä»…å…³é”®å¯„å­˜å™¨ï¼‰&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>&lt;strong>è°ƒåº¦æ¨¡å¼&lt;/strong>&lt;/td>
 &lt;td>å†…æ ¸æŠ¢å å¼&lt;/td>
 &lt;td>å†…æ ¸æŠ¢å å¼&lt;/td>
 &lt;td>ç”¨æˆ·åä½œå¼&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>&lt;strong>å†…å­˜å¼€é”€&lt;/strong>&lt;/td>
 &lt;td>é«˜ï¼ˆç‹¬ç«‹èµ„æºï¼‰&lt;/td>
 &lt;td>ä¸­ï¼ˆå…±äº«èµ„æºï¼‰&lt;/td>
 &lt;td>æä½ï¼ˆKB çº§æ ˆï¼‰&lt;/td>
 &lt;/tr>
 &lt;/tbody>
&lt;/table>
&lt;p>&lt;u>çº¿ç¨‹é€šè¿‡å…±äº«èµ„æºå‡å°‘å¼€é”€ï¼Œåç¨‹é€šè¿‡ç”¨æˆ·æ€è½»é‡çº§è°ƒåº¦è¿›ä¸€æ­¥ä¼˜åŒ–ï¼Œä¸¤è€…å‡é€šè¿‡å‡å°‘å†…æ ¸å‚ä¸å’Œèµ„æºå¤ç”¨æ¥æå‡æ€§èƒ½&lt;/u>&amp;gt;ã€‚&lt;/p></description></item><item><title>åœ¨è¿è¡Œçš„æ—¶å€™ï¼Œä¿®æ”¹å¹¶ä¸”è¦†ç›–è¯¥äºŒè¿›åˆ¶æ–‡ä»¶ä¼šå¦‚ä½•ï¼Ÿ</title><link>https://jekyulll.github.io/posts/linux-%E5%9C%A8%E8%BF%90%E8%A1%8C%E7%9A%84%E6%97%B6%E5%80%99%E4%BF%AE%E6%94%B9%E5%B9%B6%E4%B8%94%E8%A6%86%E7%9B%96%E8%AF%A5%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%96%87%E4%BB%B6%E4%BC%9A%E5%A6%82%E4%BD%95/</link><pubDate>Thu, 06 Mar 2025 18:05:47 +0800</pubDate><guid>https://jekyulll.github.io/posts/linux-%E5%9C%A8%E8%BF%90%E8%A1%8C%E7%9A%84%E6%97%B6%E5%80%99%E4%BF%AE%E6%94%B9%E5%B9%B6%E4%B8%94%E8%A6%86%E7%9B%96%E8%AF%A5%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%96%87%E4%BB%B6%E4%BC%9A%E5%A6%82%E4%BD%95/</guid><description>&lt;blockquote>
&lt;p>Linuxä¸Šæœ‰ä¸ªäºŒè¿›åˆ¶ç¨‹åºä¸€ç›´åœ¨è¿è¡Œï¼Œä¿®æ”¹ä»£ç åé‡æ–°ç¼–è¯‘æŠŠåŸæ¥çš„äºŒè¿›åˆ¶ç¨‹åºè¦†ç›–äº†ï¼Œä¼šæ€ä¹ˆæ ·ï¼Ÿ
è¯¥é—®é¢˜æ¥è‡ªä¸€é“å¤©ç¾åå°å¼€å‘é¢è¯•é¢˜ï¼š&lt;a href="https://zhuanlan.zhihu.com/p/677307438">å¤©ç¾ä¸€é¢ åå°å¼€å‘ï¼ˆå‡‰ï¼‰ - ç‰›å®¢é¢ç»çš„æ–‡ç«  - çŸ¥ä¹&lt;/a>ã€‚æ­¤å¤„å°è¯•è¿›è¡Œå›ç­”ã€‚&lt;/p>
&lt;/blockquote>
&lt;hr>
&lt;p>ç¬¬ä¸€æƒ³æ³•ä¸€èˆ¬æ˜¯ï¼šâ€œåŸç¨‹åºè¢«æ“ä½œç³»ç»ŸåŠ è½½è¿›å†…å­˜ï¼Œä¸ä¼šå—åˆ°å½±å“ã€‚â€&lt;br>
ç³»ç»Ÿä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„&lt;code>inode&lt;/code>æŒ‡å‘æ–°æ–‡ä»¶ï¼Œè€Œæ­£åœ¨è¿è¡Œçš„è¿›ç¨‹ä»ä¼šç»§ç»­ä½¿ç”¨æ—§çš„&lt;code>inode&lt;/code>å¯¹åº”çš„ä»£ç æ®µã€‚&lt;/p>
&lt;p>ä½†å®é™…ä¸Šæ‹“å±•åˆ°ä¸€ä¸ªé—®é¢˜ï¼šâ€œäºŒè¿›åˆ¶æ–‡ä»¶ä¼šå…¨éƒ¨åŠ è½½åˆ°å†…å­˜å—ï¼Ÿâ€&lt;/p>
&lt;p>ELFäºŒè¿›åˆ¶æ–‡ä»¶åœ¨åŠ è½½æ—¶ï¼Œæ“ä½œç³»ç»Ÿé€šå¸¸é‡‡ç”¨æŒ‰éœ€åˆ†é¡µçš„æœºåˆ¶ï¼Œåªå°†å½“å‰éœ€è¦çš„éƒ¨åˆ†åŠ è½½åˆ°ç‰©ç†å†…å­˜ï¼Œè€Œä¸æ˜¯ä¸€æ¬¡æ€§åŠ è½½æ•´ä¸ªæ–‡ä»¶ã€‚è™šæ‹Ÿå†…å­˜æ˜ å°„å…è®¸æ–‡ä»¶çš„éƒ¨åˆ†å†…å®¹é©»ç•™åœ¨ç£ç›˜ï¼Œç›´åˆ°è¢«è®¿é—®æ—¶æ‰è°ƒå…¥å†…å­˜ã€‚&lt;br>
åŒæ—¶ï¼ŒåŠ¨æ€é“¾æ¥åº“çš„å»¶è¿ŸåŠ è½½å’Œå†…å­˜æ˜ å°„æ–‡ä»¶æŠ€æœ¯ï¼ˆ&lt;code>mmap&lt;/code>ï¼‰ä¹Ÿå¸®åŠ©å‡å°‘å®é™…å†…å­˜å ç”¨ã€‚å› æ­¤ï¼Œå¦‚æœäºŒè¿›åˆ¶æ–‡ä»¶å¾ˆå¤§ï¼Œä¸ä¼šå…¨éƒ¨åŠ è½½åˆ°ç‰©ç†å†…å­˜ä¸­ï¼Œè€Œæ˜¯æŒ‰éœ€åŠ è½½ï¼Œåˆ©ç”¨è™šæ‹Ÿå†…å­˜ç®¡ç†æŠ€æœ¯ä¼˜åŒ–èµ„æºä½¿ç”¨ã€‚&lt;/p>
&lt;p>ä½†æ˜¯ï¼šçœŸçš„ä¼šåœ¨è¿è¡Œæ—¶åŠ è½½æ–°çš„å†…å®¹å—ï¼Ÿ&lt;/p>
&lt;p>ELFæ–‡ä»¶åœ¨å¯åŠ¨æ—¶å¦‚ä½•å†³å®šå“ªäº›å†…å®¹åŠ è½½åˆ°å†…å­˜ï¼Ÿä¸»è¦ä¾èµ–äºå…¶&lt;strong>ç¨‹åºå¤´è¡¨&lt;/strong>ï¼ˆProgram Header Tableï¼‰â€‹ä¸­å®šä¹‰çš„æ®µï¼ˆSegmentï¼‰ä¿¡æ¯ã€‚ç¨‹åºå¤´è¡¨ç”±å¤šä¸ª&lt;code>Elf64_Phdr&lt;/code>ç»“æ„ä½“ç»„æˆï¼Œæ¯ä¸ªç»“æ„ä½“æè¿°äº†ä¸€ä¸ªéœ€è¦åŠ è½½åˆ°å†…å­˜çš„æ®µï¼ˆå¦‚ä»£ç æ®µã€æ•°æ®æ®µã€åŠ¨æ€é“¾æ¥ä¿¡æ¯æ®µç­‰ï¼‰ã€‚è¿™äº›æ®µé€šå¸¸åŒ…å«å¤šä¸ª&lt;em>èŠ‚&lt;/em>ï¼ˆSectionï¼‰çš„é›†åˆã€‚&lt;/p>
&lt;p>è¦†ç›–åŸæ–‡ä»¶åï¼Œæ—§æ–‡ä»¶çš„ç£ç›˜ç©ºé—´ä¸ä¼šè¢«ç«‹å³é‡Šæ”¾ï¼Œéœ€ç­‰å¾…æ‰€æœ‰å…³è”è¿›ç¨‹ç»“æŸåæ‰èƒ½å›æ”¶ï¼ˆé€šè¿‡&lt;code>lsof&lt;/code>å¯æŸ¥çœ‹å ç”¨è¿›ç¨‹ï¼‰ã€‚&lt;/p>
&lt;p>&lt;strong>æ€»ç»“&lt;/strong>ï¼š&lt;br>
â€‹å·²è¿è¡Œçš„è¿›ç¨‹ä¸å—å½±å“ï¼šLinuxé€šè¿‡&lt;code>inode&lt;/code>æ ‡è¯†æ–‡ä»¶ï¼Œæ—§è¿›ç¨‹ç»§ç»­æ‰§è¡Œå†…å­˜ä¸­å·²åŠ è½½çš„æ—§ä»£ç ï¼Œä¸åŸç£ç›˜æ–‡ä»¶è§£è€¦ã€‚&lt;/p>
&lt;hr>
&lt;h3 id="1-elfæ–‡ä»¶çš„æŒ‰éœ€åŠ è½½æœºåˆ¶">1. &lt;strong>ELFæ–‡ä»¶çš„æŒ‰éœ€åŠ è½½æœºåˆ¶&lt;/strong>&lt;/h3>
&lt;p>ELFäºŒè¿›åˆ¶æ–‡ä»¶é€šè¿‡&lt;strong>ç¨‹åºå¤´è¡¨ï¼ˆProgram Header Tableï¼‰&lt;strong>ä¸­çš„&lt;code>PT_LOAD&lt;/code>æ®µæè¿°éœ€è¦åŠ è½½çš„ä»£ç å’Œæ•°æ®åŒºåŸŸã€‚å†…æ ¸çš„&lt;code>load_elf_binary()&lt;/code>å‡½æ•°ä¼šå°†è¿™äº›æ®µæ˜ å°„åˆ°è¿›ç¨‹çš„è™šæ‹Ÿåœ°å€ç©ºé—´ï¼Œä½†å®é™…ç‰©ç†å†…å­˜çš„å ç”¨æ˜¯&lt;/strong>æŒ‰éœ€åˆ†é¡µ&lt;/strong>çš„ï¼š
â€¢ ä»…å½“ç¨‹åºè®¿é—®æŸä¸ªé¡µï¼ˆé€šå¸¸4KBå¤§å°ï¼‰æ—¶ï¼Œæ‰ä¼šè§¦å‘ç¼ºé¡µå¼‚å¸¸ï¼Œå°†å¯¹åº”å†…å®¹ä»ç£ç›˜åŠ è½½åˆ°ç‰©ç†å†…å­˜ã€‚
â€¢ æœªä½¿ç”¨çš„ä»£ç æˆ–æ•°æ®ï¼ˆå¦‚æœªæ‰§è¡Œçš„å‡½æ•°ï¼‰å¯èƒ½æ°¸è¿œä¸ä¼šè¢«åŠ è½½åˆ°ç‰©ç†å†…å­˜ä¸­ã€‚&lt;/p>
&lt;h3 id="2-è™šæ‹Ÿå†…å­˜æ˜ å°„ä¸å†…å­˜ä¼˜åŒ–">2. &lt;strong>è™šæ‹Ÿå†…å­˜æ˜ å°„ä¸å†…å­˜ä¼˜åŒ–&lt;/strong>&lt;/h3>
&lt;p>â€¢ &lt;strong>è™šæ‹Ÿå†…å­˜ä¼˜åŠ¿&lt;/strong>ï¼šELFæ–‡ä»¶é€šè¿‡&lt;code>mmap()&lt;/code>ç³»ç»Ÿè°ƒç”¨æ˜ å°„åˆ°è™šæ‹Ÿåœ°å€ç©ºé—´ï¼Œæ­¤æ—¶æ–‡ä»¶å†…å®¹å¹¶ä¸ç›´æ¥å ç”¨ç‰©ç†å†…å­˜ï¼Œè€Œæ˜¯ç”±å†…æ ¸é€šè¿‡é¡µè¡¨ç®¡ç†ã€‚
â€¢ &lt;strong>å†™æ—¶å¤åˆ¶ï¼ˆCopy-on-Writeï¼‰&lt;/strong>ï¼šå¯¹äºåªè¯»æ®µï¼ˆå¦‚ä»£ç æ®µï¼‰ï¼Œå¤šä¸ªè¿›ç¨‹å¯ä»¥å…±äº«åŒä¸€ç‰©ç†å†…å­˜é¡µï¼›å¯¹äºå¯å†™æ®µï¼Œä¿®æ”¹æ—¶æ‰ä¼šå¤åˆ¶æ–°é¡µã€‚&lt;/p>
&lt;h3 id="3-åŠ¨æ€é“¾æ¥ä¸å»¶è¿ŸåŠ è½½">3. &lt;strong>åŠ¨æ€é“¾æ¥ä¸å»¶è¿ŸåŠ è½½&lt;/strong>&lt;/h3>
&lt;p>åŠ¨æ€é“¾æ¥åº“ï¼ˆå¦‚&lt;code>.so&lt;/code>æ–‡ä»¶ï¼‰åœ¨ç¨‹åºè¿è¡Œæ—¶é€šè¿‡&lt;code>ld-linux&lt;/code>åŠ¨æ€åŠ è½½å™¨æŒ‰éœ€è½½å…¥ã€‚ä¾‹å¦‚ï¼š
â€¢ é¦–æ¬¡è°ƒç”¨æŸä¸ªåº“å‡½æ•°æ—¶ï¼ŒåŠ¨æ€é“¾æ¥å™¨æ‰ä¼šåŠ è½½å¯¹åº”çš„ä»£ç æ®µåˆ°å†…å­˜ã€‚
â€¢ éƒ¨åˆ†åº“å¯èƒ½ä»…åœ¨ç‰¹å®šæ¡ä»¶ä¸‹è¢«ä½¿ç”¨ï¼Œä»è€Œå‡å°‘åˆå§‹å†…å­˜å ç”¨ã€‚&lt;/p>
&lt;h3 id="4-å¤§æ–‡ä»¶çš„å®é™…å†…å­˜å ç”¨">4. &lt;strong>å¤§æ–‡ä»¶çš„å®é™…å†…å­˜å ç”¨&lt;/strong>&lt;/h3>
&lt;p>â€¢ &lt;strong>ç‰©ç†å†…å­˜é™åˆ¶&lt;/strong>ï¼šè‹¥äºŒè¿›åˆ¶æ–‡ä»¶æå¤§ï¼ˆå¦‚8GBï¼‰ï¼Œä½†ç¨‹åºå®é™…æ‰§è¡Œçš„ä»£ç è·¯å¾„æœ‰é™ï¼Œç‰©ç†å†…å­˜å ç”¨å¯èƒ½è¿œå°äºæ–‡ä»¶å¤§å°ã€‚
â€¢ &lt;strong>äº¤æ¢ç©ºé—´ï¼ˆSwapï¼‰&lt;/strong>ï¼šå½“ç‰©ç†å†…å­˜ä¸è¶³æ—¶ï¼Œæ“ä½œç³»ç»Ÿä¼šå°†ä¸æ´»è·ƒçš„å†…å­˜é¡µäº¤æ¢åˆ°ç£ç›˜ï¼Œè…¾å‡ºç©ºé—´ä¾›å½“å‰è¿›ç¨‹ä½¿ç”¨ã€‚&lt;/p></description></item><item><title>çº¿ç¨‹æ± è°ƒåº¦ï¼šåŠ¨æ€ä¼˜å…ˆçº§è€åŒ–ï¼ˆAgingï¼‰+ åŒé˜Ÿåˆ—æ··åˆè½®è¯¢</title><link>https://jekyulll.github.io/posts/cpp-%E7%BA%BF%E7%A8%8B%E6%B1%A0%E8%B0%83%E5%BA%A6%E5%8A%A8%E6%80%81%E4%BC%98%E5%85%88%E7%BA%A7%E8%80%81%E5%8C%96aging+-%E5%8F%8C%E9%98%9F%E5%88%97%E6%B7%B7%E5%90%88%E8%BD%AE%E8%AF%A2/</link><pubDate>Tue, 25 Feb 2025 12:05:47 +0800</pubDate><guid>https://jekyulll.github.io/posts/cpp-%E7%BA%BF%E7%A8%8B%E6%B1%A0%E8%B0%83%E5%BA%A6%E5%8A%A8%E6%80%81%E4%BC%98%E5%85%88%E7%BA%A7%E8%80%81%E5%8C%96aging+-%E5%8F%8C%E9%98%9F%E5%88%97%E6%B7%B7%E5%90%88%E8%BD%AE%E8%AF%A2/</guid><description>&lt;p>C++ä¸­çº¿ç¨‹æ± ä¸€èˆ¬ä½¿ç”¨é˜Ÿåˆ—ï¼ˆ&lt;code>std::queue&lt;/code>ï¼‰é…åˆå¤–éƒ¨çš„&lt;code>std::condition_variable&lt;/code>ï¼Œæˆ–è€…æ‰‹åŠ¨æ„å»ºé˜»å¡é˜Ÿåˆ—ï¼ˆBlockQueueï¼‰æ¥è®¾è®¡ã€‚&lt;/p>
&lt;p>è€Œéœ€è¦ä½¿ç”¨ä»»åŠ¡ä¼˜å…ˆçº§çš„æ—¶å€™ï¼Œä¸€èˆ¬ä½¿ç”¨å¤§æ ¹å †/å°æ ¹å †çš„ä¼˜å…ˆçº§é˜Ÿåˆ—&lt;code>std::priority_queue&lt;/code>æ¥å®ç°ã€‚&lt;/p>
&lt;p>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œåœ¨ä»»åŠ¡ä¼˜å…ˆçº§æ¯”è¾ƒä¸å‡çš„æ—¶å€™ï¼Œæ€ä¹ˆé¿å…ä½ä¼˜å…ˆçº§ä»»åŠ¡çš„é•¿æ—¶é—´é¥¥é¥¿å‘¢ï¼Ÿ&lt;/p>
&lt;p>ä¸ºäº†å®ç°åŠ¨æ€å…¬å¹³è°ƒåº¦ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;strong>åŠ¨æ€ä¼˜å…ˆçº§è€åŒ–ï¼ˆAgingï¼‰ï¼šä¼˜å…ˆçº§åŠ¨æ€è°ƒæ•´&lt;/strong>ï¼šä»»åŠ¡åœ¨é˜Ÿåˆ—ä¸­ç­‰å¾…æ—¶é—´è¶Šé•¿ï¼Œå…¶æœ‰æ•ˆä¼˜å…ˆçº§é€æ¸å‡é«˜ã€‚&lt;/li>
&lt;li>&lt;strong>åŒé˜Ÿåˆ—æ··åˆè½®è¯¢&lt;/strong>ï¼šæ¯å¤„ç†ä¸€å®šæ•°é‡çš„é«˜ä¼˜å…ˆçº§ä»»åŠ¡åï¼Œå¼ºåˆ¶å¤„ç†ä½ä¼˜å…ˆçº§ä»»åŠ¡ã€‚&lt;/li>
&lt;/ul>
&lt;p>é¦–å…ˆæŠ½è±¡å‡ºä¸€ä¸ª&lt;code>Task&lt;/code>ç”¨äºè®°å½•ä»»åŠ¡çš„åˆå§‹ä¼˜å…ˆçº§å’Œå…¥é˜Ÿæ—¶é—´ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;chrono&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">struct&lt;/span> &lt;span style="color:#a6e22e">Task&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">int&lt;/span> base_priority; &lt;span style="color:#75715e">// åˆå§‹ä¼˜å…ˆçº§
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> std&lt;span style="color:#f92672">::&lt;/span>chrono&lt;span style="color:#f92672">::&lt;/span>steady_clock&lt;span style="color:#f92672">::&lt;/span>time_point enqueue_time;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> std&lt;span style="color:#f92672">::&lt;/span>function&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#66d9ef">void&lt;/span>()&lt;span style="color:#f92672">&amp;gt;&lt;/span> job;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// è®¡ç®—åŠ¨æ€ä¼˜å…ˆçº§ï¼ˆç­‰å¾…æ—¶é—´è¶Šé•¿ï¼Œä¼˜å…ˆçº§è¶Šé«˜ï¼‰
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">int&lt;/span> &lt;span style="color:#a6e22e">dynamic_priority&lt;/span>() &lt;span style="color:#66d9ef">const&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">auto&lt;/span> now &lt;span style="color:#f92672">=&lt;/span> std&lt;span style="color:#f92672">::&lt;/span>chrono&lt;span style="color:#f92672">::&lt;/span>steady_clock&lt;span style="color:#f92672">::&lt;/span>now();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">auto&lt;/span> wait_time &lt;span style="color:#f92672">=&lt;/span> std&lt;span style="color:#f92672">::&lt;/span>chrono&lt;span style="color:#f92672">::&lt;/span>duration_cast&lt;span style="color:#f92672">&amp;lt;&lt;/span>std&lt;span style="color:#f92672">::&lt;/span>chrono&lt;span style="color:#f92672">::&lt;/span>seconds&lt;span style="color:#f92672">&amp;gt;&lt;/span>(now &lt;span style="color:#f92672">-&lt;/span> enqueue_time).count();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> base_priority &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#66d9ef">static_cast&lt;/span>&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#66d9ef">int&lt;/span>&lt;span style="color:#f92672">&amp;gt;&lt;/span>(wait_time &lt;span style="color:#f92672">*&lt;/span> &lt;span style="color:#ae81ff">0.1&lt;/span>); &lt;span style="color:#75715e">// è€åŒ–ç³»æ•°å¯è°ƒ
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// é‡è½½æ¯”è¾ƒè¿ç®—ç¬¦ï¼ˆå®é™…æ¯”è¾ƒåŠ¨æ€ä¼˜å…ˆçº§ï¼‰
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">bool&lt;/span> &lt;span style="color:#66d9ef">operator&lt;/span>&lt;span style="color:#f92672">&amp;lt;&lt;/span>(&lt;span style="color:#66d9ef">const&lt;/span> Task&lt;span style="color:#f92672">&amp;amp;&lt;/span> other) &lt;span style="color:#66d9ef">const&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#66d9ef">this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>dynamic_priority() &lt;span style="color:#f92672">&amp;lt;&lt;/span> other.dynamic_priority(); 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ•´ä½“çš„çº¿ç¨‹æ± ç±»è®¾è®¡ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;queue&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;vector&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;thread&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;mutex&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;condition_variable&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">class&lt;/span> &lt;span style="color:#a6e22e">ThreadPool&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">public&lt;/span>&lt;span style="color:#f92672">:&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ThreadPool(size_t threads, size_t high_freq &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">5&lt;/span>) 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">:&lt;/span> high_processing_count(&lt;span style="color:#ae81ff">0&lt;/span>), high_freq_(high_freq) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">for&lt;/span>(size_t i &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>; i &lt;span style="color:#f92672">&amp;lt;&lt;/span> threads; &lt;span style="color:#f92672">++&lt;/span>i) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> workers.emplace_back([&lt;span style="color:#66d9ef">this&lt;/span>] { worker_loop(); });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">void&lt;/span> &lt;span style="color:#a6e22e">add_task&lt;/span>(&lt;span style="color:#66d9ef">int&lt;/span> priority, std&lt;span style="color:#f92672">::&lt;/span>function&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#66d9ef">void&lt;/span>()&lt;span style="color:#f92672">&amp;gt;&lt;/span> task) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> std&lt;span style="color:#f92672">::&lt;/span>unique_lock&lt;span style="color:#f92672">&amp;lt;&lt;/span>std&lt;span style="color:#f92672">::&lt;/span>mutex&lt;span style="color:#f92672">&amp;gt;&lt;/span> lock(queue_mutex);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> queue.emplace(Task{priority, std&lt;span style="color:#f92672">::&lt;/span>chrono&lt;span style="color:#f92672">::&lt;/span>steady_clock&lt;span style="color:#f92672">::&lt;/span>now(), task});
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> condition.notify_one();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">~&lt;/span>ThreadPool() { &lt;span style="color:#75715e">/* ... çœç•¥èµ„æºå›æ”¶ä»£ç  ... */&lt;/span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">private&lt;/span>&lt;span style="color:#f92672">:&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> std&lt;span style="color:#f92672">::&lt;/span>mutex queue_mutex;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> std&lt;span style="color:#f92672">::&lt;/span>condition_variable condition;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> std&lt;span style="color:#f92672">::&lt;/span>priority_queue&lt;span style="color:#f92672">&amp;lt;&lt;/span>Task&lt;span style="color:#f92672">&amp;gt;&lt;/span> queue; &lt;span style="color:#75715e">// ä¸»é˜Ÿåˆ—ï¼ˆåŠ¨æ€ä¼˜å…ˆçº§ï¼‰
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> std&lt;span style="color:#f92672">::&lt;/span>queue&lt;span style="color:#f92672">&amp;lt;&lt;/span>std&lt;span style="color:#f92672">::&lt;/span>function&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#66d9ef">void&lt;/span>()&lt;span style="color:#f92672">&amp;gt;&amp;gt;&lt;/span> low_priority_queue; &lt;span style="color:#75715e">// è¾…åŠ©é˜Ÿåˆ—
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> std&lt;span style="color:#f92672">::&lt;/span>vector&lt;span style="color:#f92672">&amp;lt;&lt;/span>std&lt;span style="color:#f92672">::&lt;/span>&lt;span style="color:#66d9ef">thread&lt;/span>&lt;span style="color:#f92672">&amp;gt;&lt;/span> workers;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// è½®è¯¢æ§åˆ¶
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> std&lt;span style="color:#f92672">::&lt;/span>atomic&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#66d9ef">int&lt;/span>&lt;span style="color:#f92672">&amp;gt;&lt;/span> high_processing_count;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#66d9ef">int&lt;/span> high_freq_;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">void&lt;/span> &lt;span style="color:#a6e22e">worker_loop&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">while&lt;/span>(true) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> std&lt;span style="color:#f92672">::&lt;/span>function&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#66d9ef">void&lt;/span>()&lt;span style="color:#f92672">&amp;gt;&lt;/span> task;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> std&lt;span style="color:#f92672">::&lt;/span>unique_lock&lt;span style="color:#f92672">&amp;lt;&lt;/span>std&lt;span style="color:#f92672">::&lt;/span>mutex&lt;span style="color:#f92672">&amp;gt;&lt;/span> lock(queue_mutex);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> condition.wait(lock, [&lt;span style="color:#66d9ef">this&lt;/span>] { &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#f92672">!&lt;/span>queue.empty(); });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// åŠ¨æ€è€åŒ–ï¼šæ¯å¤„ç†high_freq_ä¸ªé«˜ä¼˜ä»»åŠ¡åå¼ºåˆ¶å¤„ç†ä½ä¼˜
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">if&lt;/span>(&lt;span style="color:#f92672">++&lt;/span>high_processing_count &lt;span style="color:#f92672">%&lt;/span> high_freq_ &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span> &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">!&lt;/span>low_priority_queue.empty()) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> task &lt;span style="color:#f92672">=&lt;/span> low_priority_queue.front();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> low_priority_queue.pop();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> } &lt;span style="color:#66d9ef">else&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> task &lt;span style="color:#f92672">=&lt;/span> queue.top().job;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> queue.pop();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span>(task) task();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;hr>
&lt;p>&lt;strong>æ‹“å±•&lt;/strong>ï¼š&lt;/p></description></item><item><title>è®¡æ—¶å™¨ timer çš„è®¾è®¡</title><link>https://jekyulll.github.io/posts/cpp-%E8%AE%A1%E6%97%B6%E5%99%A8-timer-%E7%9A%84%E8%AE%BE%E8%AE%A1/</link><pubDate>Tue, 25 Feb 2025 12:05:47 +0800</pubDate><guid>https://jekyulll.github.io/posts/cpp-%E8%AE%A1%E6%97%B6%E5%99%A8-timer-%E7%9A%84%E8%AE%BE%E8%AE%A1/</guid><description>&lt;p>ä¸‰ç§ç»å…¸ç®—æ³•ï¼šå°é¡¶å †ã€çº¢é»‘æ ‘ã€æ—¶é—´è½®ã€‚&lt;br>
Linuxå†…æ ¸å¤šé‡‡ç”¨æ—¶é—´è½®å¤„ç†ä¸­æ–­å®šæ—¶å™¨ï¼Œè€ŒNginxä½¿ç”¨çº¢é»‘æ ‘ç®¡ç†å®šæ—¶äº‹ä»¶ã€‚&lt;/p>
&lt;ul>
&lt;li>&lt;em>Redis&lt;/em>:		&lt;code>usUntilEarliestTimer()&lt;/code>&lt;/li>
&lt;li>&lt;em>Nginx&lt;/em>: 		&lt;code>ngx_event_find_timer()&lt;/code> çº¢é»‘æ ‘&lt;/li>
&lt;li>&lt;em>Skynet&lt;/em>:&lt;/li>
&lt;li>&lt;em>Netty&lt;/em>: 		æ—¶é—´è½®&lt;/li>
&lt;li>&lt;em>Libevent&lt;/em>: 	æœ€å°å †&lt;/li>
&lt;li>&lt;em>Linux&lt;/em>: 		æ—¶é—´è½®&lt;/li>
&lt;/ul>
&lt;table>
 &lt;thead>
 &lt;tr>
 &lt;th>&lt;strong>ç®—æ³•&lt;/strong>&lt;/th>
 &lt;th>&lt;strong>æ’å…¥&lt;/strong>&lt;/th>
 &lt;th>&lt;strong>åˆ é™¤&lt;/strong>&lt;/th>
 &lt;th>&lt;strong>è§¦å‘æ•ˆç‡&lt;/strong>&lt;/th>
 &lt;th>&lt;strong>é€‚ç”¨åœºæ™¯&lt;/strong>&lt;/th>
 &lt;/tr>
 &lt;/thead>
 &lt;tbody>
 &lt;tr>
 &lt;td>å°é¡¶å †&lt;/td>
 &lt;td>&lt;code>O(log n)&lt;/code>&lt;/td>
 &lt;td>&lt;code>O(n)&lt;/code>&lt;/td>
 &lt;td>é«˜ï¼ˆä»…å¤„ç†å †é¡¶ï¼‰&lt;/td>
 &lt;td>ä»»åŠ¡é‡å¤§ï¼Œæ— éœ€é¢‘ç¹å–æ¶ˆéå †é¡¶ä»»åŠ¡&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>çº¢é»‘æ ‘&lt;/td>
 &lt;td>&lt;code>O(log n)&lt;/code>&lt;/td>
 &lt;td>&lt;code>O(log n)&lt;/code>&lt;/td>
 &lt;td>ä¸­ï¼ˆéå†æœ‰åºæ•°æ®ï¼‰&lt;/td>
 &lt;td>éœ€åŠ¨æ€å¢åˆ æ”¹ä»»åŠ¡&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>æ—¶é—´è½®&lt;/td>
 &lt;td>&lt;code>O(1)&lt;/code>&lt;/td>
 &lt;td>&lt;code>O(1)&lt;/code>&lt;/td>
 &lt;td>é«˜ï¼ˆæ‰¹é‡å¤„ç†æ§½ï¼‰&lt;/td>
 &lt;td>æµ·é‡çŸ­å‘¨æœŸä»»åŠ¡ï¼Œå›ºå®šæ—¶é—´ç²¾åº¦&lt;/td>
 &lt;/tr>
 &lt;/tbody>
&lt;/table>
&lt;hr>
&lt;h3 id="ä¸€å°é¡¶å †">ä¸€ã€å°é¡¶å †&lt;/h3>
&lt;ul>
&lt;li>â€‹ä¼˜å…ˆçº§é˜Ÿåˆ—ç»“æ„ï¼Œå †é¡¶å…ƒç´ å§‹ç»ˆæ˜¯æœ€å°çš„ï¼ˆå³æœ€è¿‘çš„åˆ°æœŸæ—¶é—´ï¼‰ã€‚&lt;/li>
&lt;li>â€‹æ’å…¥å’Œåˆ é™¤å †é¡¶æ“ä½œæ•ˆç‡é«˜ï¼Œä½†åˆ é™¤ä»»æ„èŠ‚ç‚¹æ•ˆç‡ä½ã€‚&lt;/li>
&lt;/ul>
&lt;h4 id="å¤æ‚åº¦">å¤æ‚åº¦&lt;/h4>
&lt;ul>
&lt;li>æ’å…¥ï¼š&lt;code>O(log n)&lt;/code>&lt;/li>
&lt;li>åˆ é™¤å †é¡¶ï¼š&lt;code>O(log n)&lt;/code>&lt;/li>
&lt;li>åˆ é™¤ä»»æ„èŠ‚ç‚¹ï¼š&lt;code>O(n)&lt;/code>&lt;/li>
&lt;/ul>
&lt;h4 id="é€‚ç”¨åœºæ™¯">é€‚ç”¨åœºæ™¯&lt;/h4>
&lt;ul>
&lt;li>å®šæ—¶ä»»åŠ¡æ•°é‡å¤§ï¼Œä¸”&lt;strong>é¢‘ç¹è§¦å‘æœ€è¿‘ä»»åŠ¡&lt;/strong>çš„åœºæ™¯ã€‚&lt;/li>
&lt;li>ä¸é€‚ç”¨äºéœ€è¦é¢‘ç¹å–æ¶ˆæˆ–ä¿®æ”¹éå †é¡¶ä»»åŠ¡çš„åœºæ™¯ã€‚&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;queue&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;vector&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;functional&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">struct&lt;/span> &lt;span style="color:#a6e22e">Timer&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">int64_t&lt;/span> expire; &lt;span style="color:#75715e">// åˆ°æœŸæ—¶é—´æˆ³
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> std&lt;span style="color:#f92672">::&lt;/span>function&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#66d9ef">void&lt;/span>()&lt;span style="color:#f92672">&amp;gt;&lt;/span> task;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// å°é¡¶å †æ¯”è¾ƒå‡½æ•°
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">struct&lt;/span> &lt;span style="color:#a6e22e">Compare&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">bool&lt;/span> &lt;span style="color:#a6e22e">operator&lt;/span>()(&lt;span style="color:#66d9ef">const&lt;/span> Timer&lt;span style="color:#f92672">&amp;amp;&lt;/span> a, &lt;span style="color:#66d9ef">const&lt;/span> Timer&lt;span style="color:#f92672">&amp;amp;&lt;/span> b) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> a.expire &lt;span style="color:#f92672">&amp;gt;&lt;/span> b.expire;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>std&lt;span style="color:#f92672">::&lt;/span>priority_queue&lt;span style="color:#f92672">&amp;lt;&lt;/span>Timer, std&lt;span style="color:#f92672">::&lt;/span>vector&lt;span style="color:#f92672">&amp;lt;&lt;/span>Timer&lt;span style="color:#f92672">&amp;gt;&lt;/span>, Compare&lt;span style="color:#f92672">&amp;gt;&lt;/span> min_heap;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// æ·»åŠ å®šæ—¶ä»»åŠ¡
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">void&lt;/span> &lt;span style="color:#a6e22e">add_timer&lt;/span>(&lt;span style="color:#66d9ef">int64_t&lt;/span> expire, std&lt;span style="color:#f92672">::&lt;/span>function&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#66d9ef">void&lt;/span>()&lt;span style="color:#f92672">&amp;gt;&lt;/span> task) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> min_heap.push({expire, task});
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// é©±åŠ¨é€»è¾‘ï¼ˆåœ¨äº‹ä»¶å¾ªç¯ä¸­è°ƒç”¨ï¼‰
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">void&lt;/span> &lt;span style="color:#a6e22e">check_expire&lt;/span>(&lt;span style="color:#66d9ef">int64_t&lt;/span> current_time) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">while&lt;/span> (&lt;span style="color:#f92672">!&lt;/span>min_heap.empty() &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> min_heap.top().expire &lt;span style="color:#f92672">&amp;lt;=&lt;/span> current_time) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">auto&lt;/span> task &lt;span style="color:#f92672">=&lt;/span> min_heap.top().task;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> min_heap.pop();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> task(); &lt;span style="color:#75715e">// æ‰§è¡Œä»»åŠ¡
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;hr>
&lt;h3 id="äºŒçº¢é»‘æ ‘">äºŒã€çº¢é»‘æ ‘&lt;/h3>
&lt;ul>
&lt;li>ä½¿ç”¨&lt;strong>æœ‰åºå®¹å™¨&lt;/strong>ï¼ˆå¦‚ &lt;code>std::multimap&lt;/code>ï¼‰ç®¡ç†å®šæ—¶ä»»åŠ¡ï¼Œé”®ä¸ºåˆ°æœŸæ—¶é—´ã€‚&lt;/li>
&lt;li>æ”¯æŒé«˜æ•ˆçš„&lt;strong>æ’å…¥&lt;/strong>ã€&lt;strong>åˆ é™¤&lt;/strong>å’Œ&lt;strong>æŸ¥æ‰¾&lt;/strong>æ“ä½œã€‚&lt;/li>
&lt;/ul>
&lt;h4 id="å¤æ‚åº¦-1">å¤æ‚åº¦&lt;/h4>
&lt;ul>
&lt;li>æ’å…¥ã€åˆ é™¤ã€æŸ¥æ‰¾ï¼š&lt;code>O(log n)&lt;/code>&lt;/li>
&lt;/ul>
&lt;h4 id="é€‚ç”¨åœºæ™¯-1">é€‚ç”¨åœºæ™¯&lt;/h4>
&lt;ul>
&lt;li>éœ€è¦é¢‘ç¹&lt;strong>å–æ¶ˆæˆ–ä¿®æ”¹å®šæ—¶ä»»åŠ¡&lt;/strong>çš„åœºæ™¯ã€‚&lt;/li>
&lt;li>é€‚åˆæ—¶é—´è·¨åº¦å¤§æˆ–éœ€è¦åŠ¨æ€è°ƒæ•´ä»»åŠ¡çš„åœºæ™¯ã€‚&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;map&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;functional&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">struct&lt;/span> &lt;span style="color:#a6e22e">Timer&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">int&lt;/span> id; &lt;span style="color:#75715e">// å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œç”¨äºå–æ¶ˆä»»åŠ¡
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> std&lt;span style="color:#f92672">::&lt;/span>function&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#66d9ef">void&lt;/span>()&lt;span style="color:#f92672">&amp;gt;&lt;/span> task;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>std&lt;span style="color:#f92672">::&lt;/span>multimap&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#66d9ef">int64_t&lt;/span>, Timer&lt;span style="color:#f92672">&amp;gt;&lt;/span> timer_map;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// æ·»åŠ å®šæ—¶ä»»åŠ¡
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">void&lt;/span> &lt;span style="color:#a6e22e">add_timer&lt;/span>(&lt;span style="color:#66d9ef">int&lt;/span> id, &lt;span style="color:#66d9ef">int64_t&lt;/span> expire, std&lt;span style="color:#f92672">::&lt;/span>function&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#66d9ef">void&lt;/span>()&lt;span style="color:#f92672">&amp;gt;&lt;/span> task) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> timer_map.insert({expire, {id, task}});
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// å–æ¶ˆå®šæ—¶ä»»åŠ¡ï¼ˆéœ€éå†ï¼‰
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">void&lt;/span> &lt;span style="color:#a6e22e">cancel_timer&lt;/span>(&lt;span style="color:#66d9ef">int&lt;/span> id) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">for&lt;/span> (&lt;span style="color:#66d9ef">auto&lt;/span> it &lt;span style="color:#f92672">=&lt;/span> timer_map.begin(); it &lt;span style="color:#f92672">!=&lt;/span> timer_map.end();) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (it&lt;span style="color:#f92672">-&amp;gt;&lt;/span>second.id &lt;span style="color:#f92672">==&lt;/span> id) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> it &lt;span style="color:#f92672">=&lt;/span> timer_map.erase(it);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> } &lt;span style="color:#66d9ef">else&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">++&lt;/span>it;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// é©±åŠ¨é€»è¾‘
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">void&lt;/span> &lt;span style="color:#a6e22e">check_expire&lt;/span>(&lt;span style="color:#66d9ef">int64_t&lt;/span> current_time) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">auto&lt;/span> it &lt;span style="color:#f92672">=&lt;/span> timer_map.begin();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">while&lt;/span> (it &lt;span style="color:#f92672">!=&lt;/span> timer_map.end() &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> it&lt;span style="color:#f92672">-&amp;gt;&lt;/span>first &lt;span style="color:#f92672">&amp;lt;=&lt;/span> current_time) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> it&lt;span style="color:#f92672">-&amp;gt;&lt;/span>second.task(); &lt;span style="color:#75715e">// æ‰§è¡Œä»»åŠ¡
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> it &lt;span style="color:#f92672">=&lt;/span> timer_map.erase(it);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;hr>
&lt;h3 id="ä¸‰æ—¶é—´è½®">ä¸‰ã€æ—¶é—´è½®&lt;/h3>
&lt;blockquote>
&lt;p>å…¶å®å¯ä»¥ç†è§£ä¸ºä¸€ç§å˜ç›¸çš„å“ˆå¸Œè¡¨ã€‚&lt;/p></description></item><item><title>å¦‚ä½•è®©å‡½æ•°å®‰å…¨è¿”å› std::string çš„ c_str</title><link>https://jekyulll.github.io/posts/cpp-%E8%AE%B0%E5%BD%95%E4%B8%80%E4%B8%AAc_str%E7%9A%84%E5%B0%8F%E5%9D%91/</link><pubDate>Sun, 23 Feb 2025 12:05:47 +0800</pubDate><guid>https://jekyulll.github.io/posts/cpp-%E8%AE%B0%E5%BD%95%E4%B8%80%E4%B8%AAc_str%E7%9A%84%E5%B0%8F%E5%9D%91/</guid><description>&lt;p>è§‚å¯Ÿä»¥ä¸‹è¿™æ®µæ˜æ˜¾é”™è¯¯çš„ä»£ç ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#66d9ef">char&lt;/span>&lt;span style="color:#f92672">*&lt;/span> &lt;span style="color:#a6e22e">get_c&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> std&lt;span style="color:#f92672">::&lt;/span>string s &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;hello world&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> s.c_str();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">int&lt;/span> &lt;span style="color:#a6e22e">main&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> printf(&lt;span style="color:#e6db74">&amp;#34;danger : %s&lt;/span>&lt;span style="color:#ae81ff">\n&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>, get_c());
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å­—ç¬¦ä¸²&lt;code>s&lt;/code>æ˜¯ä¸€ä¸ªå‡½æ•°å†…éƒ¨çš„ä¸´æ—¶å¯¹è±¡ï¼Œè¿”å›çš„&lt;code>const char*&lt;/code>å®é™…ä¸Šæ˜¯ä¸€ä¸ªæŒ‡é’ˆã€‚å‡½æ•°ç»“æŸå&lt;code>s&lt;/code>ä¼šææ„ï¼Œè€ŒæŒ‡é’ˆç†è®ºä¸Šä¼šå˜æˆæ‚¬ç©ºçš„ã€‚&lt;br>
å®é™…ä¸Šæ­£ç¡®æ‰“å°å‡ºäº†ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>danger : hello world
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>(å®é™…ä¸Šåªæ˜¯å› ä¸ºè¯¥æ®µå†…å­˜æ²¡æœ‰è¢«ç«‹åˆ»è¦†ç›–ï¼Œç†è®ºä¸Šæ˜¯ä¸å®‰å…¨çš„)&lt;/p>
&lt;p>æŸ¥çœ‹ä¸€ä¸‹æ±‡ç¼–ï¼š&lt;/p>
&lt;ol>
&lt;li>æ„é€  &lt;code>s&lt;/code>ï¼š&lt;/li>
&lt;/ol>
&lt;pre tabindex="0">&lt;code class="language-ass" data-lang="ass">leaq .LC0(%rip), %rcx ; åŠ è½½ &amp;#34;hello world&amp;#34; åœ°å€åˆ° %rcx
leaq -64(%rbp), %rax ; æ ˆä¸Šåˆ†é… s çš„å†…å­˜
call _ZNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEC1IS3_EEPKcRKS3_ ; è°ƒç”¨æ„é€ å‡½æ•°
&lt;/code>&lt;/pre>&lt;ul>
&lt;li>å­—ç¬¦ä¸² &lt;code>&amp;quot;hello world&amp;quot;&lt;/code> å­˜å‚¨åœ¨ &lt;code>.rodata&lt;/code> åªè¯»æ•°æ®æ®µï¼ˆ.LC0ï¼‰ã€‚&lt;/li>
&lt;li>s åœ¨æ ˆä¸Šæ„é€ ï¼Œé€šè¿‡ SSO ç›´æ¥å­˜å‚¨å­—ç¬¦ä¸²å†…å®¹ã€‚&lt;/li>
&lt;/ul>
&lt;ol start="2">
&lt;li>è·å– &lt;code>c_str()&lt;/code>ï¼š&lt;/li>
&lt;/ol>
&lt;pre tabindex="0">&lt;code class="language-ass" data-lang="ass">leaq -64(%rbp), %rax
call _ZNKSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEE5c_strEv@PLT
movq %rax, %rbx ; å°† c_str() æŒ‡é’ˆä¿å­˜åˆ° %rbx
&lt;/code>&lt;/pre>&lt;ol start="3">
&lt;li>ææ„ &lt;code>s&lt;/code>ï¼š&lt;/li>
&lt;/ol>
&lt;pre tabindex="0">&lt;code class="language-ass" data-lang="ass">leaq -64(%rbp), %rax
movq %rax, %rdi
call _ZNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEED1Ev@PLT ; è°ƒç”¨ææ„å‡½æ•°
&lt;/code>&lt;/pre>&lt;p>å¯¹äºè¾ƒçŸ­çš„å­—ç¬¦ä¸²ï¼ˆå¦‚ &amp;ldquo;&lt;code>hello world&lt;/code>&amp;quot;ï¼‰ï¼Œ&lt;code>std::string&lt;/code> å¯èƒ½ä½¿ç”¨ çŸ­å­—ç¬¦ä¸²ä¼˜åŒ–ï¼ˆSSOï¼‰ï¼Œå°†æ•°æ®ç›´æ¥å­˜å‚¨åœ¨å¯¹è±¡å†…éƒ¨çš„æ ˆç©ºé—´ä¸­ï¼Œè€Œéå †å†…å­˜ã€‚&lt;br>
åœ¨&lt;code>get_c&lt;/code>ä¸­ï¼Œ&lt;code>s&lt;/code>æ˜¯åœ¨æ ˆä¸Šåˆ†é…çš„ï¼Œå½“å‡½æ•°è¿”å›æ—¶ï¼Œæ ˆç©ºé—´å¯èƒ½æœªè¢«å…¶ä»–æ•°æ®è¦†ç›–ï¼Œæ‰€ä»¥å­—ç¬¦ä¸²å†…å®¹ä»ç„¶ä¿ç•™ã€‚æ­¤æ—¶è°ƒç”¨printfï¼Œå¯èƒ½ä»ç„¶èƒ½è¯»å–åˆ°åŸæ¥çš„æ•°æ®ï¼Œä½†è¿™åªæ˜¯å·§åˆï¼Œå±äºæœªå®šä¹‰è¡Œä¸ºçš„è¡¨ç°ã€‚&lt;/p></description></item><item><title>Linux å†…æ ¸ä¸­ C è¯­è¨€çš„é¢å‘å¯¹è±¡</title><link>https://jekyulll.github.io/posts/cpp-linux-%E5%86%85%E6%A0%B8%E4%B8%AD-c-%E8%AF%AD%E8%A8%80%E7%9A%84%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/</link><pubDate>Fri, 21 Feb 2025 12:05:47 +0800</pubDate><guid>https://jekyulll.github.io/posts/cpp-linux-%E5%86%85%E6%A0%B8%E4%B8%AD-c-%E8%AF%AD%E8%A8%80%E7%9A%84%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/</guid><description>&lt;p>Linux å†…æ ¸ä½¿ç”¨ &lt;strong>ç»“æ„ä½“&lt;/strong> å’Œ &lt;strong>å‡½æ•°æŒ‡é’ˆ&lt;/strong> çš„ç»„åˆæ¨¡æ‹Ÿé¢å‘å¯¹è±¡ï¼ˆOOï¼‰ç¼–ç¨‹èŒƒå¼ã€‚&lt;/p>
&lt;hr>
&lt;h3 id="1-ç»“æ„ä½“å°è£…æ•°æ®ä¸è¡Œä¸º">1. &lt;strong>ç»“æ„ä½“å°è£…æ•°æ®ä¸è¡Œä¸º&lt;/strong>&lt;/h3>
&lt;ul>
&lt;li>&lt;strong>æ•°æ®æŠ½è±¡&lt;/strong>ï¼šå°†ç›¸å…³å±æ€§å’ŒçŠ¶æ€å°è£…åœ¨ä¸€ä¸ª &lt;code>struct&lt;/code> ä¸­ã€‚&lt;/li>
&lt;li>&lt;strong>è¡Œä¸ºç»‘å®š&lt;/strong>ï¼šé€šè¿‡å‡½æ•°æŒ‡é’ˆå°†æ“ä½œç»‘å®šåˆ°ç»“æ„ä½“ä¸Šï¼Œå®ç°åŠ¨æ€è°ƒç”¨ã€‚&lt;/li>
&lt;/ul>
&lt;h4 id="ç¤ºä¾‹struct-file_operations">ç¤ºä¾‹ï¼š&lt;code>struct file_operations&lt;/code>&lt;/h4>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-c" data-lang="c">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// å®šä¹‰æ–‡ä»¶æ“ä½œçš„å‡½æ•°æŒ‡é’ˆè¡¨
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">struct&lt;/span> file_operations {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">ssize_t&lt;/span> (&lt;span style="color:#f92672">*&lt;/span>read)(&lt;span style="color:#66d9ef">struct&lt;/span> file &lt;span style="color:#f92672">*&lt;/span>, &lt;span style="color:#66d9ef">char&lt;/span> __user &lt;span style="color:#f92672">*&lt;/span>, &lt;span style="color:#66d9ef">size_t&lt;/span>, &lt;span style="color:#66d9ef">loff_t&lt;/span> &lt;span style="color:#f92672">*&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">ssize_t&lt;/span> (&lt;span style="color:#f92672">*&lt;/span>write)(&lt;span style="color:#66d9ef">struct&lt;/span> file &lt;span style="color:#f92672">*&lt;/span>, &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#66d9ef">char&lt;/span> __user &lt;span style="color:#f92672">*&lt;/span>, &lt;span style="color:#66d9ef">size_t&lt;/span>, &lt;span style="color:#66d9ef">loff_t&lt;/span> &lt;span style="color:#f92672">*&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// ... å…¶ä»–æ–¹æ³•
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>};
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// å…·ä½“æ–‡ä»¶ç³»ç»Ÿçš„å®ç°ï¼ˆå¦‚ ext4ï¼‰
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">static&lt;/span> &lt;span style="color:#66d9ef">struct&lt;/span> file_operations ext4_fops &lt;span style="color:#f92672">=&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> .read &lt;span style="color:#f92672">=&lt;/span> ext4_read,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> .write &lt;span style="color:#f92672">=&lt;/span> ext4_write,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// ... åˆå§‹åŒ–å…¶ä»–æ–¹æ³•
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>};
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// æ³¨å†Œåˆ° VFS å±‚æ—¶å…³è” fops
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">struct&lt;/span> inode &lt;span style="color:#f92672">*&lt;/span>inode &lt;span style="color:#f92672">=&lt;/span> ...;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>inode&lt;span style="color:#f92672">-&amp;gt;&lt;/span>i_fop &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#f92672">&amp;amp;&lt;/span>ext4_fops; &lt;span style="color:#75715e">// ç»‘å®šç‰¹å®šæ–¹æ³•é›†
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;hr>
&lt;h3 id="2-å¤šæ€ä¸ç»§æ‰¿">2. &lt;strong>å¤šæ€ä¸ç»§æ‰¿&lt;/strong>&lt;/h3>
&lt;ul>
&lt;li>&lt;strong>çˆ¶å­ç»“æ„ä½“&lt;/strong>ï¼šå­ç»“æ„ä½“åµŒå…¥çˆ¶ç»“æ„ä½“ä»¥ç»§æ‰¿æ¥å£ã€‚&lt;/li>
&lt;li>&lt;strong>ç±»å‹å®‰å…¨è½¬æ¢&lt;/strong>ï¼šé€šè¿‡ &lt;code>container_of&lt;/code> å®ä»çˆ¶æŒ‡é’ˆè·å–å­ç»“æ„ä½“ã€‚&lt;/li>
&lt;/ul>
&lt;h4 id="ç¤ºä¾‹struct-kobject-ä¸è‡ªå®šä¹‰å¯¹è±¡">ç¤ºä¾‹ï¼š&lt;code>struct kobject&lt;/code> ä¸è‡ªå®šä¹‰å¯¹è±¡&lt;/h4>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-c" data-lang="c">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// çˆ¶ç»“æ„ä½“ï¼ˆç±»ä¼¼æŠ½è±¡åŸºç±»ï¼‰
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">struct&lt;/span> kobject {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#66d9ef">char&lt;/span> &lt;span style="color:#f92672">*&lt;/span>name;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">struct&lt;/span> kset &lt;span style="color:#f92672">*&lt;/span>kset;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// å…¬å…±æ–¹æ³•
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">int&lt;/span> (&lt;span style="color:#f92672">*&lt;/span>release)(&lt;span style="color:#66d9ef">struct&lt;/span> kobject &lt;span style="color:#f92672">*&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// å­ç»“æ„ä½“ï¼ˆå…·ä½“å®ç°ï¼‰
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">struct&lt;/span> my_device {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">struct&lt;/span> kobject kobj; &lt;span style="color:#75715e">// ç»§æ‰¿ kobject
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">int&lt;/span> data;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// å®ç°çˆ¶ç±»çš„æ–¹æ³•
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">static&lt;/span> &lt;span style="color:#66d9ef">void&lt;/span> &lt;span style="color:#a6e22e">my_device_release&lt;/span>(&lt;span style="color:#66d9ef">struct&lt;/span> kobject &lt;span style="color:#f92672">*&lt;/span>kobj) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">struct&lt;/span> my_device &lt;span style="color:#f92672">*&lt;/span>dev &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">container_of&lt;/span>(kobj, &lt;span style="color:#66d9ef">struct&lt;/span> my_device, kobj);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// æ¸…ç†èµ„æº
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// åˆå§‹åŒ–æ—¶ç»‘å®šæ–¹æ³•
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">struct&lt;/span> my_device &lt;span style="color:#f92672">*&lt;/span>dev &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">kzalloc&lt;/span>(&lt;span style="color:#66d9ef">sizeof&lt;/span>(&lt;span style="color:#f92672">*&lt;/span>dev), GFP_KERNEL);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>dev&lt;span style="color:#f92672">-&amp;gt;&lt;/span>kobj.release &lt;span style="color:#f92672">=&lt;/span> my_device_release;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">kobject_init&lt;/span>(&lt;span style="color:#f92672">&amp;amp;&lt;/span>dev&lt;span style="color:#f92672">-&amp;gt;&lt;/span>kobj, &lt;span style="color:#f92672">&amp;amp;&lt;/span>my_device_ktype); &lt;span style="color:#75715e">// æ³¨å†Œç±»å‹
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;hr>
&lt;h3 id="3-ç»„åˆä¸æ¥å£åˆ†ç¦»">3. &lt;strong>ç»„åˆä¸æ¥å£åˆ†ç¦»&lt;/strong>&lt;/h3>
&lt;ul>
&lt;li>&lt;strong>æ¨¡å—åŒ–è®¾è®¡&lt;/strong>ï¼šé€šè¿‡ç»„åˆè€Œéç»§æ‰¿å¤ç”¨ä»£ç ã€‚&lt;/li>
&lt;li>&lt;strong>ç»Ÿä¸€æ¥å£&lt;/strong>ï¼šé¡¶å±‚ç»“æ„ä½“å®šä¹‰æ ‡å‡†æ¥å£ï¼Œåº•å±‚å®ç°å·®å¼‚åŒ–é€»è¾‘ã€‚&lt;/li>
&lt;/ul>
&lt;h4 id="ç¤ºä¾‹struct-block_device">ç¤ºä¾‹ï¼š&lt;code>struct block_device&lt;/code>&lt;/h4>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-c" data-lang="c">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// é€šç”¨å—è®¾å¤‡æ¥å£
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">struct&lt;/span> block_device {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">struct&lt;/span> gendisk &lt;span style="color:#f92672">*&lt;/span>disk;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// é€šç”¨æ–¹æ³•
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">int&lt;/span> (&lt;span style="color:#f92672">*&lt;/span>ioctl)(&lt;span style="color:#66d9ef">struct&lt;/span> block_device &lt;span style="color:#f92672">*&lt;/span>, &lt;span style="color:#66d9ef">unsigned&lt;/span> &lt;span style="color:#66d9ef">int&lt;/span>, &lt;span style="color:#66d9ef">unsigned&lt;/span> &lt;span style="color:#66d9ef">long&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// æ¡Œé¢ç¡¬ç›˜é©±åŠ¨å®ç°
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">struct&lt;/span> my_disk {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">struct&lt;/span> block_device bdev;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// ç§æœ‰æ•°æ®
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>};
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// å®ç°æ¥å£æ–¹æ³•
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">static&lt;/span> &lt;span style="color:#66d9ef">int&lt;/span> &lt;span style="color:#a6e22e">my_disk_ioctl&lt;/span>(&lt;span style="color:#66d9ef">struct&lt;/span> block_device &lt;span style="color:#f92672">*&lt;/span>bdev, &lt;span style="color:#66d9ef">unsigned&lt;/span> &lt;span style="color:#66d9ef">int&lt;/span> cmd, ...) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">struct&lt;/span> my_disk &lt;span style="color:#f92672">*&lt;/span>disk &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">container_of&lt;/span>(bdev, &lt;span style="color:#66d9ef">struct&lt;/span> my_disk, bdev);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">custom_ioctl&lt;/span>(disk, cmd);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;hr>
&lt;h3 id="4-è¿è¡Œæ—¶å¤šæ€">4. &lt;strong>è¿è¡Œæ—¶å¤šæ€&lt;/strong>&lt;/h3>
&lt;ul>
&lt;li>å‡½æ•°æŒ‡é’ˆä½œä¸ºè™šå‡½æ•°è¡¨ï¼ˆvtableï¼‰ï¼Œæ ¹æ®å¯¹è±¡ç±»å‹åŠ¨æ€è°ƒç”¨ä¸åŒå®ç°ã€‚&lt;/li>
&lt;/ul>
&lt;h4 id="ç¤ºä¾‹struct-net_device_ops">ç¤ºä¾‹ï¼š&lt;code>struct net_device_ops&lt;/code>&lt;/h4>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-c" data-lang="c">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// ç½‘ç»œè®¾å¤‡æ“ä½œæ¥å£
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">struct&lt;/span> net_device_ops {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">int&lt;/span> (&lt;span style="color:#f92672">*&lt;/span>ndo_open)(&lt;span style="color:#66d9ef">struct&lt;/span> net_device &lt;span style="color:#f92672">*&lt;/span>dev);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">int&lt;/span> (&lt;span style="color:#f92672">*&lt;/span>ndo_stop)(&lt;span style="color:#66d9ef">struct&lt;/span> net_device &lt;span style="color:#f92672">*&lt;/span>dev);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// ä»¥å¤ªç½‘é©±åŠ¨å®ç°
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">static&lt;/span> &lt;span style="color:#66d9ef">struct&lt;/span> net_device_ops eth_ops &lt;span style="color:#f92672">=&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> .ndo_open &lt;span style="color:#f92672">=&lt;/span> eth_open,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> .ndo_stop &lt;span style="color:#f92672">=&lt;/span> eth_stop,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// æ³¨å†Œç½‘ç»œè®¾å¤‡æ—¶ç»‘å®š ops
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">struct&lt;/span> net_device &lt;span style="color:#f92672">*&lt;/span>netdev &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">alloc_etherdev&lt;/span>(&lt;span style="color:#66d9ef">sizeof&lt;/span>(&lt;span style="color:#66d9ef">struct&lt;/span> priv_data));
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>netdev&lt;span style="color:#f92672">-&amp;gt;&lt;/span>netdev_ops &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#f92672">&amp;amp;&lt;/span>eth_ops;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;hr>
&lt;h3 id="5-å…³é”®æŠ€å·§">5. &lt;strong>å…³é”®æŠ€å·§&lt;/strong>&lt;/h3>
&lt;ul>
&lt;li>&lt;strong>è‡ªå¼•ç”¨ç»“æ„ä½“&lt;/strong>ï¼šé€šè¿‡æŒ‡é’ˆæˆå‘˜éšå¼å…³è”è‡ªèº«ã€‚&lt;/li>
&lt;li>&lt;strong>å®ç®€åŒ–ä»£ç &lt;/strong>ï¼šå¦‚ &lt;code>container_of&lt;/code> ç”¨äºåå‘æŸ¥æ‰¾ç»“æ„ä½“ã€‚&lt;/li>
&lt;li>&lt;strong>æ¨¡å—åŒ–åŠ è½½&lt;/strong>ï¼šé€šè¿‡ &lt;code>struct module&lt;/code> åŠ¨æ€æ³¨å†Œ/å¸è½½é©±åŠ¨ã€‚&lt;/li>
&lt;/ul>
&lt;hr>
&lt;h3 id="æ€»ç»“">æ€»ç»“&lt;/h3>
&lt;p>Linux å†…æ ¸é€šè¿‡ &lt;strong>ç»“æ„ä½“+å‡½æ•°æŒ‡é’ˆ&lt;/strong> å®ç°äº†ä»¥ä¸‹ OO ç‰¹æ€§ï¼š&lt;/p></description></item><item><title>web è®¿é—®è®¤è¯æœºåˆ¶</title><link>https://jekyulll.github.io/posts/web-web-%E8%AE%BF%E9%97%AE%E8%AE%A4%E8%AF%81%E6%9C%BA%E5%88%B6/</link><pubDate>Mon, 17 Feb 2025 21:05:47 +0800</pubDate><guid>https://jekyulll.github.io/posts/web-web-%E8%AE%BF%E9%97%AE%E8%AE%A4%E8%AF%81%E6%9C%BA%E5%88%B6/</guid><description>&lt;p>&lt;a href="https://time.geekbang.org/column/article/398410">25 | è®¤è¯æœºåˆ¶ï¼šåº”ç”¨ç¨‹åºå¦‚ä½•è¿›è¡Œè®¿é—®è®¤è¯ï¼Ÿ&lt;/a>è®²å¾—éå¸¸å¥½ï¼Œå›¾æ–‡ç»“åˆã€‚&lt;/p>
&lt;p>&lt;strong>IAM&lt;/strong>ï¼šèº«ä»½è¯†åˆ«ä¸è®¿é—®ç®¡ç†ï¼ˆIdentity and Access Managementï¼‰ã€‚&lt;/p>
&lt;ul>
&lt;li>&lt;strong>è®¤è¯&lt;/strong>ï¼ˆAuthenticationï¼Œè‹±æ–‡ç¼©å†™ &lt;strong>authn&lt;/strong>ï¼‰ï¼šç”¨æ¥éªŒè¯æŸä¸ªç”¨æˆ·æ˜¯å¦å…·æœ‰è®¿é—®ç³»ç»Ÿçš„æƒé™ã€‚å¦‚æœè®¤è¯é€šè¿‡ï¼Œè¯¥ç”¨æˆ·å°±å¯ä»¥è®¿é—®ç³»ç»Ÿï¼Œä»è€Œåˆ›å»ºã€ä¿®æ”¹ã€åˆ é™¤ã€æŸ¥è¯¢å¹³å°æ”¯æŒçš„èµ„æºã€‚&lt;/li>
&lt;li>&lt;strong>æˆæƒ&lt;/strong>ï¼ˆAuthorizationï¼Œè‹±æ–‡ç¼©å†™ &lt;strong>authz&lt;/strong>ï¼‰ï¼šç”¨æ¥éªŒè¯æŸä¸ªç”¨æˆ·æ˜¯å¦å…·æœ‰è®¿é—®æŸä¸ªèµ„æºçš„æƒé™ï¼Œå¦‚æœæˆæƒé€šè¿‡ï¼Œè¯¥ç”¨æˆ·å°±èƒ½å¯¹èµ„æºåšå¢åˆ æ”¹æŸ¥ç­‰æ“ä½œã€‚&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>è®¤è¯è¯æ˜äº†ä½ æ˜¯è°ï¼Œæˆæƒå†³å®šäº†ä½ èƒ½åšä»€ä¹ˆã€‚&lt;/p>
&lt;/blockquote>
&lt;p>&lt;u>å››ç§åŸºæœ¬çš„è®¤è¯æ–¹å¼ï¼š&lt;em>Basic&lt;/em>ã€&lt;em>Digest&lt;/em>ã€&lt;em>OAuth&lt;/em>ã€&lt;em>Bearer&lt;/em>&lt;/u>ã€‚&lt;/p>
&lt;ol>
&lt;li>
&lt;p>&lt;strong>Basic&lt;/strong> åŸºç¡€è®¤è¯&lt;br>
Basic è®¤è¯ï¼ˆåŸºç¡€è®¤è¯ï¼‰ï¼Œæ˜¯æœ€ç®€å•çš„è®¤è¯æ–¹å¼ã€‚å®ƒç®€å•åœ°å°†ç”¨æˆ·å:å¯†ç è¿›è¡Œ &lt;code>base64&lt;/code> ç¼–ç åï¼Œæ”¾åˆ° HTTP Authorization Header ä¸­ã€‚HTTP è¯·æ±‚åˆ°è¾¾åç«¯æœåŠ¡åï¼Œåç«¯æœåŠ¡ä¼šè§£æå‡º Authorization Header ä¸­çš„ &lt;code>base64&lt;/code> å­—ç¬¦ä¸²ï¼Œè§£ç è·å–ç”¨æˆ·åå’Œå¯†ç ï¼Œå¹¶å°†ç”¨æˆ·åå’Œå¯†ç è·Ÿæ•°æ®åº“ä¸­è®°å½•çš„å€¼è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœåŒ¹é…åˆ™è®¤è¯é€šè¿‡ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>Digest&lt;/strong> æ‘˜è¦è®¤è¯&lt;br>
Digest è®¤è¯ï¼ˆæ‘˜è¦è®¤è¯ï¼‰ä¸åŸºæœ¬è®¤è¯å…¼å®¹ï¼Œä½†ä¿®å¤äº†åŸºæœ¬è®¤è¯çš„ä¸¥é‡ç¼ºé™·ã€‚&lt;br>
Digest å…·æœ‰å¦‚ä¸‹ç‰¹ç‚¹ï¼š&lt;/p>
&lt;ul>
&lt;li>ç»ä¸ä¼šç”¨æ˜æ–‡æ–¹å¼åœ¨ç½‘ç»œä¸Šå‘é€å¯†ç ã€‚&lt;/li>
&lt;li>å¯ä»¥æœ‰æ•ˆé˜²æ­¢æ¶æ„ç”¨æˆ·è¿›è¡Œé‡æ”¾æ”»å‡»ã€‚&lt;/li>
&lt;li>å¯ä»¥æœ‰é€‰æ‹©åœ°é˜²æ­¢å¯¹æŠ¥æ–‡å†…å®¹çš„ç¯¡æ”¹ã€‚
å››æ­¥ï¼š&lt;/li>
&lt;/ul>
&lt;ol>
&lt;li>å®¢æˆ·ç«¯è¯·æ±‚æœåŠ¡ç«¯çš„èµ„æºã€‚&lt;/li>
&lt;li>åœ¨å®¢æˆ·ç«¯èƒ½å¤Ÿè¯æ˜å®ƒçŸ¥é“å¯†ç ä»è€Œç¡®è®¤å…¶èº«ä»½ä¹‹å‰ï¼ŒæœåŠ¡ç«¯è®¤è¯å¤±è´¥ï¼Œè¿”å›&lt;code>401 Unauthorized&lt;/code>ï¼Œå¹¶è¿”å›&lt;code>WWW-Authenticate&lt;/code>å¤´ï¼Œé‡Œé¢åŒ…å«è®¤è¯éœ€è¦çš„ä¿¡æ¯ã€‚&lt;/li>
&lt;li>å®¢æˆ·ç«¯æ ¹æ®&lt;code>WWW-Authenticate&lt;/code>å¤´ä¸­çš„ä¿¡æ¯ï¼Œé€‰æ‹©åŠ å¯†ç®—æ³•ï¼Œå¹¶ä½¿ç”¨å¯†ç éšæœºæ•° &lt;code>nonce&lt;/code>(é˜²æ­¢&lt;em>é‡æ”¾æ”»å‡»&lt;/em>)ï¼Œè®¡ç®—å‡ºå¯†ç æ‘˜è¦ &lt;code>response&lt;/code>ï¼Œå¹¶å†æ¬¡è¯·æ±‚æœåŠ¡ç«¯ã€‚&lt;/li>
&lt;li>æœåŠ¡å™¨å°†å®¢æˆ·ç«¯æä¾›çš„å¯†ç æ‘˜è¦ä¸æœåŠ¡å™¨å†…éƒ¨è®¡ç®—å‡ºçš„æ‘˜è¦è¿›è¡Œå¯¹æ¯”ã€‚å¦‚æœåŒ¹é…ï¼Œå°±è¯´æ˜å®¢æˆ·ç«¯çŸ¥é“å¯†ç ï¼Œè®¤è¯é€šè¿‡ï¼Œå¹¶è¿”å›ä¸€äº›ä¸æˆæƒä¼šè¯ç›¸å…³çš„é™„åŠ ä¿¡æ¯ï¼Œæ”¾åœ¨ &lt;code>Authorization-Info&lt;/code> ä¸­ã€‚&lt;/li>
&lt;/ol>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>OAuth&lt;/strong> å¼€æ”¾æˆæƒ&lt;br>
OAuthï¼ˆå¼€æ”¾æˆæƒï¼‰æ˜¯ä¸€ä¸ªå¼€æ”¾çš„æˆæƒæ ‡å‡†ï¼Œå…è®¸ç”¨æˆ·è®©ç¬¬ä¸‰æ–¹åº”ç”¨è®¿é—®è¯¥ç”¨æˆ·åœ¨æŸä¸€ Web æœåŠ¡ä¸Šå­˜å‚¨çš„ç§å¯†èµ„æºï¼ˆä¾‹å¦‚ç…§ç‰‡ã€è§†é¢‘ã€éŸ³é¢‘ç­‰ï¼‰ï¼Œè€Œæ— éœ€å°†ç”¨æˆ·åå’Œå¯†ç æä¾›ç»™ç¬¬ä¸‰æ–¹åº”ç”¨ã€‚&lt;/p>
&lt;/li>
&lt;/ol>
&lt;blockquote>
&lt;p>OAuth2.0 ä¸€å…±åˆ†ä¸ºå››ç§æˆæƒæ–¹å¼ï¼Œåˆ†åˆ«ä¸º&lt;em>å¯†ç å¼&lt;/em>ã€&lt;em>éšè—å¼&lt;/em>ã€&lt;em>å‡­å€Ÿå¼&lt;/em>å’Œ&lt;em>æˆæƒç &lt;/em>æ¨¡å¼ã€‚&lt;/p>
&lt;/blockquote>
&lt;ol start="4">
&lt;li>&lt;strong>Bearer&lt;/strong> ä»¤ç‰Œè®¤è¯&lt;br>
Bearer è®¤è¯æ˜¯ä¸€ç§ HTTP èº«ä»½éªŒè¯æ–¹æ³•ã€‚Bearer è®¤è¯çš„æ ¸å¿ƒæ˜¯ &lt;code>bearer token&lt;/code>ã€‚&lt;code>bearer token&lt;/code> æ˜¯ä¸€ä¸ªåŠ å¯†å­—ç¬¦ä¸²ï¼Œé€šå¸¸ç”±æœåŠ¡ç«¯æ ¹æ®å¯†é’¥ç”Ÿæˆã€‚å®¢æˆ·ç«¯åœ¨è¯·æ±‚æœåŠ¡ç«¯æ—¶ï¼Œå¿…é¡»åœ¨è¯·æ±‚å¤´ä¸­åŒ…å«&lt;code>Authorization: Bearer&lt;/code> ã€‚æœåŠ¡ç«¯æ”¶åˆ°è¯·æ±‚åï¼Œè§£æå‡º&lt;code>&amp;lt;token&amp;gt;&lt;/code>ï¼Œå¹¶æ ¡éªŒ&lt;code>&amp;lt;token&amp;gt;&lt;/code>çš„åˆæ³•æ€§ï¼Œå¦‚æœæ ¡éªŒé€šè¿‡ï¼Œåˆ™è®¤è¯é€šè¿‡ã€‚&lt;/li>
&lt;/ol>
&lt;blockquote>
&lt;p>è·ŸåŸºæœ¬è®¤è¯ä¸€æ ·ï¼ŒBearer è®¤è¯éœ€è¦é…åˆ HTTPS ä¸€èµ·ä½¿ç”¨ï¼Œæ¥ä¿è¯è®¤è¯å®‰å…¨æ€§ã€‚&lt;/p></description></item><item><title>æ‰«æçº¿ç®—æ³•è®¡ç®—åŒºé—´é‡å </title><link>https://jekyulll.github.io/posts/alg-%E6%89%AB%E6%8F%8F%E7%BA%BF%E7%AE%97%E6%B3%95%E8%AE%A1%E7%AE%97%E5%8C%BA%E9%97%B4%E9%87%8D%E5%8F%A0/</link><pubDate>Sat, 15 Feb 2025 20:05:47 +0800</pubDate><guid>https://jekyulll.github.io/posts/alg-%E6%89%AB%E6%8F%8F%E7%BA%BF%E7%AE%97%E6%B3%95%E8%AE%A1%E7%AE%97%E5%8C%BA%E9%97%B4%E9%87%8D%E5%8F%A0/</guid><description>&lt;p>é¢˜ç›®æ¥æºï¼š&lt;a href="https://www.marscode.cn/practice/jn1075jrp7j47d?problem_id=7424418560930611244">Marscode&lt;/a>ã€‚&lt;/p>
&lt;blockquote>
&lt;p>å°Cå’Œå°Uæœ‰ä¸€ä¸ªä»&lt;code>0&lt;/code>å¼€å§‹çš„æ•°ç»„&lt;code>nums&lt;/code>ï¼Œä»¥åŠä¸€ä¸ªéè´Ÿæ•´æ•°&lt;code>k&lt;/code>ã€‚æ¯æ¬¡æ“ä½œä¸­ï¼Œå°Cå¯ä»¥é€‰æ‹©ä¸€ä¸ªå°šæœªé€‰æ‹©çš„ä¸‹æ ‡&lt;code>i&lt;/code>ï¼ˆèŒƒå›´åœ¨ &lt;code>[0, nums.length - 1]&lt;/code>ï¼‰ï¼Œç„¶åå°†&lt;code>nums[i]&lt;/code>æ›¿æ¢ä¸º&lt;code>[nums[i] - k, nums[i] + k]&lt;/code>ä¹‹é—´çš„ä»»æ„æ•´æ•°ï¼ˆåŒ…å«è¾¹ç•Œï¼‰ã€‚&lt;br>
åœ¨åº”ç”¨ä»»æ„æ¬¡æ•°çš„æ“ä½œåï¼Œè¿”å›æ•°ç»„&lt;code>nums&lt;/code>å¯èƒ½è¾¾åˆ°çš„æœ€å¤§åˆ†æ•°ã€‚æ•°ç»„çš„åˆ†æ•°è¢«å®šä¹‰ä¸ºæ•°ç»„ä¸­æœ€å¤šé‡å¤çš„å…ƒç´ ä¸ªæ•°ã€‚æ³¨æ„ï¼Œæ¯ä¸ªä¸‹æ ‡åªèƒ½è¢«æ“ä½œä¸€æ¬¡ã€‚&lt;/p>
&lt;/blockquote>
&lt;hr>
&lt;h3 id="æš´åŠ›è§£è¶…æ—¶-onk">æš´åŠ›è§£ï¼ˆè¶…æ—¶ï¼‰ &lt;code>O(nÂ²k)&lt;/code>&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">int&lt;/span> &lt;span style="color:#a6e22e">solution&lt;/span>(vector&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#66d9ef">int&lt;/span>&lt;span style="color:#f92672">&amp;gt;&amp;amp;&lt;/span> nums, &lt;span style="color:#66d9ef">int&lt;/span> k) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">int&lt;/span> n &lt;span style="color:#f92672">=&lt;/span> nums.size();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">int&lt;/span> maxCount &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>; &lt;span style="color:#75715e">// è‡³å°‘æœ‰ä¸€ä¸ªæ•°
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// éå†æ¯ä¸ªæ•°ä½œä¸ºå¯èƒ½çš„ç›®æ ‡å€¼
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">for&lt;/span> (&lt;span style="color:#66d9ef">int&lt;/span> i &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>; i &lt;span style="color:#f92672">&amp;lt;&lt;/span> n; i&lt;span style="color:#f92672">++&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// ä»¥nums[i]ä¸ºä¸­å¿ƒï¼Œè€ƒè™‘èŒƒå›´[nums[i]-k, nums[i]+k]å†…çš„æ‰€æœ‰å¯èƒ½å€¼
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">for&lt;/span> (&lt;span style="color:#66d9ef">int&lt;/span> target &lt;span style="color:#f92672">=&lt;/span> nums[i]&lt;span style="color:#f92672">-&lt;/span>k; target &lt;span style="color:#f92672">&amp;lt;=&lt;/span> nums[i]&lt;span style="color:#f92672">+&lt;/span>k; target&lt;span style="color:#f92672">++&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">int&lt;/span> count &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// æ£€æŸ¥æ¯ä¸ªä½ç½®çš„æ•°æ˜¯å¦èƒ½å˜æˆtarget
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">for&lt;/span> (&lt;span style="color:#66d9ef">int&lt;/span> j &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>; j &lt;span style="color:#f92672">&amp;lt;&lt;/span> n; j&lt;span style="color:#f92672">++&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (abs(nums[j] &lt;span style="color:#f92672">-&lt;/span> target) &lt;span style="color:#f92672">&amp;lt;=&lt;/span> k) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> count&lt;span style="color:#f92672">++&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> maxCount &lt;span style="color:#f92672">=&lt;/span> max(maxCount, count);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> maxCount;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="ä¼˜åŒ–æš´åŠ›è§£-on">ä¼˜åŒ–æš´åŠ›è§£ &lt;code>O(nÂ²)&lt;/code>&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">int&lt;/span> &lt;span style="color:#a6e22e">solution&lt;/span>(vector&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#66d9ef">int&lt;/span>&lt;span style="color:#f92672">&amp;gt;&amp;amp;&lt;/span> nums, &lt;span style="color:#66d9ef">int&lt;/span> k) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">int&lt;/span> n &lt;span style="color:#f92672">=&lt;/span> nums.size();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">int&lt;/span> maxCount &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// åªéœ€è¦è€ƒè™‘å°†æŸäº›æ•°å˜æˆæ•°ç»„ä¸­å·²æœ‰çš„æ•°
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">for&lt;/span> (&lt;span style="color:#66d9ef">int&lt;/span> i &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>; i &lt;span style="color:#f92672">&amp;lt;&lt;/span> n; i&lt;span style="color:#f92672">++&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">int&lt;/span> target &lt;span style="color:#f92672">=&lt;/span> nums[i]; &lt;span style="color:#75715e">// ä»¥å½“å‰æ•°ä½œä¸ºç›®æ ‡å€¼
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">int&lt;/span> count &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">for&lt;/span> (&lt;span style="color:#66d9ef">int&lt;/span> j &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>; j &lt;span style="color:#f92672">&amp;lt;&lt;/span> n; j&lt;span style="color:#f92672">++&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (abs(nums[j] &lt;span style="color:#f92672">-&lt;/span> target) &lt;span style="color:#f92672">&amp;lt;=&lt;/span> k) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> count&lt;span style="color:#f92672">++&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> maxCount &lt;span style="color:#f92672">=&lt;/span> max(maxCount, count);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> maxCount;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="æ‰«æçº¿ç®—æ³•-onlogn">æ‰«æçº¿ç®—æ³• &lt;code>O(nlogn)&lt;/code>&lt;/h3>
&lt;p>åƒæ˜¯åœ¨æ•°æŸä¸ªæ—¶åˆ»æœ‰å¤šå°‘ä¸ªåŒºé—´é‡å ã€‚ä¸€æ¡æ°´å¹³çº¿ä»å·¦å‘å³æ‰«è¿‡ï¼Œæ¯ä¸ªèµ·ç‚¹è®©é‡å æ•°+1ï¼Œæ¯ä¸ªç»ˆç‚¹è®©é‡å æ•°-1ï¼Œè¿‡ç¨‹ä¸­çš„æœ€å¤§é‡å æ•°å°±æ˜¯ç­”æ¡ˆã€‚&lt;/p></description></item><item><title>C++ åŒä¸€è¿›ç¨‹çš„çº¿ç¨‹ä¹‹é—´å…±äº«å“ªäº›èµ„æºï¼Ÿ</title><link>https://jekyulll.github.io/posts/cpp-c++-%E5%90%8C%E4%B8%80%E8%BF%9B%E7%A8%8B%E7%9A%84%E7%BA%BF%E7%A8%8B%E4%B9%8B%E9%97%B4%E5%85%B1%E4%BA%AB%E5%93%AA%E4%BA%9B%E8%B5%84%E6%BA%90/</link><pubDate>Sat, 08 Feb 2025 18:05:47 +0800</pubDate><guid>https://jekyulll.github.io/posts/cpp-c++-%E5%90%8C%E4%B8%80%E8%BF%9B%E7%A8%8B%E7%9A%84%E7%BA%BF%E7%A8%8B%E4%B9%8B%E9%97%B4%E5%85%B1%E4%BA%AB%E5%93%AA%E4%BA%9B%E8%B5%84%E6%BA%90/</guid><description>&lt;p>åŒä¸€è¿›ç¨‹å†…çš„çº¿ç¨‹å…±äº«çš„èµ„æºï¼š&lt;/p>
&lt;ul>
&lt;li>
&lt;p>&lt;strong>ä»£ç æ®µ&lt;/strong>ï¼šå­˜æ”¾ç¨‹åºçš„å¯æ‰§è¡ŒæŒ‡ä»¤ï¼Œæ‰€æœ‰çº¿ç¨‹å…±äº«ç›¸åŒçš„ä»£ç æ®µï¼Œå› æ­¤ä»»ä½•çº¿ç¨‹éƒ½å¯ä»¥æ‰§è¡Œç¨‹åºä¸­çš„å‡½æ•°ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>æ•°æ®æ®µ&lt;/strong>ï¼šåŒ…å«å…¨å±€å˜é‡å’Œé™æ€å˜é‡ï¼Œè¿™äº›å˜é‡åœ¨ç¨‹åºè¿è¡ŒæœŸé—´åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œæ‰€æœ‰çº¿ç¨‹éƒ½å¯ä»¥è®¿é—®å’Œä¿®æ”¹å®ƒä»¬ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>å †&lt;/strong>ï¼šç”¨äºåŠ¨æ€å†…å­˜åˆ†é…ï¼Œçº¿ç¨‹å¯ä»¥åœ¨å †ä¸Šåˆ†é…å’Œé‡Šæ”¾å†…å­˜ï¼Œå› æ­¤å †ä¸Šçš„æ•°æ®å¯¹æ‰€æœ‰çº¿ç¨‹å¯è§ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>æ‰“å¼€çš„æ–‡ä»¶&lt;/strong>ï¼šå¦‚æœç¨‹åºåœ¨è¿è¡Œè¿‡ç¨‹ä¸­æ‰“å¼€äº†æ–‡ä»¶ï¼Œæ–‡ä»¶æè¿°ç¬¦ç­‰ä¿¡æ¯åœ¨è¿›ç¨‹åœ°å€ç©ºé—´ä¸­ä¿å­˜ï¼Œæ‰€æœ‰çº¿ç¨‹éƒ½å¯ä»¥è®¿é—®è¿™äº›æ‰“å¼€çš„æ–‡ä»¶ã€‚&lt;/p>
&lt;/li>
&lt;/ul>
&lt;p>æ¯ä¸ªçº¿ç¨‹çš„ç§æœ‰èµ„æºï¼š&lt;/p>
&lt;ul>
&lt;li>
&lt;p>&lt;strong>æ ˆ&lt;/strong>ï¼šæ¯ä¸ªçº¿ç¨‹éƒ½æœ‰è‡ªå·±çš„æ ˆç©ºé—´ï¼Œç”¨äºå­˜å‚¨å‡½æ•°çš„å±€éƒ¨å˜é‡ã€è¿”å›åœ°å€ç­‰ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>å¯„å­˜å™¨&lt;/strong>ï¼šçº¿ç¨‹åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ä½¿ç”¨çš„å¯„å­˜å™¨é›†æ˜¯ç‹¬ç«‹çš„ï¼ŒåŒ…æ‹¬ç¨‹åºè®¡æ•°å™¨ï¼ˆPCï¼‰ç­‰ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>çº¿ç¨‹å±€éƒ¨å­˜å‚¨ï¼ˆThread Local Storageï¼‰&lt;/strong>ï¼šå­˜æ”¾çº¿ç¨‹ç§æœ‰çš„å…¨å±€å˜é‡ï¼Œå³ä½¿å˜é‡åç›¸åŒï¼Œä¸åŒçº¿ç¨‹è®¿é—®çš„ä¹Ÿæ˜¯å„è‡ªç‹¬ç«‹çš„å‰¯æœ¬ã€‚&lt;/p>
&lt;/li>
&lt;/ul>
&lt;p>&lt;em>æ³¨æ„&lt;/em>ï¼šè™½ç„¶æ ˆæ˜¯çº¿ç¨‹ç§æœ‰çš„ï¼Œä½†ç”±äºçº¿ç¨‹é—´æ²¡æœ‰ä¸¥æ ¼çš„å†…å­˜éš”ç¦»æœºåˆ¶ï¼Œä¸€ä¸ªçº¿ç¨‹å¯ä»¥é€šè¿‡æŒ‡é’ˆè®¿é—®å’Œä¿®æ”¹å¦ä¸€ä¸ªçº¿ç¨‹çš„æ ˆæ•°æ®ã€‚&lt;/p></description></item><item><title>è¿è¡Œæ—¶æ˜¯æŠŠæ•´ä¸ªåŠ¨æ€åº“éƒ½åŠ è½½åˆ°å†…å­˜ä¸­å—ï¼Ÿ</title><link>https://jekyulll.github.io/posts/cpp-%E8%BF%90%E8%A1%8C%E6%97%B6%E6%98%AF%E6%8A%8A%E6%95%B4%E4%B8%AA%E5%8A%A8%E6%80%81%E5%BA%93%E9%83%BD%E5%8A%A0%E8%BD%BD%E5%88%B0%E5%86%85%E5%AD%98%E4%B8%AD%E5%90%97/</link><pubDate>Sat, 08 Feb 2025 18:05:47 +0800</pubDate><guid>https://jekyulll.github.io/posts/cpp-%E8%BF%90%E8%A1%8C%E6%97%B6%E6%98%AF%E6%8A%8A%E6%95%B4%E4%B8%AA%E5%8A%A8%E6%80%81%E5%BA%93%E9%83%BD%E5%8A%A0%E8%BD%BD%E5%88%B0%E5%86%85%E5%AD%98%E4%B8%AD%E5%90%97/</guid><description>&lt;p>åœ¨ C++ ä¸­ï¼ŒåŠ¨æ€åº“ï¼ˆå¦‚ &lt;code>.dll&lt;/code> æˆ– &lt;code>.so&lt;/code> æ–‡ä»¶ï¼‰åœ¨åŠ è½½æ—¶ï¼Œæ“ä½œç³»ç»Ÿä¼šå°†æ•´ä¸ªåº“æ–‡ä»¶æ˜ å°„åˆ°è¿›ç¨‹çš„åœ°å€ç©ºé—´ä¸­ã€‚
&lt;u>å…·ä½“çš„å‡½æ•°å’Œæ•°æ®åªæœ‰åœ¨è¢«å®é™…ä½¿ç”¨æ—¶æ‰ä¼šè¢«åŠ è½½åˆ°å†…å­˜ä¸­ã€‚&lt;/u>
(åŠ¨æ€åº“ä½œä¸ºä¸€ä¸ªæ•´ä½“è¢«æ˜ å°„ï¼Œä½†å…¶ä¸­çš„å„ä¸ªéƒ¨åˆ†ä»…åœ¨éœ€è¦æ—¶æ‰å ç”¨ç‰©ç†å†…å­˜ã€‚)&lt;/p>
&lt;p>å¦å¤–ï¼š&lt;br>
C++ æä¾›äº†&lt;strong>æ˜¾å¼è¿è¡Œæ—¶é“¾æ¥&lt;/strong>çš„æœºåˆ¶ï¼Œç¨‹åºå¯ä»¥åœ¨è¿è¡Œæ—¶æ ¹æ®éœ€è¦åŠ¨æ€åŠ è½½åº“çš„ç‰¹å®šéƒ¨åˆ†ã€‚(&lt;code>dlopen&lt;/code>ã€&lt;code>dlsym&lt;/code> ç­‰å‡½æ•°)ç¨‹åºå¯ä»¥åœ¨è¿è¡Œæ—¶æŒ‰éœ€åŠ è½½ç‰¹å®šçš„ç¬¦å·ï¼ˆå‡½æ•°æˆ–å˜é‡ï¼‰ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;dlfcn.h&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">void&lt;/span> &lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#a6e22e">dlopen&lt;/span>(&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#66d9ef">char&lt;/span> &lt;span style="color:#f92672">*&lt;/span>filename, &lt;span style="color:#66d9ef">int&lt;/span> flag);
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>flag&lt;/code>ï¼šæŒ‡å®šåŠ è½½é€‰é¡¹ï¼š
- &lt;code>RTLD_LAZY&lt;/code>ï¼šå»¶è¿Ÿè§£æç¬¦å·ï¼Œå³åœ¨å®é™…ä½¿ç”¨æ—¶æ‰è§£æã€‚&lt;br>
- &lt;code>RTLD_NOW&lt;/code>ï¼šç«‹å³è§£ææ‰€æœ‰æœªå®šä¹‰çš„ç¬¦å·ã€‚å¦‚æœæ— æ³•è§£æï¼Œ&lt;code>dlopen&lt;/code> å°†è¿”å› &lt;code>NULL&lt;/code>ã€‚&lt;br>
- &lt;code>RTLD_GLOBAL&lt;/code>ï¼šä½¿åŠ è½½çš„åº“ä¸­çš„ç¬¦å·åœ¨åç»­åŠ è½½çš„å…¶ä»–åº“ä¸­å¯è§ã€‚&lt;br>
- &lt;code>RTLD_LOCAL&lt;/code>ï¼šä¸ &lt;code>RTLD_GLOBAL&lt;/code> ç›¸åï¼ŒåŠ è½½çš„åº“ä¸­çš„ç¬¦å·å¯¹åç»­åŠ è½½çš„åº“ä¸å¯è§ï¼ˆè¿™æ˜¯é»˜è®¤è¡Œä¸ºï¼‰ã€‚&lt;/p></description></item><item><title>æ£€æŸ¥å­—ç¬¦ä¸²æ˜¯å¦æ˜¯å¦ä¸€ä¸ªçš„å­ä¸²</title><link>https://jekyulll.github.io/posts/cpp-%E6%A3%80%E6%9F%A5%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%98%AF%E5%90%A6%E6%98%AF%E5%8F%A6%E4%B8%80%E4%B8%AA%E7%9A%84%E5%AD%90%E4%B8%B2/</link><pubDate>Wed, 29 Jan 2025 12:05:47 +0800</pubDate><guid>https://jekyulll.github.io/posts/cpp-%E6%A3%80%E6%9F%A5%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%98%AF%E5%90%A6%E6%98%AF%E5%8F%A6%E4%B8%80%E4%B8%AA%E7%9A%84%E5%AD%90%E4%B8%B2/</guid><description>&lt;h2 id="å¸¸è§-cc-api">å¸¸è§ C/C++ API&lt;/h2>
&lt;ol>
&lt;li>
&lt;p>&lt;strong>&lt;code>std::string&lt;/code>çš„ &lt;code>string::find&lt;/code> æˆå‘˜å‡½æ•°&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;string&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">using&lt;/span> &lt;span style="color:#66d9ef">namespace&lt;/span> std;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">bool&lt;/span> &lt;span style="color:#a6e22e">isSubstring&lt;/span>(&lt;span style="color:#66d9ef">const&lt;/span> string&lt;span style="color:#f92672">&amp;amp;&lt;/span> mainStr, &lt;span style="color:#66d9ef">const&lt;/span> string&lt;span style="color:#f92672">&amp;amp;&lt;/span> subStr) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> mainStr.find(subStr) &lt;span style="color:#f92672">!=&lt;/span> string&lt;span style="color:#f92672">::&lt;/span>npos;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;blockquote>
&lt;p>å¤§å¤šæ•°æ ‡å‡†åº“çš„ &lt;code>strstr&lt;/code>ï¼ˆå¦‚Glibcï¼‰å’Œ &lt;code>string::find&lt;/code>ï¼ˆå¦‚MSVCã€libc++ï¼‰å·²é’ˆå¯¹å­ä¸²æœç´¢ä¼˜åŒ–ã€‚&lt;br>
å®ç°ä¸­å¯èƒ½ç›´æ¥è°ƒç”¨ &lt;code>memmem&lt;/code> æˆ– &lt;code>strstr&lt;/code>ï¼Œæ€§èƒ½ä¸ &lt;code>strstr&lt;/code> ç›¸å½“ã€‚&lt;/p>
&lt;/blockquote>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>Cæ ‡å‡†åº“çš„ &lt;code>strstr&lt;/code> å‡½æ•°&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;cstring&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">bool&lt;/span> &lt;span style="color:#a6e22e">isSubstring&lt;/span>(&lt;span style="color:#66d9ef">const&lt;/span> string&lt;span style="color:#f92672">&amp;amp;&lt;/span> mainStr, &lt;span style="color:#66d9ef">const&lt;/span> string&lt;span style="color:#f92672">&amp;amp;&lt;/span> subStr) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> strstr(mainStr.c_str(), subStr.c_str()) &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#66d9ef">nullptr&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>éœ€è¦å°† &lt;code>std::string&lt;/code> è½¬æ¢ä¸ºCé£æ ¼å­—ç¬¦ä¸²ï¼Œå¯èƒ½å¼•å…¥é¢å¤–å¼€é”€ã€‚&lt;/p>
&lt;blockquote>
&lt;p>Glibcçš„ &lt;code>strstr&lt;/code> ä½¿ç”¨Two-Wayç®—æ³•ï¼Œé€‚åˆé•¿æ–‡æœ¬å’Œæ¨¡å¼ã€‚æ—¶é—´å¤æ‚åº¦æ¥è¿‘&lt;code>O(n)&lt;/code>ã€‚&lt;/p>
&lt;/blockquote>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>STL &lt;code>std::search&lt;/code>&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;algorithm&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;string&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">bool&lt;/span> &lt;span style="color:#a6e22e">isSubstring&lt;/span>(&lt;span style="color:#66d9ef">const&lt;/span> string&lt;span style="color:#f92672">&amp;amp;&lt;/span> mainStr, &lt;span style="color:#66d9ef">const&lt;/span> string&lt;span style="color:#f92672">&amp;amp;&lt;/span> subStr) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> std&lt;span style="color:#f92672">::&lt;/span>search(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> mainStr.begin(), mainStr.end(),
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> subStr.begin(), subStr.end()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ) &lt;span style="color:#f92672">!=&lt;/span> mainStr.end();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ol>
&lt;hr>
&lt;h2 id="ç®—æ³•">ç®—æ³•&lt;/h2>
&lt;h3 id="1-æš´åŠ›æ³•brute-force">&lt;strong>1. æš´åŠ›æ³•ï¼ˆBrute Forceï¼‰&lt;/strong>&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;string&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">bool&lt;/span> &lt;span style="color:#a6e22e">isSubstringBruteForce&lt;/span>(&lt;span style="color:#66d9ef">const&lt;/span> std&lt;span style="color:#f92672">::&lt;/span>string&lt;span style="color:#f92672">&amp;amp;&lt;/span> mainStr, &lt;span style="color:#66d9ef">const&lt;/span> std&lt;span style="color:#f92672">::&lt;/span>string&lt;span style="color:#f92672">&amp;amp;&lt;/span> subStr) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (subStr.empty()) &lt;span style="color:#66d9ef">return&lt;/span> true; &lt;span style="color:#75715e">// ç©ºå­ä¸²æ˜¯ä»»ä½•å­—ç¬¦ä¸²çš„å­ä¸²
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">int&lt;/span> m &lt;span style="color:#f92672">=&lt;/span> mainStr.length(), n &lt;span style="color:#f92672">=&lt;/span> subStr.length();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (m &lt;span style="color:#f92672">&amp;lt;&lt;/span> n) &lt;span style="color:#66d9ef">return&lt;/span> false;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">for&lt;/span> (&lt;span style="color:#66d9ef">int&lt;/span> i &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>; i &lt;span style="color:#f92672">&amp;lt;=&lt;/span> m &lt;span style="color:#f92672">-&lt;/span> n; &lt;span style="color:#f92672">++&lt;/span>i) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">int&lt;/span> j;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">for&lt;/span> (j &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>; j &lt;span style="color:#f92672">&amp;lt;&lt;/span> n; &lt;span style="color:#f92672">++&lt;/span>j) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (mainStr[i &lt;span style="color:#f92672">+&lt;/span> j] &lt;span style="color:#f92672">!=&lt;/span> subStr[j]) &lt;span style="color:#66d9ef">break&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (j &lt;span style="color:#f92672">==&lt;/span> n) &lt;span style="color:#66d9ef">return&lt;/span> true; &lt;span style="color:#75715e">// å®Œå…¨åŒ¹é…
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> false;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>&lt;strong>æ—¶é—´å¤æ‚åº¦&lt;/strong>ï¼šæœ€åæƒ…å†µä¸º (O(m \times n))ï¼ˆå¦‚ä¸»ä¸²ä¸º&lt;code>AAAAAAB&lt;/code>ï¼Œå­ä¸²ä¸º&lt;code>AAAB&lt;/code>ï¼‰ã€‚&lt;/li>
&lt;li>&lt;strong>ç©ºé—´å¤æ‚åº¦&lt;/strong>ï¼š(O(1))ã€‚&lt;/li>
&lt;/ul>
&lt;hr>
&lt;h3 id="2-kmpç®—æ³•knuth-morris-pratt">&lt;strong>2. KMPç®—æ³•ï¼ˆKnuth-Morris-Prattï¼‰&lt;/strong>&lt;/h3>
&lt;p>é€šè¿‡é¢„å¤„ç†å­ä¸²ç”Ÿæˆéƒ¨åˆ†åŒ¹é…è¡¨ï¼ˆLongest Prefix Suffix, LPSï¼‰ï¼Œåˆ©ç”¨å·²åŒ¹é…çš„ä¿¡æ¯è·³è¿‡ä¸å¿…è¦çš„æ¯”è¾ƒã€‚&lt;/p></description></item><item><title>å†™ä¸ªç›¸å¯¹ç°ä»£çš„ C++ äºŒå‰æœç´¢æ ‘</title><link>https://jekyulll.github.io/posts/cpp-%E5%86%99%E4%B8%AA%E7%9B%B8%E5%AF%B9%E7%8E%B0%E4%BB%A3%E7%9A%84-c++-%E4%BA%8C%E5%8F%89%E6%90%9C%E7%B4%A2%E6%A0%91/</link><pubDate>Tue, 21 Jan 2025 12:05:47 +0800</pubDate><guid>https://jekyulll.github.io/posts/cpp-%E5%86%99%E4%B8%AA%E7%9B%B8%E5%AF%B9%E7%8E%B0%E4%BB%A3%E7%9A%84-c++-%E4%BA%8C%E5%8F%89%E6%90%9C%E7%B4%A2%E6%A0%91/</guid><description>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;functional&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;iostream&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;optional&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;string&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;vector&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">template&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#66d9ef">typename&lt;/span> T&lt;span style="color:#f92672">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">concept&lt;/span> Comparable &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">requires&lt;/span>(T a, T b) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> { a &lt;span style="color:#f92672">&amp;lt;&lt;/span> b } &lt;span style="color:#f92672">-&amp;gt;&lt;/span> std&lt;span style="color:#f92672">::&lt;/span>convertible_to&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#66d9ef">bool&lt;/span>&lt;span style="color:#f92672">&amp;gt;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> { a &lt;span style="color:#f92672">&amp;gt;&lt;/span> b } &lt;span style="color:#f92672">-&amp;gt;&lt;/span> std&lt;span style="color:#f92672">::&lt;/span>convertible_to&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#66d9ef">bool&lt;/span>&lt;span style="color:#f92672">&amp;gt;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> { a &lt;span style="color:#f92672">==&lt;/span> b } &lt;span style="color:#f92672">-&amp;gt;&lt;/span> std&lt;span style="color:#f92672">::&lt;/span>convertible_to&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#66d9ef">bool&lt;/span>&lt;span style="color:#f92672">&amp;gt;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">template&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#66d9ef">typename&lt;/span> T&lt;span style="color:#f92672">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">concept&lt;/span> Streamable &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">requires&lt;/span>(T a, std&lt;span style="color:#f92672">::&lt;/span>ostream&lt;span style="color:#f92672">&amp;amp;&lt;/span> os) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> { os &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> a } &lt;span style="color:#f92672">-&amp;gt;&lt;/span> std&lt;span style="color:#f92672">::&lt;/span>same_as&lt;span style="color:#f92672">&amp;lt;&lt;/span>std&lt;span style="color:#f92672">::&lt;/span>ostream&lt;span style="color:#f92672">&amp;amp;&amp;gt;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">template&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span>Comparable K, Streamable V&lt;span style="color:#f92672">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">class&lt;/span> &lt;span style="color:#a6e22e">PairBSTree&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">private&lt;/span>&lt;span style="color:#f92672">:&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">using&lt;/span> Pair &lt;span style="color:#f92672">=&lt;/span> std&lt;span style="color:#f92672">::&lt;/span>pair&lt;span style="color:#f92672">&amp;lt;&lt;/span>K, V&lt;span style="color:#f92672">&amp;gt;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">struct&lt;/span> &lt;span style="color:#a6e22e">TreeNode&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Pair _pair;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> TreeNode&lt;span style="color:#f92672">*&lt;/span> _left;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> TreeNode&lt;span style="color:#f92672">*&lt;/span> _right;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> TreeNode() &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">default&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> TreeNode(&lt;span style="color:#66d9ef">const&lt;/span> Pair&lt;span style="color:#f92672">&amp;amp;&lt;/span> pair)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">:&lt;/span> _pair(pair), _left(&lt;span style="color:#66d9ef">nullptr&lt;/span>), _right(&lt;span style="color:#66d9ef">nullptr&lt;/span>) {}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> TreeNode(Pair&lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> pair)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">:&lt;/span> _pair(std&lt;span style="color:#f92672">::&lt;/span>move(pair)), _left(&lt;span style="color:#66d9ef">nullptr&lt;/span>), _right(&lt;span style="color:#66d9ef">nullptr&lt;/span>) {}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">~&lt;/span>TreeNode() &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">default&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> };
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> TreeNode&lt;span style="color:#f92672">*&lt;/span> _root;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">void&lt;/span> &lt;span style="color:#a6e22e">build_&lt;/span>(&lt;span style="color:#66d9ef">const&lt;/span> std&lt;span style="color:#f92672">::&lt;/span>vector&lt;span style="color:#f92672">&amp;lt;&lt;/span>Pair&lt;span style="color:#f92672">&amp;gt;&amp;amp;&lt;/span> nodes) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">for&lt;/span> (&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#66d9ef">auto&lt;/span>&lt;span style="color:#f92672">&amp;amp;&lt;/span> pair : nodes) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Insert(pair);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">void&lt;/span> &lt;span style="color:#a6e22e">build_&lt;/span>(std&lt;span style="color:#f92672">::&lt;/span>vector&lt;span style="color:#f92672">&amp;lt;&lt;/span>Pair&lt;span style="color:#f92672">&amp;gt;&amp;amp;&amp;amp;&lt;/span> nodes) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">for&lt;/span> (Pair&lt;span style="color:#f92672">&amp;amp;&lt;/span> pair : nodes) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Insert(std&lt;span style="color:#f92672">::&lt;/span>move(pair));
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">void&lt;/span> &lt;span style="color:#a6e22e">destroy_&lt;/span>(TreeNode&lt;span style="color:#f92672">*&lt;/span> node) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (node) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> destroy_(node&lt;span style="color:#f92672">-&amp;gt;&lt;/span>_left);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> destroy_(node&lt;span style="color:#f92672">-&amp;gt;&lt;/span>_right);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">delete&lt;/span> node;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> node &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">nullptr&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> TreeNode&lt;span style="color:#f92672">*&amp;amp;&lt;/span> search_(TreeNode&lt;span style="color:#f92672">*&amp;amp;&lt;/span> node, K key) &lt;span style="color:#66d9ef">const&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (&lt;span style="color:#f92672">!&lt;/span>node &lt;span style="color:#f92672">||&lt;/span> key &lt;span style="color:#f92672">==&lt;/span> node&lt;span style="color:#f92672">-&amp;gt;&lt;/span>_pair.first) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> node;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (key &lt;span style="color:#f92672">&amp;lt;&lt;/span> node&lt;span style="color:#f92672">-&amp;gt;&lt;/span>_pair.first) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">search_&lt;/span>(node&lt;span style="color:#f92672">-&amp;gt;&lt;/span>_left, key);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">search_&lt;/span>(node&lt;span style="color:#f92672">-&amp;gt;&lt;/span>_right, key);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">void&lt;/span> &lt;span style="color:#a6e22e">insert_&lt;/span>(TreeNode&lt;span style="color:#f92672">*&amp;amp;&lt;/span> node, &lt;span style="color:#66d9ef">const&lt;/span> Pair&lt;span style="color:#f92672">&amp;amp;&lt;/span> pair) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (&lt;span style="color:#f92672">!&lt;/span>node) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> node &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">new&lt;/span> TreeNode(pair);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">auto&lt;/span> key &lt;span style="color:#f92672">=&lt;/span> pair.first;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (key &lt;span style="color:#f92672">==&lt;/span> node&lt;span style="color:#f92672">-&amp;gt;&lt;/span>_pair.first) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> node&lt;span style="color:#f92672">-&amp;gt;&lt;/span>_pair &lt;span style="color:#f92672">=&lt;/span> pair;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> } &lt;span style="color:#66d9ef">else&lt;/span> &lt;span style="color:#66d9ef">if&lt;/span> (key &lt;span style="color:#f92672">&amp;lt;&lt;/span> node&lt;span style="color:#f92672">-&amp;gt;&lt;/span>_pair.first) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> insert_(node&lt;span style="color:#f92672">-&amp;gt;&lt;/span>_left, pair);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> } &lt;span style="color:#66d9ef">else&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> insert_(node&lt;span style="color:#f92672">-&amp;gt;&lt;/span>_right, pair);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> TreeNode&lt;span style="color:#f92672">*&amp;amp;&lt;/span> go_to_max_(TreeNode&lt;span style="color:#f92672">*&amp;amp;&lt;/span> node) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">while&lt;/span> (node&lt;span style="color:#f92672">-&amp;gt;&lt;/span>_right) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> node &lt;span style="color:#f92672">=&lt;/span> node&lt;span style="color:#f92672">-&amp;gt;&lt;/span>_right;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> node;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> TreeNode&lt;span style="color:#f92672">*&amp;amp;&lt;/span> go_to_min_(TreeNode&lt;span style="color:#f92672">*&amp;amp;&lt;/span> node) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">while&lt;/span> (node&lt;span style="color:#f92672">-&amp;gt;&lt;/span>_left) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> node &lt;span style="color:#f92672">=&lt;/span> node&lt;span style="color:#f92672">-&amp;gt;&lt;/span>_left;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> node;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">void&lt;/span> &lt;span style="color:#a6e22e">delete_&lt;/span>(TreeNode&lt;span style="color:#f92672">*&amp;amp;&lt;/span> node, K key) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">auto&lt;/span>&lt;span style="color:#f92672">&amp;amp;&lt;/span> target &lt;span style="color:#f92672">=&lt;/span> search_(node, key);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (&lt;span style="color:#f92672">!&lt;/span>target) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (&lt;span style="color:#f92672">!&lt;/span>target&lt;span style="color:#f92672">-&amp;gt;&lt;/span>_left &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> &lt;span style="color:#f92672">!&lt;/span>target&lt;span style="color:#f92672">-&amp;gt;&lt;/span>_right) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">delete&lt;/span> target;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> target &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">nullptr&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (&lt;span style="color:#f92672">!&lt;/span>target&lt;span style="color:#f92672">-&amp;gt;&lt;/span>_left) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> TreeNode&lt;span style="color:#f92672">*&lt;/span> temp &lt;span style="color:#f92672">=&lt;/span> target&lt;span style="color:#f92672">-&amp;gt;&lt;/span>_right;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">delete&lt;/span> target;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> target &lt;span style="color:#f92672">=&lt;/span> temp;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (&lt;span style="color:#f92672">!&lt;/span>target&lt;span style="color:#f92672">-&amp;gt;&lt;/span>_right) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> TreeNode&lt;span style="color:#f92672">*&lt;/span> temp &lt;span style="color:#f92672">=&lt;/span> target&lt;span style="color:#f92672">-&amp;gt;&lt;/span>_left;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">delete&lt;/span> target;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> target &lt;span style="color:#f92672">=&lt;/span> temp;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">auto&lt;/span>&lt;span style="color:#f92672">&amp;amp;&lt;/span> max_in_left &lt;span style="color:#f92672">=&lt;/span> go_to_max_(target&lt;span style="color:#f92672">-&amp;gt;&lt;/span>_left);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> target&lt;span style="color:#f92672">-&amp;gt;&lt;/span>_pair &lt;span style="color:#f92672">=&lt;/span> max_in_left&lt;span style="color:#f92672">-&amp;gt;&lt;/span>_pair;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// 1. å¸¸è§„çš„é€’å½’ï¼ŒæŠŠæ•´ä¸ªå·¦å­æ ‘å½“åšæ–°çš„æ ‘
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75715e">// delete_(target-&amp;gt;_left, max_in_left-&amp;gt;_pair.first);
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75715e">// 2. ç›´æ¥ä¼ å…¥ max_in_left å³å¯
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75715e">// delete_(max_in_left, max_in_left-&amp;gt;_pair.first);
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75715e">// 3. å®é™…ä¸Šä¸éœ€è¦é€’å½’ï¼Œå› ä¸º max_in_left æ˜¯å·¦è¾¹æœ€å¤§çš„å€¼ï¼Œä¸€å®šæ²¡æœ‰å³å­æ ‘
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> TreeNode&lt;span style="color:#f92672">*&lt;/span> temp &lt;span style="color:#f92672">=&lt;/span> max_in_left&lt;span style="color:#f92672">-&amp;gt;&lt;/span>_left;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">delete&lt;/span> max_in_left;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> max_in_left &lt;span style="color:#f92672">=&lt;/span> temp;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// æˆ‘å¼€å§‹æ—¶å€™çš„ä»£ç ï¼ˆæœ‰è¯¯ï¼‰ï¼š
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75715e">// auto&amp;amp; max_in_left = go_to_max_(node-&amp;gt;_left); // åº”è¯¥æ˜¯
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75715e">// current-&amp;gt;_left current-&amp;gt;_pair = max_in_left-&amp;gt;_pair; delete
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75715e">// (max_in_left); max_in_left = nullptr;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75715e">// ç¬¬ä¸‰ç§å’Œæˆ‘å¼€å§‹æ—¶å€™çš„é€»è¾‘ç±»ä¼¼
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75715e">// ä½†æˆ‘å½“æ—¶å¿˜äº†ä¿ç•™ max_in_left çš„å·¦å­æ ‘ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">static&lt;/span> &lt;span style="color:#66d9ef">void&lt;/span> &lt;span style="color:#a6e22e">normal_print_func_&lt;/span>(&lt;span style="color:#66d9ef">const&lt;/span> Pair&lt;span style="color:#f92672">&amp;amp;&lt;/span> pair) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> std&lt;span style="color:#f92672">::&lt;/span>cout &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> pair.second &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> &lt;span style="color:#e6db74">&amp;#34; | &amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">void&lt;/span> &lt;span style="color:#a6e22e">in_order_&lt;/span>(TreeNode&lt;span style="color:#f92672">*&lt;/span> node, std&lt;span style="color:#f92672">::&lt;/span>function&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#66d9ef">void&lt;/span>(&lt;span style="color:#66d9ef">const&lt;/span> Pair&lt;span style="color:#f92672">&amp;amp;&lt;/span>)&lt;span style="color:#f92672">&amp;gt;&lt;/span> func) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (&lt;span style="color:#f92672">!&lt;/span>node) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> in_order_(node&lt;span style="color:#f92672">-&amp;gt;&lt;/span>_left, func);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> func(node&lt;span style="color:#f92672">-&amp;gt;&lt;/span>_pair);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> in_order_(node&lt;span style="color:#f92672">-&amp;gt;&lt;/span>_right, func);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">public&lt;/span>&lt;span style="color:#f92672">:&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> PairBSTree() &lt;span style="color:#f92672">:&lt;/span> _root(&lt;span style="color:#66d9ef">nullptr&lt;/span>) {}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> PairBSTree(&lt;span style="color:#66d9ef">const&lt;/span> std&lt;span style="color:#f92672">::&lt;/span>vector&lt;span style="color:#f92672">&amp;lt;&lt;/span>Pair&lt;span style="color:#f92672">&amp;gt;&amp;amp;&lt;/span> pairs) &lt;span style="color:#f92672">:&lt;/span> _root(&lt;span style="color:#66d9ef">nullptr&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> build_(pairs);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> PairBSTree(std&lt;span style="color:#f92672">::&lt;/span>vector&lt;span style="color:#f92672">&amp;lt;&lt;/span>Pair&lt;span style="color:#f92672">&amp;gt;&amp;amp;&amp;amp;&lt;/span> pairs) &lt;span style="color:#f92672">:&lt;/span> _root(&lt;span style="color:#66d9ef">nullptr&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> build_(std&lt;span style="color:#f92672">::&lt;/span>move(pairs));
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">~&lt;/span>PairBSTree() { destroy_(_root); }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> std&lt;span style="color:#f92672">::&lt;/span>optional&lt;span style="color:#f92672">&amp;lt;&lt;/span>V&lt;span style="color:#f92672">&amp;gt;&lt;/span> Search(K key) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">auto&lt;/span> node &lt;span style="color:#f92672">=&lt;/span> search_(_root, key);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (&lt;span style="color:#f92672">!&lt;/span>node) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> std&lt;span style="color:#f92672">::&lt;/span>nullopt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> node&lt;span style="color:#f92672">-&amp;gt;&lt;/span>_pair.second;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">void&lt;/span> &lt;span style="color:#a6e22e">Insert&lt;/span>(&lt;span style="color:#66d9ef">const&lt;/span> Pair&lt;span style="color:#f92672">&amp;amp;&lt;/span> pair) { insert_(_root, pair); }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">void&lt;/span> &lt;span style="color:#a6e22e">Delete&lt;/span>(K key) { delete_(_root, key); }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">void&lt;/span> &lt;span style="color:#a6e22e">InOrder&lt;/span>(std&lt;span style="color:#f92672">::&lt;/span>function&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#66d9ef">void&lt;/span>(Pair)&lt;span style="color:#f92672">&amp;gt;&lt;/span> func &lt;span style="color:#f92672">=&lt;/span> normal_print_func_) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> in_order_(_root, func);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">[[nodiscard]]&lt;/span> size_t Size() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> size_t size &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> InOrder([&lt;span style="color:#f92672">&amp;amp;&lt;/span>size](std&lt;span style="color:#f92672">::&lt;/span>pair&lt;span style="color:#f92672">&amp;lt;&lt;/span>K, V&lt;span style="color:#f92672">&amp;gt;&lt;/span>) { &lt;span style="color:#f92672">++&lt;/span>size; });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> size;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">[[nodiscard]]&lt;/span> V Max() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">auto&lt;/span> temp &lt;span style="color:#f92672">=&lt;/span> _root;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> go_to_max_(temp);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> temp&lt;span style="color:#f92672">-&amp;gt;&lt;/span>_pair.second;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">[[nodiscard]]&lt;/span> V Min() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">auto&lt;/span> temp &lt;span style="color:#f92672">=&lt;/span> _root;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> go_to_min_(temp);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> temp&lt;span style="color:#f92672">-&amp;gt;&lt;/span>_pair.second;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">int&lt;/span> &lt;span style="color:#a6e22e">main&lt;/span>(&lt;span style="color:#66d9ef">void&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> std&lt;span style="color:#f92672">::&lt;/span>vector&lt;span style="color:#f92672">&amp;lt;&lt;/span>std&lt;span style="color:#f92672">::&lt;/span>pair&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#66d9ef">int&lt;/span>, std&lt;span style="color:#f92672">::&lt;/span>string&lt;span style="color:#f92672">&amp;gt;&amp;gt;&lt;/span> pairs &lt;span style="color:#f92672">=&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {&lt;span style="color:#ae81ff">2&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;Bob&amp;#34;&lt;/span>}, {&lt;span style="color:#ae81ff">9&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;Jack&amp;#34;&lt;/span>}, {&lt;span style="color:#ae81ff">4&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;Lucy&amp;#34;&lt;/span>}, {&lt;span style="color:#ae81ff">23&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;Evan&amp;#34;&lt;/span>},
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {&lt;span style="color:#ae81ff">3&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;Gorge&amp;#34;&lt;/span>}, {&lt;span style="color:#ae81ff">12&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;Lily&amp;#34;&lt;/span>}, {&lt;span style="color:#ae81ff">15&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;Mono&amp;#34;&lt;/span>}, {&lt;span style="color:#ae81ff">90&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;Rick&amp;#34;&lt;/span>},
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {&lt;span style="color:#ae81ff">14&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;Lance&amp;#34;&lt;/span>}, {&lt;span style="color:#ae81ff">76&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;Molly&amp;#34;&lt;/span>}, {&lt;span style="color:#ae81ff">24&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;Stan&amp;#34;&lt;/span>}, {&lt;span style="color:#ae81ff">11&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;Scot&amp;#34;&lt;/span>},
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {&lt;span style="color:#ae81ff">54&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;Mint&amp;#34;&lt;/span>}, {&lt;span style="color:#ae81ff">37&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;Biance&amp;#34;&lt;/span>}, {&lt;span style="color:#ae81ff">35&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;Cower&amp;#34;&lt;/span>}, {&lt;span style="color:#ae81ff">1&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;Brick&amp;#34;&lt;/span>},
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> };
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> PairBSTree tree(pairs);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> std&lt;span style="color:#f92672">::&lt;/span>cout &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> &lt;span style="color:#e6db74">&amp;#34;Name of 9: &amp;#34;&lt;/span> &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> tree.Search(&lt;span style="color:#ae81ff">9&lt;/span>).value_or(&lt;span style="color:#e6db74">&amp;#34;nothing&amp;#34;&lt;/span>) &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> &lt;span style="color:#e6db74">&amp;#39;\n&amp;#39;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> std&lt;span style="color:#f92672">::&lt;/span>cout &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> &lt;span style="color:#e6db74">&amp;#34;Size: &amp;#34;&lt;/span> &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> tree.Size() &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> &lt;span style="color:#e6db74">&amp;#39;\n&amp;#39;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// std::cout &amp;lt;&amp;lt; &amp;#34;Min: &amp;#34; &amp;lt;&amp;lt; tree.Min() &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#75715e">// std::cout &amp;lt;&amp;lt; &amp;#34;Max: &amp;#34; &amp;lt;&amp;lt; tree.Max() &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> tree.InOrder();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> std&lt;span style="color:#f92672">::&lt;/span>cout &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> &lt;span style="color:#e6db74">&amp;#39;\n&amp;#39;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> tree.Delete(&lt;span style="color:#ae81ff">15&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> std&lt;span style="color:#f92672">::&lt;/span>cout &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> &lt;span style="color:#e6db74">&amp;#34;Size: &amp;#34;&lt;/span> &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> tree.Size() &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> &lt;span style="color:#e6db74">&amp;#39;\n&amp;#39;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> tree.InOrder();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> std&lt;span style="color:#f92672">::&lt;/span>cout &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> &lt;span style="color:#e6db74">&amp;#39;\n&amp;#39;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> std&lt;span style="color:#f92672">::&lt;/span>vector&lt;span style="color:#f92672">&amp;lt;&lt;/span>std&lt;span style="color:#f92672">::&lt;/span>string&lt;span style="color:#f92672">&amp;gt;&lt;/span> names_in_order;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> tree.InOrder([&lt;span style="color:#f92672">&amp;amp;&lt;/span>names_in_order](std&lt;span style="color:#f92672">::&lt;/span>pair&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#66d9ef">int&lt;/span>, std&lt;span style="color:#f92672">::&lt;/span>string&lt;span style="color:#f92672">&amp;gt;&lt;/span> pair) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> std&lt;span style="color:#f92672">::&lt;/span>cout &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> pair.second &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> &lt;span style="color:#e6db74">&amp;#34; -- &amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> names_in_order.push_back(pair.second);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> std&lt;span style="color:#f92672">::&lt;/span>cout &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> std&lt;span style="color:#f92672">::&lt;/span>endl;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>C++ std::function ä¹‹è„±è£¤å­æ”¾å±çš„ä¼˜åŒ–</title><link>https://jekyulll.github.io/posts/cpp-c++-stdfunction-%E4%B9%8B%E8%84%B1%E8%A3%A4%E5%AD%90%E6%94%BE%E5%B1%81%E7%9A%84%E4%BC%98%E5%8C%96/</link><pubDate>Wed, 15 Jan 2025 12:05:47 +0800</pubDate><guid>https://jekyulll.github.io/posts/cpp-c++-stdfunction-%E4%B9%8B%E8%84%B1%E8%A3%A4%E5%AD%90%E6%94%BE%E5%B1%81%E7%9A%84%E4%BC%98%E5%8C%96/</guid><description>&lt;p>çœ‹åˆ°ä¸€å¥è¯ï¼š&lt;/p>
&lt;blockquote>
&lt;p>&lt;code>std::function&lt;/code> å¾ˆå¼ºå¤§ï¼Œä½†æ˜¯ä»£ä»·ä¹Ÿå¾ˆé«˜ï¼Œåœ¨åˆ›å»ºå‡½æ•°å¯¹è±¡çš„æ—¶å€™æ€»æ˜¯ä¼šæœ‰ &lt;code>new&lt;/code> æ“ä½œçš„ã€‚è™½ç„¶é€šå¸¸æƒ…å†µä¸‹å½±å“ä¸æ˜¯å¾ˆé«˜ï¼Œä½†æ˜¯æ€»è§‰å¾—è¿™æ˜¯æ²¡å¿…è¦çš„ã€‚&lt;/p>
&lt;/blockquote>
&lt;p>äºæ˜¯è‰è‰æ‰¾ä¸€ä¸‹èµ„æ–™ï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰éšè—çš„æ€§èƒ½ä¼˜åŒ–ã€‚&lt;/p>
&lt;hr>
&lt;h3 id="stdfunction-çš„å®ç°">&lt;code>std::function&lt;/code> çš„å®ç°&lt;/h3>
&lt;p>&lt;a href="https://zh.cppreference.com/w/cpp/utility/functional/function">&lt;code>std::function&lt;/code>&lt;/a> æ˜¯ä¸€ä¸ªå¯å˜å‚ç±»æ¨¡æ¿ï¼Œæ˜¯ä¸€ä¸ªé€šç”¨çš„å‡½æ•°åŒ…è£…å™¨ï¼ˆPolymorphic function wrapperï¼‰ã€‚&lt;br>
é€šè¿‡ç±»å‹æ“¦é™¤ï¼ˆtype erasureï¼‰æœºåˆ¶ï¼Œå°†å…·ä½“ç±»å‹çš„å¯è°ƒç”¨å¯¹è±¡å°è£…åˆ°ä¸€ä¸ªç»Ÿä¸€çš„æ¥å£ä¸­ã€‚&lt;/p>
&lt;blockquote>
&lt;p>å…¶å®ä¾‹å¯ä»¥å­˜å‚¨ã€å¤åˆ¶å’Œè°ƒç”¨ä»»ä½•å¯å¤åˆ¶æ„é€ çš„å¯è°ƒç”¨ç›®æ ‡ï¼ŒåŒ…æ‹¬æ™®é€šå‡½æ•°ã€æˆå‘˜å‡½æ•°ã€ç±»å¯¹è±¡ï¼ˆé‡è½½äº†operator()çš„ç±»çš„å¯¹è±¡ï¼‰ã€Lambdaè¡¨è¾¾å¼ç­‰ã€‚æ˜¯å¯¹C++ç°æœ‰çš„å¯è°ƒç”¨å®ä½“çš„ä¸€ç§ç±»å‹å®‰å…¨çš„åŒ…è£¹ï¼ˆç›¸æ¯”è€Œè¨€ï¼Œå‡½æ•°æŒ‡é’ˆè¿™ç§å¯è°ƒç”¨å®ä½“ï¼Œæ˜¯ç±»å‹ä¸å®‰å…¨çš„ï¼‰ã€‚ &amp;ndash; &lt;a href="https://zhuanlan.zhihu.com/p/560964284">STLæºç åˆ†æä¹‹std::function&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">template&lt;/span>&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#66d9ef">typename&lt;/span> _Res, &lt;span style="color:#66d9ef">typename&lt;/span>... _ArgTypes&lt;span style="color:#f92672">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">class&lt;/span> &lt;span style="color:#a6e22e">function&lt;/span>&lt;span style="color:#f92672">&amp;lt;&lt;/span>_Res(_ArgTypes...)&lt;span style="color:#f92672">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#66d9ef">public&lt;/span> _Maybe_unary_or_binary_function&lt;span style="color:#f92672">&amp;lt;&lt;/span>_Res, _ArgTypes...&lt;span style="color:#f92672">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> , &lt;span style="color:#66d9ef">private&lt;/span> _Function_base
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">private&lt;/span>&lt;span style="color:#f92672">:&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">using&lt;/span> _Invoker_type &lt;span style="color:#f92672">=&lt;/span> _Res (&lt;span style="color:#f92672">*&lt;/span>)(&lt;span style="color:#66d9ef">const&lt;/span> _Any_data&lt;span style="color:#f92672">&amp;amp;&lt;/span>, _ArgTypes&lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span>...);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> _Invoker_type _M_invoker;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// ...
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>};
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>std::function&lt;/code> çš„å†…éƒ¨æœ‰ä¸¤ä¸ªéƒ¨åˆ†ï¼š&lt;/p>
&lt;ul>
&lt;li>ä¸€ä¸ªæŒ‡å‘å®é™…å­˜å‚¨åŒºåŸŸçš„æŒ‡é’ˆï¼šå­˜å‚¨å®é™…çš„å¯è°ƒç”¨å¯¹è±¡ï¼ˆå‡½æ•°å¯¹è±¡ã€lambdaã€å‡½æ•°æŒ‡é’ˆç­‰ï¼‰ã€‚&lt;/li>
&lt;li>ä¸€ä¸ª&lt;em>æ¥å£è¡¨&lt;/em>ï¼ˆvtable ç­‰æ•ˆæœºåˆ¶ï¼‰ï¼šå­˜å‚¨æ“ä½œå‡½æ•°ï¼ˆå¦‚è°ƒç”¨å‡½æ•°ã€å¤åˆ¶ã€é”€æ¯ç­‰ï¼‰çš„åœ°å€ã€‚&lt;/li>
&lt;/ul>
&lt;p>å…¶ç±»å‹æ“¦é™¤é€šè¿‡æ¥å£è¡¨çš„æ–¹å¼å®ç°ï¼Œç±»ä¼¼äºè™šå‡½æ•°æœºåˆ¶ï¼Œä½†å®ƒé€šå¸¸é‡‡ç”¨é™æ€æ¥å£è¡¨å’Œæ‰‹åŠ¨çš„åŠ¨æ€åˆ†é…æ¥æ”¯æŒå¤šç§ç±»å‹çš„å¯è°ƒç”¨å¯¹è±¡ã€‚&lt;/p>
&lt;hr>
&lt;h3 id="æ€§èƒ½åˆ†æ">æ€§èƒ½åˆ†æ&lt;/h3>
&lt;p>&lt;a href="https://zhuanlan.zhihu.com/p/370563773">å…³äºstd functionå’Œlambda functionçš„æ€§èƒ½è°ƒè¯• &amp;ndash;æ³•å·æ¡‘èœ&lt;/a>ã€‚&lt;br>
&lt;a href="https://blog.demofox.org/2015/02/25/avoiding-the-performance-hazzards-of-stdfunction/">Avoiding The Performance Hazzards of std::function&lt;/a>ã€‚&lt;/p>
&lt;blockquote>
&lt;p>There are two performance implications of using &lt;code>std::function&lt;/code> that might surprise you:&lt;/p>
&lt;ol>
&lt;li>When calling a &lt;code>std::function&lt;/code>, it does a virtual function call.&lt;/li>
&lt;li>When assigning a lambda with significant captures to a &lt;code>std::function&lt;/code>, it will do a dynamic memory allocation!&lt;/li>
&lt;/ol>
&lt;/blockquote>
&lt;ul>
&lt;li>ä¸€æ˜¯&lt;code>std::function&lt;/code> ä¼šä½¿ç”¨è™šå‡½æ•°è°ƒç”¨ï¼Œæœ‰å¼€é”€ã€‚&lt;/li>
&lt;li>äºŒæ˜¯å°† lambda èµ‹ç»™&lt;code>std::function&lt;/code>çš„æ—¶å€™ï¼Œå¦‚æœæ•è·å†…å®¹è¾ƒå¤šï¼Œä¼šéœ€è¦é¢å¤–çš„åŠ¨æ€å†…å­˜åˆ†é…ã€‚&lt;/li>
&lt;/ul>
&lt;p>ç¬¬äºŒç‚¹å…¶å®è¯´çš„å°±æ˜¯ï¼š&lt;br>
&lt;code>std::function&lt;/code> å¯¹å°å‹çš„å¯è°ƒç”¨å¯¹è±¡ä¼šä½¿ç”¨â€œ&lt;strong>å°å¯¹è±¡ä¼˜åŒ–&lt;/strong>ï¼ˆSmall Object Optimization, SOOï¼‰â€ï¼Œé¿å…åŠ¨æ€åˆ†é…å †å†…å­˜ã€‚ä½†å¦‚æœå¯¹è±¡è¶…è¿‡äº†å®ç°ä¸­çš„å°å¯¹è±¡ä¼˜åŒ–é˜ˆå€¼ï¼Œåˆ™ä¼šè§¦å‘å †åˆ†é…ï¼ˆ&lt;code>new&lt;/code> æ“ä½œï¼‰ã€‚&lt;/p></description></item><item><title>åœ¨ C++ é‡Œå®ç° Golang çš„ defer</title><link>https://jekyulll.github.io/posts/cpp-%E7%94%A8-c++-%E5%AE%9E%E7%8E%B0-golang-%E7%9A%84-defer/</link><pubDate>Wed, 15 Jan 2025 12:05:47 +0800</pubDate><guid>https://jekyulll.github.io/posts/cpp-%E7%94%A8-c++-%E5%AE%9E%E7%8E%B0-golang-%E7%9A%84-defer/</guid><description>&lt;p>åˆ©ç”¨ RAII å’Œ C++ çš„ææ„å‡½æ•°ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;iostream&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;functional&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;vector&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">class&lt;/span> &lt;span style="color:#a6e22e">Defer&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">public&lt;/span>&lt;span style="color:#f92672">:&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">explicit&lt;/span> Defer(std&lt;span style="color:#f92672">::&lt;/span>function&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#66d9ef">void&lt;/span>()&lt;span style="color:#f92672">&amp;gt;&lt;/span> func) &lt;span style="color:#f92672">:&lt;/span> func_(std&lt;span style="color:#f92672">::&lt;/span>move(func)), active_(true) {}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// ç¦æ­¢å¤åˆ¶
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> Defer(&lt;span style="color:#66d9ef">const&lt;/span> Defer&lt;span style="color:#f92672">&amp;amp;&lt;/span>) &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">delete&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Defer&lt;span style="color:#f92672">&amp;amp;&lt;/span> &lt;span style="color:#66d9ef">operator&lt;/span>&lt;span style="color:#f92672">=&lt;/span>(&lt;span style="color:#66d9ef">const&lt;/span> Defer&lt;span style="color:#f92672">&amp;amp;&lt;/span>) &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">delete&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// å…è®¸ç§»åŠ¨
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> Defer(Defer&lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> other) &lt;span style="color:#66d9ef">noexcept&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">:&lt;/span> func_(std&lt;span style="color:#f92672">::&lt;/span>move(other.func_)), active_(other.active_) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> other.active_ &lt;span style="color:#f92672">=&lt;/span> false;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// ææ„å‡½æ•°ä¸­è°ƒç”¨deferçš„å‡½æ•°
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#f92672">~&lt;/span>Defer() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (active_ &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> func_) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> func_();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">void&lt;/span> &lt;span style="color:#a6e22e">cancel&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> active_ &lt;span style="color:#f92672">=&lt;/span> false;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">private&lt;/span>&lt;span style="color:#f92672">:&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> std&lt;span style="color:#f92672">::&lt;/span>function&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#66d9ef">void&lt;/span>()&lt;span style="color:#f92672">&amp;gt;&lt;/span> func_;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">bool&lt;/span> active_;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#define CONCAT_IMPL(x, y) x##y
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#define CONCAT(x, y) CONCAT_IMPL(x, y)
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#define defer(func) Defer CONCAT(_defer_, __LINE__)(func)
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">int&lt;/span> &lt;span style="color:#a6e22e">main&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> std&lt;span style="color:#f92672">::&lt;/span>cout &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> &lt;span style="color:#e6db74">&amp;#34;Start of main function&amp;#34;&lt;/span> &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> std&lt;span style="color:#f92672">::&lt;/span>endl;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> defer([]() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> std&lt;span style="color:#f92672">::&lt;/span>cout &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> &lt;span style="color:#e6db74">&amp;#34;Deferred action 1&amp;#34;&lt;/span> &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> std&lt;span style="color:#f92672">::&lt;/span>endl;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> defer([]() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> std&lt;span style="color:#f92672">::&lt;/span>cout &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> &lt;span style="color:#e6db74">&amp;#34;Deferred action in scope&amp;#34;&lt;/span> &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> std&lt;span style="color:#f92672">::&lt;/span>endl;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> std&lt;span style="color:#f92672">::&lt;/span>cout &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> &lt;span style="color:#e6db74">&amp;#34;Inside scope&amp;#34;&lt;/span> &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> std&lt;span style="color:#f92672">::&lt;/span>endl;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> defer([]() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> std&lt;span style="color:#f92672">::&lt;/span>cout &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> &lt;span style="color:#e6db74">&amp;#34;Deferred action 2&amp;#34;&lt;/span> &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> std&lt;span style="color:#f92672">::&lt;/span>endl;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> std&lt;span style="color:#f92672">::&lt;/span>cout &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> &lt;span style="color:#e6db74">&amp;#34;End of main function&amp;#34;&lt;/span> &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> std&lt;span style="color:#f92672">::&lt;/span>endl;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿™äº›å®çš„ç›®çš„æ˜¯ä¸º &lt;code>defer&lt;/code> æä¾›ä¸€ç§æ˜“ç”¨çš„è¯­æ³•ï¼ŒåŒæ—¶ç¡®ä¿æ¯æ¬¡ä½¿ç”¨ &lt;code>defer&lt;/code> éƒ½ä¼šåˆ›å»ºä¸€ä¸ªå”¯ä¸€çš„å˜é‡åï¼Œä»è€Œé¿å…å˜é‡åå†²çªã€‚&lt;/p></description></item><item><title>[è½¬è½½] C++çš„PODä»¥åŠå¦‚ä½•åˆ¤æ–­æ˜¯å¦POD</title><link>https://jekyulll.github.io/posts/cpp-%E8%BD%AC%E8%BD%BD-c++%E7%9A%84pod%E4%BB%A5%E5%8F%8A%E5%A6%82%E4%BD%95%E5%88%A4%E6%96%AD%E6%98%AF%E5%90%A6pod/</link><pubDate>Thu, 09 Jan 2025 20:05:47 +0800</pubDate><guid>https://jekyulll.github.io/posts/cpp-%E8%BD%AC%E8%BD%BD-c++%E7%9A%84pod%E4%BB%A5%E5%8F%8A%E5%A6%82%E4%BD%95%E5%88%A4%E6%96%AD%E6%98%AF%E5%90%A6pod/</guid><description>&lt;p>&lt;a href="https://zhuanlan.zhihu.com/p/17003601237">C++çš„PODä»¥åŠå¦‚ä½•åˆ¤æ–­æ˜¯å¦POD - cheetoçš„æ–‡ç«  - çŸ¥ä¹&lt;/a>ã€‚&lt;/p>
&lt;hr>
&lt;p>åœ¨C++11åŠä»¥åçš„ç‰ˆæœ¬ä¸­ï¼ŒPODç±»å‹ï¼ˆPlain Old Dataï¼‰çš„å®šä¹‰è¢«ç»†åŒ–ä¸ºä¸¤ä¸ªæ ¸å¿ƒæ¦‚å¿µï¼š&lt;br>
&lt;strong>å¹³å‡¡ç±»å‹&lt;/strong>ï¼ˆTrivial Typeï¼‰å’Œ&lt;strong>æ ‡å‡†å¸ƒå±€ç±»å‹&lt;/strong>ï¼ˆStandard Layout Typeï¼‰ã€‚å½“ç±»å‹ä¸ºTrivial &amp;amp;&amp;amp; Standard Layoutæ—¶æ‰èƒ½è¢«è®¤ä¸ºæ˜¯PODã€‚&lt;/p>
&lt;h3 id="å¹³å‡¡ç±»å‹trivial-type">å¹³å‡¡ç±»å‹ï¼ˆTrivial Typeï¼‰&lt;/h3>
&lt;p>æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š&lt;/p>
&lt;ul>
&lt;li>é»˜è®¤æ„é€ å‡½æ•°ï¼šæ²¡æœ‰ç”¨æˆ·å®šä¹‰çš„æ„é€ å‡½æ•°ï¼Œå³ä½¿ç”¨é»˜è®¤æ„é€ å‡½æ•°ã€‚&lt;/li>
&lt;li>é»˜è®¤æ‹·è´æ„é€ å‡½æ•°ï¼šæ²¡æœ‰ç”¨æˆ·å®šä¹‰çš„æ‹·è´æ„é€ å‡½æ•°ã€‚&lt;/li>
&lt;li>é»˜è®¤ææ„å‡½æ•°ï¼šæ²¡æœ‰ç”¨æˆ·å®šä¹‰çš„ææ„å‡½æ•°ã€‚&lt;/li>
&lt;li>é»˜è®¤èµ‹å€¼æ“ä½œç¬¦ï¼šæ²¡æœ‰ç”¨æˆ·å®šä¹‰çš„æ‹·è´èµ‹å€¼å’Œç§»åŠ¨èµ‹å€¼æ“ä½œç¬¦ã€‚&lt;/li>
&lt;/ul>
&lt;p>å¯¹äºå¹³å‡¡ç±»å‹ï¼Œç¼–è¯‘å™¨ä¼šä¸ºå…¶æä¾›é»˜è®¤çš„æ„é€ ã€æ‹·è´å’Œææ„è¡Œä¸ºï¼Œæ— éœ€ç”¨æˆ·æ˜¾å¼å®šä¹‰ã€‚&lt;/p>
&lt;p>æ¯”å¦‚è¯´ä»¥ä¸‹&lt;code>Trivial&lt;/code>ï¼Œå³ä½¿å®ƒæœ‰æ„é€ å‡½æ•°å’Œææ„å‡½æ•° åªè¦ä¸æ˜¯ç”¨æˆ·è‡ªå®šä¹‰è€Œæ˜¯&lt;code>default&lt;/code>ä¹Ÿå¯ä»¥&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">struct&lt;/span> &lt;span style="color:#a6e22e">Trivial&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">int&lt;/span> a;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Trivial() &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">default&lt;/span>; &lt;span style="color:#75715e">// é»˜è®¤æ„é€ å‡½æ•°
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#f92672">~&lt;/span>Trivial() &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">default&lt;/span>; &lt;span style="color:#75715e">// é»˜è®¤ææ„å‡½æ•°
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>};
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="æ ‡å‡†å¸ƒå±€ç±»å‹standard-layout-type">æ ‡å‡†å¸ƒå±€ç±»å‹ï¼ˆStandard Layout Typeï¼‰&lt;/h3>
&lt;p>æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š&lt;/p>
&lt;ul>
&lt;li>æ— è™šå‡½æ•°ï¼šå®ƒæ²¡æœ‰è™šå‡½æ•°ã€‚&lt;/li>
&lt;li>æ— è™šåŸºç±»ï¼šå®ƒæ²¡æœ‰è™šåŸºç±»ã€‚&lt;/li>
&lt;li>æˆå‘˜å˜é‡é¡ºåºï¼šå®ƒçš„æˆå‘˜å˜é‡æ˜¯æŒ‰å£°æ˜é¡ºåºæ’åˆ—çš„ã€‚&lt;/li>
&lt;li>&lt;/li>
&lt;/ul>
&lt;p>ç›´æ¥ç”¨&lt;code>std::is_standard_layout_v&lt;/code>åˆ¤æ–­å³å¯&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#define Print(x) std::cout &amp;lt;&amp;lt; x &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">struct&lt;/span> &lt;span style="color:#a6e22e">safe&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">int&lt;/span> m;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">struct&lt;/span> &lt;span style="color:#a6e22e">unsafe_cons&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> unsafe_cons(unsafe_cons &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#f92672">&amp;amp;&lt;/span>) {}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">struct&lt;/span> &lt;span style="color:#a6e22e">unsafe_vir&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">virtual&lt;/span> &lt;span style="color:#66d9ef">void&lt;/span> &lt;span style="color:#a6e22e">foo&lt;/span>();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">template&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#66d9ef">typename&lt;/span> T&lt;span style="color:#f92672">&amp;gt;&lt;/span> &lt;span style="color:#66d9ef">class&lt;/span> &lt;span style="color:#a6e22e">unsafe_tem&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> T data;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">struct&lt;/span> &lt;span style="color:#a6e22e">Trivial&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">int&lt;/span> a;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Trivial() &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">default&lt;/span>; &lt;span style="color:#75715e">// é»˜è®¤æ„é€ å‡½æ•°
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#f92672">~&lt;/span>Trivial() &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">default&lt;/span>; &lt;span style="color:#75715e">// é»˜è®¤ææ„å‡½æ•°
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>};
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">struct&lt;/span> &lt;span style="color:#a6e22e">StandardLayout&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">char&lt;/span> a; &lt;span style="color:#75715e">// 1 byte
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">int&lt;/span> b; &lt;span style="color:#75715e">// 4 bytes
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>};
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// ç”¨äºæ£€æŸ¥æ˜¯å¦ä¸º POD ç±»å‹
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">template&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#66d9ef">typename&lt;/span> T&lt;span style="color:#f92672">&amp;gt;&lt;/span> &lt;span style="color:#66d9ef">struct&lt;/span> &lt;span style="color:#a6e22e">is_pod&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">static&lt;/span> &lt;span style="color:#66d9ef">constexpr&lt;/span> &lt;span style="color:#66d9ef">bool&lt;/span> value &lt;span style="color:#f92672">=&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> std&lt;span style="color:#f92672">::&lt;/span>is_trivial&lt;span style="color:#f92672">&amp;lt;&lt;/span>T&lt;span style="color:#f92672">&amp;gt;::&lt;/span>value &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> std&lt;span style="color:#f92672">::&lt;/span>is_standard_layout&lt;span style="color:#f92672">&amp;lt;&lt;/span>T&lt;span style="color:#f92672">&amp;gt;::&lt;/span>value &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> std&lt;span style="color:#f92672">::&lt;/span>is_trivially_default_constructible&lt;span style="color:#f92672">&amp;lt;&lt;/span>T&lt;span style="color:#f92672">&amp;gt;::&lt;/span>value;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">void&lt;/span> &lt;span style="color:#a6e22e">test1&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Print(is_pod&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#66d9ef">int&lt;/span>&lt;span style="color:#f92672">&amp;gt;::&lt;/span>value); &lt;span style="color:#75715e">// 1
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> Print(is_pod&lt;span style="color:#f92672">&amp;lt;&lt;/span>std&lt;span style="color:#f92672">::&lt;/span>string&lt;span style="color:#f92672">&amp;gt;::&lt;/span>value); &lt;span style="color:#75715e">// 0
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> Print(is_pod&lt;span style="color:#f92672">&amp;lt;&lt;/span>Trivial&lt;span style="color:#f92672">&amp;gt;::&lt;/span>value); &lt;span style="color:#75715e">// 1
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> Print(is_pod&lt;span style="color:#f92672">&amp;lt;&lt;/span>StandardLayout&lt;span style="color:#f92672">&amp;gt;::&lt;/span>value); &lt;span style="color:#75715e">// 1
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> Print(std&lt;span style="color:#f92672">::&lt;/span>is_trivial&lt;span style="color:#f92672">&amp;lt;&lt;/span>Trivial&lt;span style="color:#f92672">&amp;gt;::&lt;/span>value); &lt;span style="color:#75715e">// 1
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> Print(std&lt;span style="color:#f92672">::&lt;/span>is_trivial&lt;span style="color:#f92672">&amp;lt;&lt;/span>StandardLayout&lt;span style="color:#f92672">&amp;gt;::&lt;/span>value); &lt;span style="color:#75715e">// 1
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> Print(std&lt;span style="color:#f92672">::&lt;/span>is_standard_layout_v&lt;span style="color:#f92672">&amp;lt;&lt;/span>StandardLayout&lt;span style="color:#f92672">&amp;gt;&lt;/span>); &lt;span style="color:#75715e">// 1
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿™é‡Œçš„æ ‡å‡†å¸ƒå±€çš„åˆ¤å®šåè€Œæ²¡æœ‰è¿™ä¹ˆä¸¥æ ¼&lt;/p></description></item><item><title>ä»åœºæ™¯è§£æ C++ shared_from_this</title><link>https://jekyulll.github.io/posts/cpp-%E4%BB%8E%E5%9C%BA%E6%99%AF%E8%A7%A3%E6%9E%90-c++-shared_from_this/</link><pubDate>Thu, 09 Jan 2025 20:05:47 +0800</pubDate><guid>https://jekyulll.github.io/posts/cpp-%E4%BB%8E%E5%9C%BA%E6%99%AF%E8%A7%A3%E6%9E%90-c++-shared_from_this/</guid><description>&lt;hr>
&lt;p>&lt;a href="https://blog.csdn.net/weixin_44517656/article/details/114208041">æ™ºèƒ½æŒ‡é’ˆä¹‹shared_ptræ˜“é”™ç‚¹05&lt;/a>ã€‚&lt;br>
&lt;a href="https://zhuanlan.zhihu.com/p/701343248">æŒæ¡C++ æ™ºèƒ½æŒ‡é’ˆçš„è‡ªæˆ‘å¼•ç”¨ï¼šæ·±å…¥è§£æ &lt;code>shared_from_this&lt;/code> å’Œ &lt;code>weak_from_this&lt;/code>&lt;/a>ã€‚&lt;br>
&lt;a href="https://blog.csdn.net/weixin_44834554/article/details/131589849">C++ä¹‹shared_from_thisç”¨æ³•ä»¥åŠç±»è‡ªå¼•ç”¨thisæŒ‡é’ˆé™·é˜±&lt;/a>ã€‚&lt;/p>
&lt;hr>
&lt;p>&lt;strong>æ€è€ƒ&lt;/strong>ï¼š&lt;/p>
&lt;blockquote>
&lt;p>è®¾è®¡ä¸€ä¸ªæ ‘çš„èŠ‚ç‚¹çš„æ—¶å€™ï¼Œå¦‚æœä½¿ç”¨æ™ºèƒ½æŒ‡é’ˆï¼šç”¨ä¸€ä¸ª&lt;code>std::vector&amp;lt;shared_ptr&amp;lt;TreeNode&amp;gt;&amp;gt;&lt;/code>æ¥å­˜å‚¨å­èŠ‚ç‚¹ï¼Œä¸ºé¿å…å¾ªç¯å¼•ç”¨ï¼Œç”¨&lt;code>weak_ptr&amp;lt;TreeNode&amp;gt;&lt;/code>æ¥å­˜å‚¨è‡ªèº«çš„çˆ¶èŠ‚ç‚¹æŒ‡é’ˆã€‚&lt;br>
é‚£æ·»åŠ å­èŠ‚ç‚¹çš„æ—¶å€™ï¼Œæ€ä¹ˆæŠŠè‡ªèº«çš„&lt;code>shared_ptr&lt;/code>èµ‹å€¼ç»™å­èŠ‚ç‚¹å­˜å‚¨çš„çˆ¶èŠ‚ç‚¹æŒ‡é’ˆå‘¢ï¼Ÿ&lt;/p>
&lt;/blockquote>
&lt;h3 id="ä¸¤ä¸ªé”™è¯¯åšæ³•">ä¸¤ä¸ªé”™è¯¯åšæ³•ï¼š&lt;/h3>
&lt;ol>
&lt;li>ä½¿ç”¨&lt;code>std::make_shared&amp;lt;TreeNode&amp;lt;T&amp;gt;&amp;gt;(*this)&lt;/code>æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„&lt;code>shared_ptr&lt;/code>ï¼Œç„¶åèµ‹å€¼ç»™å­èŠ‚ç‚¹å­˜å‚¨çš„çˆ¶èŠ‚ç‚¹æŒ‡é’ˆã€‚&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">void&lt;/span> &lt;span style="color:#a6e22e">addChild&lt;/span>(std&lt;span style="color:#f92672">::&lt;/span>shared_ptr&lt;span style="color:#f92672">&amp;lt;&lt;/span>TreeNode&lt;span style="color:#f92672">&amp;lt;&lt;/span>T&lt;span style="color:#f92672">&amp;gt;&amp;gt;&lt;/span> child) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// ä½¿ç”¨ make_shared æ¥åˆ›å»ºå­èŠ‚ç‚¹å¹¶è®¾ç½®çˆ¶èŠ‚ç‚¹
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> child&lt;span style="color:#f92672">-&amp;gt;&lt;/span>setParent(std&lt;span style="color:#f92672">::&lt;/span>make_shared&lt;span style="color:#f92672">&amp;lt;&lt;/span>TreeNode&lt;span style="color:#f92672">&amp;lt;&lt;/span>T&lt;span style="color:#f92672">&amp;gt;&amp;gt;&lt;/span>(&lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#66d9ef">this&lt;/span>)); &lt;span style="color:#75715e">// é”™è¯¯çš„åšæ³•
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> children.push_back(child);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä½¿ç”¨ &lt;code>std::make_shared&amp;lt;TreeNode&amp;lt;T&amp;gt;&amp;gt;(*this)&lt;/code> æ—¶ï¼Œå®é™…ä¸Šæ˜¯å¯¹å½“å‰å¯¹è±¡çš„ æ‹·è´æ„é€ ï¼ˆè°ƒç”¨æ‹·è´æ„é€ å‡½æ•°ï¼‰æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„ &lt;code>TreeNode&amp;lt;T&amp;gt;&lt;/code> å¯¹è±¡ã€‚è¿™æ„å‘³ç€ä½ å°†å½“å‰èŠ‚ç‚¹çš„çŠ¶æ€ï¼ˆä½†ä¸æ˜¯æ™ºèƒ½æŒ‡é’ˆï¼‰æ‹·è´åˆ°ä¸€ä¸ªæ–°çš„å¯¹è±¡ä¸­ï¼Œè€Œæ–°å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸç”± &lt;code>std::shared_ptr&lt;/code> ç®¡ç†ã€‚&lt;/p>
&lt;ol start="2">
&lt;li>ä½¿ç”¨ &lt;code>std::shared_ptr&amp;lt;TreeNode&amp;lt;T&amp;gt;&amp;gt; ptr(this)&lt;/code> æŠŠè£¸æŒ‡é’ˆ &lt;code>this&lt;/code> åŒ…è£…ä¸º &lt;code>shared_ptr&lt;/code>ã€‚&lt;/li>
&lt;/ol>
&lt;p>å°† &lt;code>this&lt;/code> ä¼ é€’ç»™ &lt;code>std::shared_ptr&amp;lt;TreeNode&amp;lt;T&amp;gt;&amp;gt;&lt;/code> ä¼šå¯¼è‡´æ–°åˆ›å»ºçš„ &lt;code>shared_ptr&lt;/code> ç®¡ç†ä¸€ä¸ªè£¸æŒ‡é’ˆï¼Œè€Œè£¸æŒ‡é’ˆçš„ç”Ÿå‘½å‘¨æœŸæ²¡æœ‰ç”±æ™ºèƒ½æŒ‡é’ˆæ§åˆ¶ã€‚&lt;/p>
&lt;p>å¼•å‡ºä¸€ä¸ªå¸¸è§„é—®é¢˜ï¼Œä»è£¸æŒ‡é’ˆåˆ›å»º &lt;code>shared_ptr&lt;/code> çš„éšæ‚£ï¼š&lt;/p>
&lt;ul>
&lt;li>å½“ &lt;code>shared_ptr&lt;/code> çš„å¼•ç”¨è®¡æ•°å½’é›¶æ—¶ï¼Œå®ƒä¼šé‡Šæ”¾å®ƒæ‰€ç®¡ç†çš„å¯¹è±¡ã€‚å¦‚æœè£¸æŒ‡é’ˆåœ¨æ­¤æ—¶ç»§ç»­å­˜åœ¨ï¼Œå®ƒä»ç„¶ä¼šæŒ‡å‘åŸæ¥çš„å†…å­˜åœ°å€ã€‚ä½†è¿™æ—¶è¯¥å†…å­˜å·²è¢«é‡Šæ”¾ï¼Œè£¸æŒ‡é’ˆæˆä¸ºäº†&lt;em>æ‚¬ç©ºæŒ‡é’ˆ&lt;/em>ï¼Œä¹Ÿå°±æ˜¯æ‰€è°“çš„&lt;em>é‡æŒ‡é’ˆ&lt;/em>ã€‚&lt;/li>
&lt;li>å¦‚æœè£¸æŒ‡é’ˆæŒ‡å‘çš„å†…å­˜å·²ç»è¢«é‡Šæ”¾ï¼ˆä¾‹å¦‚ï¼Œè¯¥æŒ‡é’ˆåŸæœ¬ç”± &lt;code>delete&lt;/code> æˆ– &lt;code>delete[]&lt;/code> é‡Šæ”¾ï¼‰ï¼Œç„¶åä½ ç”¨è¿™ä¸ªè£¸æŒ‡é’ˆåˆ›å»º &lt;code>shared_ptr&lt;/code>ï¼Œé‚£ä¹ˆ &lt;code>shared_ptr&lt;/code> ä»ç„¶ä¼šç®¡ç†è¿™ä¸ªå·²ç»é‡Šæ”¾çš„å†…å­˜åŒºåŸŸã€‚è¿™ä¼šå¯¼è‡´è®¿é—®å·²é‡Šæ”¾å†…å­˜ï¼ˆæ‚¬ç©ºæŒ‡é’ˆï¼‰æˆ–&lt;em>åŒé‡é‡Šæ”¾å†…å­˜&lt;/em>çš„é—®é¢˜ï¼ˆå¦‚æœ &lt;code>shared_ptr&lt;/code> é”€æ¯æ—¶å†æ¬¡é‡Šæ”¾å†…å­˜ï¼‰ã€‚&lt;/li>
&lt;li>è£¸æŒ‡é’ˆå¯èƒ½æŒ‡å‘ä¸€ä¸ªæ ˆä¸Šçš„å¯¹è±¡ï¼šå¦‚æœè£¸æŒ‡é’ˆæŒ‡å‘ä¸€ä¸ªæ ˆä¸Šåˆ†é…çš„å¯¹è±¡ï¼Œå¹¶ä¸”ä½ ç”¨å®ƒåˆ›å»º &lt;code>shared_ptr&lt;/code>ï¼Œé‚£ä¹ˆ &lt;code>shared_ptr&lt;/code> ä¼šè¯•å›¾åœ¨å¼•ç”¨è®¡æ•°å½’é›¶æ—¶é‡Šæ”¾è¿™ä¸ªæ ˆä¸Šå¯¹è±¡çš„å†…å­˜ã€‚ç„¶è€Œï¼Œæ ˆä¸Šå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸç”±æ ˆå¸§çš„é”€æ¯æ¥ç®¡ç†ï¼Œè€Œ &lt;code>shared_ptr&lt;/code> å¹¶ä¸æ¸…æ¥šè¿™ä¸€ç‚¹ã€‚è¿™å°†å¯¼è‡´ç¨‹åºçš„æœªå®šä¹‰è¡Œä¸ºã€‚&lt;/li>
&lt;/ul>
&lt;p>&lt;strong>æ¡ˆä¾‹&lt;/strong>ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">class&lt;/span> &lt;span style="color:#a6e22e">TestB&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">public&lt;/span>&lt;span style="color:#f92672">:&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	TestB(){
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>		cout &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> &lt;span style="color:#e6db74">&amp;#34;TestB create&amp;#34;&lt;/span> &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> endl;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	&lt;span style="color:#f92672">~&lt;/span>TestB(){
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>		cout &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> &lt;span style="color:#e6db74">&amp;#34;TestB destory&amp;#34;&lt;/span> &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> endl;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	shared_ptr&lt;span style="color:#f92672">&amp;lt;&lt;/span>TestB&lt;span style="color:#f92672">&amp;gt;&lt;/span> getSharedFromThis() { 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>		&lt;span style="color:#66d9ef">return&lt;/span> shared_ptr&lt;span style="color:#f92672">&amp;lt;&lt;/span>TestB&lt;span style="color:#f92672">&amp;gt;&lt;/span> (&lt;span style="color:#66d9ef">this&lt;/span>); 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">int&lt;/span> &lt;span style="color:#a6e22e">main&lt;/span>(){
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>		shared_ptr&lt;span style="color:#f92672">&amp;lt;&lt;/span>TestB&lt;span style="color:#f92672">&amp;gt;&lt;/span> ptr3(&lt;span style="color:#66d9ef">new&lt;/span> TestB());
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>		shared_ptr&lt;span style="color:#f92672">&amp;lt;&lt;/span>TestB&lt;span style="color:#f92672">&amp;gt;&lt;/span> ptr4 &lt;span style="color:#f92672">=&lt;/span> ptr3&lt;span style="color:#f92672">-&amp;gt;&lt;/span>getSharedFromThis();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>		cout &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> &lt;span style="color:#e6db74">&amp;#34;ptr2 count: &amp;#34;&lt;/span> &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> ptr3.use_count() &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> &lt;span style="color:#e6db74">&amp;#34; ptr4 count: &amp;#34;&lt;/span> &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> ptr4.use_count() &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> endl;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>		&lt;span style="color:#75715e">//è¾“å‡ºï¼šptr2 count: 1 ptr4 count: 1 ç„¶åä¼šå´©æºƒå› ä¸ºé‡å¤é‡Šæ”¾
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>	}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	cin.get();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	&lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¦‚ä½•ä¼šå¯¼è‡´&lt;code>shared_ptr&lt;/code>æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡ï¼Œä½†æ˜¯ä¸å…±äº«å¼•ç”¨è®¡æ•°å™¨ï¼Ÿ&lt;br>
æ˜¯å› ä¸ºè£¸æŒ‡é’ˆä¸&lt;code>shared_ptr&lt;/code>æ··ç”¨ï¼Œå¦‚æœæˆ‘ä»¬ç”¨ä¸€ä¸ªè£¸æŒ‡é’ˆåˆå§‹åŒ–æˆ–è€…èµ‹å€¼ç»™&lt;code>shared_ptr&lt;/code>æŒ‡é’ˆæ—¶ï¼Œåœ¨&lt;code>shared_ptr&lt;/code>å†…éƒ¨ç”Ÿæˆä¸€ä¸ªè®¡æ•°å™¨ï¼Œå½“å¦å¤–ä¸€ä¸ª&lt;code>shared_ptr&lt;/code>ä¸ç”¨&lt;code>share_ptr&lt;/code>èµ‹å€¼æˆ–è€…åˆå§‹åŒ–çš„è¯ï¼Œå†æ¬¡å°†ä¸€ä¸ªè£¸æŒ‡é’ˆèµ‹å€¼ç»™å¦å¤–ä¸€ä¸ª&lt;code>shared_ptr&lt;/code>æ—¶ï¼Œåˆä¸€æ¬¡ç”Ÿæˆä¸€ä¸ªè®¡æ•°å™¨ï¼Œä¸¤ä¸ªè®¡æ•°å™¨ä¸å…±äº«ã€‚&lt;/p></description></item><item><title>Redis æ•°æ®ç»“æ„ä¹‹è¶…æ—¥å¿— HyperLogLog</title><link>https://jekyulll.github.io/posts/redis-redis-%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B9%8B%E8%B6%85%E6%97%A5%E5%BF%97-hyperloglog/</link><pubDate>Wed, 08 Jan 2025 10:05:47 +0800</pubDate><guid>https://jekyulll.github.io/posts/redis-redis-%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B9%8B%E8%B6%85%E6%97%A5%E5%BF%97-hyperloglog/</guid><description>&lt;p>Redis åœ¨ 2.8.9 ç‰ˆæœ¬æ·»åŠ äº† HyperLogLog ï¼ˆHLLï¼‰ã€‚&lt;br>
HyperLogLog æ˜¯ä¸€ç§é«˜æ•ˆçš„åŸºæ•°ä¼°ç®—å·¥å…·ï¼Œé€šè¿‡æ¦‚ç‡ç®—æ³•å’Œå“ˆå¸ŒåŒ–æŠ€æœ¯ï¼Œåœ¨å¸¸æ•°ç©ºé—´å†…æä¾›äº†åŸºæ•°çš„ä¼°ç®—ã€‚&lt;/p>
&lt;p>&lt;em>eg&lt;/em>.&lt;/p>
&lt;ul>
&lt;li>ç»Ÿè®¡ä¸€ä¸ªç½‘ç«™çš„ç‹¬ç«‹ç”¨æˆ·æ•°ã€‚&lt;/li>
&lt;li>ç»Ÿè®¡ä¸€ä¸ªæ—¥å¿—ä¸­çš„ç‹¬ç«‹ IP æ•°é‡ã€‚&lt;/li>
&lt;li>è®¡ç®—ä¸€ä¸ªæµä¸­çš„ç‹¬ç«‹äº‹ä»¶æ•°ã€‚&lt;/li>
&lt;/ul>
&lt;p>ä¼ ç»Ÿçš„åšæ³•æ˜¯å°†æ‰€æœ‰å…ƒç´ å­˜å‚¨åœ¨é›†åˆä¸­ï¼Œç„¶åè¿›è¡Œå»é‡ã€è®¡æ•°ã€‚ä½†å½“é›†åˆçš„å…ƒç´ æ•°é‡éå¸¸å¤§æ—¶ï¼Œè¿™ç§æ–¹æ³•ä¼šå ç”¨å¤§é‡å†…å­˜ï¼Œç”šè‡³æ— æ³•å­˜å‚¨æ‰€æœ‰æ•°æ®ã€‚&lt;br>
HyperLogLog æœ‰ä¸€å®šè¯¯å·®ï¼Œä½†å¯¹äºæµ·é‡æ•°æ®æ¥è¯´ï¼Œå®ƒçš„å†…å­˜å¼€é”€æä½ä¸”ç²¾åº¦è¶³å¤Ÿé«˜ï¼Œéå¸¸é€‚åˆç”¨äºå¤§æ•°æ®å¤„ç†ã€æµé‡ç»Ÿè®¡ã€å»é‡è®¡æ•°ç­‰åœºæ™¯ã€‚&lt;/p>
&lt;p>Redis ä¸­çš„ HyperLogLog æ”¯æŒä»¥ä¸‹æ“ä½œï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;strong>&lt;code>PFADD&lt;/code>&lt;/strong>ï¼šå°†å…ƒç´ æ·»åŠ åˆ° HyperLogLog ä¸­ï¼ŒRedis ä¼šå¯¹å…ƒç´ è¿›è¡Œå“ˆå¸Œå¤„ç†ï¼Œå¹¶æ›´æ–°ç›¸åº”çš„æ¡¶ã€‚&lt;/li>
&lt;li>&lt;strong>&lt;code>PFCOUNT&lt;/code>&lt;/strong>ï¼šè¿”å›ä¸€ä¸ªæˆ–å¤šä¸ª HyperLogLog é”®çš„åŸºæ•°ä¼°ç®—ã€‚&lt;/li>
&lt;li>&lt;strong>&lt;code>PFMERGE&lt;/code>&lt;/strong>ï¼šåˆå¹¶å¤šä¸ª HyperLogLog é”®çš„åŸºæ•°ä¼°ç®—ã€‚&lt;/li>
&lt;/ul>
&lt;hr>
&lt;h3 id="æ ¸å¿ƒæ€æƒ³">æ ¸å¿ƒæ€æƒ³&lt;/h3>
&lt;p>HyperLogLog ä½¿ç”¨æ¦‚ç‡ç®—æ³•ï¼Œé€šè¿‡å“ˆå¸ŒåŒ–æ•°æ®å¹¶è®°å½•å“ˆå¸Œå€¼çš„å‰å¯¼é›¶æ•°é‡æ¥ä¼°ç®—åŸºæ•°ã€‚&lt;/p>
&lt;h5 id="1-å“ˆå¸Œå‡½æ•°ä¸äºŒè¿›åˆ¶è¡¨ç¤º">&lt;strong>1. å“ˆå¸Œå‡½æ•°ä¸äºŒè¿›åˆ¶è¡¨ç¤º&lt;/strong>&lt;/h5>
&lt;p>ä¸ºäº†å°†é›†åˆä¸­çš„å…ƒç´ æ˜ å°„ä¸ºå“ˆå¸Œå€¼ï¼ŒHyperLogLog ä½¿ç”¨äº† &lt;strong>å“ˆå¸Œå‡½æ•°&lt;/strong>ã€‚å‡è®¾æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ª &lt;strong>m-bit&lt;/strong> çš„å“ˆå¸Œå‡½æ•°ï¼Œå®ƒä¼šæŠŠè¾“å…¥æ•°æ®æ˜ å°„åˆ°ä¸€ä¸ªåŒ…å« m ä½äºŒè¿›åˆ¶æ•°å­—çš„å“ˆå¸Œå€¼ã€‚&lt;/p>
&lt;p>ä¾‹å¦‚ï¼š&lt;/p>
&lt;ul>
&lt;li>å‡è®¾æˆ‘ä»¬å°†ä¸€ä¸ªå…ƒç´ å“ˆå¸Œæˆ &lt;code>10111001101100010101010101101010&lt;/code> è¿™æ ·çš„ 32 ä½äºŒè¿›åˆ¶æ•°å­—ã€‚&lt;/li>
&lt;li>è¿™ä¸ªå“ˆå¸Œå€¼çš„å‰å¯¼é›¶æ•°é‡å°±æ˜¯æˆ‘ä»¬å…³å¿ƒçš„æŒ‡æ ‡ã€‚å¯¹äºè¿™ä¸ªä¾‹å­ï¼Œå‡è®¾å‰å¯¼é›¶çš„æ•°é‡ä¸º 3ã€‚&lt;/li>
&lt;/ul>
&lt;h5 id="2-å…³é”®ç‚¹è®°å½•å‰å¯¼é›¶çš„æ•°é‡">&lt;strong>2. å…³é”®ç‚¹ï¼šè®°å½•å‰å¯¼é›¶çš„æ•°é‡&lt;/strong>&lt;/h5>
&lt;p>HyperLogLog å¹¶ä¸ç›´æ¥å­˜å‚¨æ¯ä¸ªå“ˆå¸Œå€¼ï¼Œè€Œæ˜¯è®¡ç®—æ¯ä¸ªå“ˆå¸Œå€¼çš„å‰å¯¼é›¶çš„æ•°é‡ï¼ŒæŠŠè¿™ä¸ªå€¼ä¿å­˜åœ¨ä¸€ä¸ªæ¡¶ï¼ˆé€šè¿‡å“ˆå¸Œå€¼çš„æŸäº›ä½è¿›è¡Œæ˜ å°„ï¼‰ä¸­ã€‚&lt;/p>
&lt;h5 id="3-æ¡¶ä¸æ¡¶ç¼–å·">&lt;strong>3. æ¡¶ä¸æ¡¶ç¼–å·&lt;/strong>&lt;/h5>
&lt;p>ä¸ºäº†ä¼˜åŒ–ç©ºé—´ï¼ŒHyperLogLog ä½¿ç”¨å¤šä¸ªæ¡¶æ¥å­˜å‚¨ä¸åŒçš„å“ˆå¸Œå€¼ã€‚æ¯ä¸ªæ¡¶çš„ç´¢å¼•æ˜¯ç”±å“ˆå¸Œå€¼çš„æŸäº›ä½ç”Ÿæˆçš„ã€‚å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªæ¡¶æ•°é‡ä¸º &lt;code>b&lt;/code> çš„ HyperLogLogã€‚æˆ‘ä»¬å°†å“ˆå¸Œå€¼çš„å‰ &lt;code>log2(b)&lt;/code> ä½ä½œä¸ºæ¡¶çš„ç´¢å¼•ï¼Œå…¶ä½™çš„ä½ç”¨äºè®¡ç®—å‰å¯¼é›¶æ•°é‡ã€‚&lt;/p>
&lt;ul>
&lt;li>ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬æœ‰ 16 ä¸ªæ¡¶ï¼ˆ&lt;code>b = 16&lt;/code>ï¼‰ï¼Œåˆ™æ¡¶çš„ç´¢å¼•ç”±å“ˆå¸Œå€¼çš„å‰ 4 ä½å†³å®šï¼ˆå› ä¸º &lt;code>log2(16) = 4&lt;/code>ï¼‰ã€‚å¦‚æœå“ˆå¸Œå€¼çš„å‰ 4 ä½ä¸º &lt;code>1100&lt;/code>ï¼Œé‚£ä¹ˆè¯¥å“ˆå¸Œå€¼å°†è¢«æ˜ å°„åˆ°ç¬¬ 12 å·æ¡¶ï¼ˆå› ä¸º &lt;code>1100&lt;/code> äºŒè¿›åˆ¶å¯¹åº” 12ï¼‰ã€‚&lt;/li>
&lt;/ul>
&lt;h5 id="4-è®¡ç®—åŸºæ•°ä¼°ç®—">&lt;strong>4. è®¡ç®—åŸºæ•°ä¼°ç®—&lt;/strong>&lt;/h5>
&lt;p>HyperLogLog ä¼šè®¡ç®—æ‰€æœ‰æ¡¶ä¸­è®°å½•çš„å‰å¯¼é›¶æœ€å¤§å€¼çš„å¹³å‡å€¼ã€‚ç„¶åæ ¹æ®è¿™ä¸ªå¹³å‡å€¼æ¥ä¼°ç®—æ•´ä¸ªæ•°æ®é›†çš„åŸºæ•°ã€‚&lt;br>
å…¶æ•°å­¦å…¬å¼å¦‚ä¸‹ï¼š&lt;/p></description></item><item><title>Linux å¤§æ–‡ä»¶ä¼ è¾“åœºæ™¯é¢˜</title><link>https://jekyulll.github.io/posts/linux-linux-%E5%A4%A7%E6%96%87%E4%BB%B6%E4%BC%A0%E8%BE%93%E5%9C%BA%E6%99%AF%E9%A2%98/</link><pubDate>Tue, 07 Jan 2025 20:05:47 +0800</pubDate><guid>https://jekyulll.github.io/posts/linux-linux-%E5%A4%A7%E6%96%87%E4%BB%B6%E4%BC%A0%E8%BE%93%E5%9C%BA%E6%99%AF%E9%A2%98/</guid><description>&lt;p>(è€ƒå¯Ÿlinuxç½‘ç»œç¼–ç¨‹ã€ç³»ç»Ÿç¼–ç¨‹ã€ç½‘ç»œåè®®ã€ç½‘ç»œä¼ è¾“åè®®ç­‰çŸ¥è¯†)&lt;/p>
&lt;blockquote>
&lt;p>é—®ï¼šå±€åŸŸç½‘å†…æœ‰Aã€Bã€Cä¸‰å°ä¸»æœºï¼ŒAä¸Bä¸çŸ¥é“ç›¸äº’ä¹‹é—´çš„IPã€‚Aè¦å‘Bä¼ è¾“ä¸€ä¸ª1Gçš„æ–‡ä»¶ï¼Œæ€ä¹ˆåšï¼Ÿ&lt;/p>
&lt;/blockquote>
&lt;hr>
&lt;ol>
&lt;li>å¤§æ–‡ä»¶ä¼ è¾“çš„ä¼˜åŒ–ï¼š&lt;/li>
&lt;/ol>
&lt;ul>
&lt;li>åˆ†å—ä¼ è¾“ï¼šå°†å¤§æ–‡ä»¶åˆ†æˆå¤šä¸ªå°å—ï¼ˆå¦‚4KBã€8KBç­‰ï¼‰ï¼Œæ¯æ¬¡ä¼ è¾“ä¸€å—ï¼Œé¿å…å ç”¨è¿‡å¤šå†…å­˜ã€‚&lt;/li>
&lt;li>æ ¡éªŒå’Œï¼ˆChecksumï¼‰ï¼šåœ¨æ¯ä¸€å—ä¼ è¾“åè¿›è¡Œæ•°æ®æ ¡éªŒï¼Œç¡®ä¿æ•°æ®çš„å®Œæ•´æ€§ã€‚&lt;/li>
&lt;li>å¸¦å®½æ§åˆ¶ï¼šé€šè¿‡æ§åˆ¶æ¯æ¬¡å‘é€çš„æ•°æ®é‡æ¥é¿å…ä¸€æ¬¡æ€§ä¼ è¾“è¿‡å¤šæ•°æ®ï¼Œæ§åˆ¶ç½‘ç»œè´Ÿè½½ã€‚&lt;/li>
&lt;/ul>
&lt;ol start="2">
&lt;li>æ–­ç‚¹ç»­ä¼ çš„å®ç°ï¼š&lt;/li>
&lt;/ol>
&lt;ul>
&lt;li>è®°å½•ä¼ è¾“è¿›åº¦ï¼šå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨éƒ½éœ€è¦è®°å½•å·²ç»æˆåŠŸä¼ è¾“çš„æ•°æ®å—æˆ–å­—èŠ‚çš„ä½ç½®ã€‚&lt;/li>
&lt;li>æ”¯æŒæ–­ç‚¹è¯·æ±‚ï¼šå®¢æˆ·ç«¯åœ¨æ¢å¤ä¼ è¾“æ—¶ï¼Œåº”è¯¥å‘ŠçŸ¥æœåŠ¡å™¨ä»å“ªä¸ªä½ç½®å¼€å§‹ä¼ è¾“ã€‚&lt;/li>
&lt;li>æ ¡éªŒå’Œå’Œç¡®è®¤æœºåˆ¶ï¼šæ¯æ¬¡ä¼ è¾“æ•°æ®å—åï¼Œéƒ½åº”è¯¥è¿›è¡Œç¡®è®¤ï¼Œç¡®ä¿æ•°æ®æ­£ç¡®ä¼ é€ã€‚&lt;/li>
&lt;/ul>
&lt;hr>
&lt;p>&lt;strong>æ­¥éª¤&lt;/strong>ï¼š&lt;/p>
&lt;ol>
&lt;li>ä½¿ç”¨å±€åŸŸç½‘å¹¿æ’­å‘ç°Bçš„IPåœ°å€
ç”±äºAå’ŒBçš„IPåœ°å€ä¸ç›´æ¥å·²çŸ¥ï¼ŒAå¯ä»¥é€šè¿‡&lt;strong>å±€åŸŸç½‘å¹¿æ’­&lt;/strong>æ¥æ‰¾åˆ°Bçš„IPåœ°å€ã€‚Aå¯ä»¥å‘ç½‘ç»œä¸­çš„æ‰€æœ‰ä¸»æœºå‘é€ä¸€ä¸ª&lt;em>UDPå¹¿æ’­æ¶ˆæ¯&lt;/em>ï¼Œæ‰€æœ‰ä¸»æœºéƒ½ä¼šæ¥æ”¶åˆ°è¿™ä¸ªæ¶ˆæ¯ï¼ŒBåœ¨æ¥æ”¶åˆ°è¿™ä¸ªå¹¿æ’­åï¼Œå¯ä»¥å›å¤Aï¼Œå‘ŠçŸ¥è‡ªå·±çš„IPåœ°å€ã€‚&lt;/li>
&lt;/ol>
&lt;ul>
&lt;li>&lt;strong>UDPå¹¿æ’­&lt;/strong>ï¼šAå¯ä»¥é€šè¿‡å‘é€ä¸€ä¸ªUDPå¹¿æ’­åŒ…åˆ°ç‰¹å®šçš„ç«¯å£ï¼Œè®©å±€åŸŸç½‘ä¸­çš„æ‰€æœ‰ä¸»æœºæ”¶åˆ°è¯¥æ¶ˆæ¯ã€‚Bå¯ä»¥é€šè¿‡ç›‘å¬è¿™ä¸ªç«¯å£ï¼Œæ”¶åˆ°æ¶ˆæ¯åå›åº”è‡ªå·±çš„IPåœ°å€ã€‚&lt;/li>
&lt;/ul>
&lt;ol>
&lt;li>ä½¿ç”¨TCPåè®®è¿›è¡Œæ–‡ä»¶ä¼ è¾“
ä¸€æ—¦Aå¾—åˆ°äº†Bçš„IPåœ°å€ï¼Œå°±å¯ä»¥ä½¿ç”¨TCPåè®®è¿›è¡Œæ–‡ä»¶ä¼ è¾“ã€‚Aé€šè¿‡TCPè¿æ¥åˆ°Bï¼Œå»ºç«‹æ•°æ®é€šé“ï¼Œå¼€å§‹å‘é€1GBçš„æ–‡ä»¶ã€‚&lt;/li>
&lt;/ol>
&lt;hr>
&lt;h3 id="1-udpå¹¿æ’­å‘ç°bçš„ipåœ°å€">1. UDPå¹¿æ’­å‘ç°Bçš„IPåœ°å€&lt;/h3>
&lt;p>Aä½¿ç”¨UDPå¹¿æ’­å‘å±€åŸŸç½‘ä¸­çš„æ‰€æœ‰ä¸»æœºå‘é€è¯·æ±‚ï¼ŒBæ”¶åˆ°è¯·æ±‚åä¼šé€šè¿‡UDPå›åº”è‡ªå·±çš„IPåœ°å€ã€‚&lt;/p>
&lt;h4 id="aç«¯å‘é€udpå¹¿æ’­è¯·æ±‚">Aç«¯ï¼šå‘é€UDPå¹¿æ’­è¯·æ±‚&lt;/h4>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;iostream&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;cstring&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;arpa/inet.h&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;unistd.h&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#define BROADCAST_PORT 12345
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">void&lt;/span> &lt;span style="color:#a6e22e">send_broadcast_message&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">int&lt;/span> sockfd;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">struct&lt;/span> &lt;span style="color:#a6e22e">sockaddr_in&lt;/span> broadcast_addr;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">int&lt;/span> broadcast_enable &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#66d9ef">char&lt;/span>&lt;span style="color:#f92672">*&lt;/span> message &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;Are you there, B? Please reply with your IP address.&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// åˆ›å»ºUDPå¥—æ¥å­—
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> sockfd &lt;span style="color:#f92672">=&lt;/span> socket(AF_INET, SOCK_DGRAM, &lt;span style="color:#ae81ff">0&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (sockfd &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> perror(&lt;span style="color:#e6db74">&amp;#34;Socket creation failed&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// å…è®¸å¹¿æ’­
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">if&lt;/span> (setsockopt(sockfd, SOL_SOCKET, SO_BROADCAST, &lt;span style="color:#f92672">&amp;amp;&lt;/span>broadcast_enable, &lt;span style="color:#66d9ef">sizeof&lt;/span>(broadcast_enable)) &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> perror(&lt;span style="color:#e6db74">&amp;#34;Setting broadcast option failed&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> close(sockfd);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> memset(&lt;span style="color:#f92672">&amp;amp;&lt;/span>broadcast_addr, &lt;span style="color:#ae81ff">0&lt;/span>, &lt;span style="color:#66d9ef">sizeof&lt;/span>(broadcast_addr));
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> broadcast_addr.sin_family &lt;span style="color:#f92672">=&lt;/span> AF_INET;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> broadcast_addr.sin_port &lt;span style="color:#f92672">=&lt;/span> htons(BROADCAST_PORT);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> broadcast_addr.sin_addr.s_addr &lt;span style="color:#f92672">=&lt;/span> htonl(INADDR_BROADCAST);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// å‘é€å¹¿æ’­æ¶ˆæ¯
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">if&lt;/span> (sendto(sockfd, message, strlen(message), &lt;span style="color:#ae81ff">0&lt;/span>, (&lt;span style="color:#66d9ef">struct&lt;/span> &lt;span style="color:#a6e22e">sockaddr&lt;/span>&lt;span style="color:#f92672">*&lt;/span>)&lt;span style="color:#f92672">&amp;amp;&lt;/span>broadcast_addr, &lt;span style="color:#66d9ef">sizeof&lt;/span>(broadcast_addr)) &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> perror(&lt;span style="color:#e6db74">&amp;#34;Broadcast failed&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> close(sockfd);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> std&lt;span style="color:#f92672">::&lt;/span>cout &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> &lt;span style="color:#e6db74">&amp;#34;Broadcast message sent!&amp;#34;&lt;/span> &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> std&lt;span style="color:#f92672">::&lt;/span>endl;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> close(sockfd);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">int&lt;/span> &lt;span style="color:#a6e22e">main&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> send_broadcast_message();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h4 id="bç«¯æ¥æ”¶udpå¹¿æ’­å¹¶å›åº”è‡ªå·±çš„ip">Bç«¯ï¼šæ¥æ”¶UDPå¹¿æ’­å¹¶å›åº”è‡ªå·±çš„IP&lt;/h4>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;iostream&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;cstring&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;arpa/inet.h&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;unistd.h&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#define BROADCAST_PORT 12345
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#define RESPONSE_PORT 12346
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">void&lt;/span> &lt;span style="color:#a6e22e">listen_for_broadcasts&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">int&lt;/span> sockfd;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">struct&lt;/span> &lt;span style="color:#a6e22e">sockaddr_in&lt;/span> server_addr, client_addr;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> socklen_t client_len &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">sizeof&lt;/span>(client_addr);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">char&lt;/span> buffer[&lt;span style="color:#ae81ff">1024&lt;/span>];
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// åˆ›å»ºUDPå¥—æ¥å­—
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> sockfd &lt;span style="color:#f92672">=&lt;/span> socket(AF_INET, SOCK_DGRAM, &lt;span style="color:#ae81ff">0&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (sockfd &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> perror(&lt;span style="color:#e6db74">&amp;#34;Socket creation failed&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> memset(&lt;span style="color:#f92672">&amp;amp;&lt;/span>server_addr, &lt;span style="color:#ae81ff">0&lt;/span>, &lt;span style="color:#66d9ef">sizeof&lt;/span>(server_addr));
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> server_addr.sin_family &lt;span style="color:#f92672">=&lt;/span> AF_INET;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> server_addr.sin_port &lt;span style="color:#f92672">=&lt;/span> htons(BROADCAST_PORT);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> server_addr.sin_addr.s_addr &lt;span style="color:#f92672">=&lt;/span> htonl(INADDR_ANY);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// ç»‘å®šUDPå¥—æ¥å­—
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">if&lt;/span> (bind(sockfd, (&lt;span style="color:#66d9ef">struct&lt;/span> &lt;span style="color:#a6e22e">sockaddr&lt;/span>&lt;span style="color:#f92672">*&lt;/span>)&lt;span style="color:#f92672">&amp;amp;&lt;/span>server_addr, &lt;span style="color:#66d9ef">sizeof&lt;/span>(server_addr)) &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> perror(&lt;span style="color:#e6db74">&amp;#34;Bind failed&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> close(sockfd);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// æ¥æ”¶å¹¿æ’­æ¶ˆæ¯
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">while&lt;/span> (true) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">int&lt;/span> recv_len &lt;span style="color:#f92672">=&lt;/span> recvfrom(sockfd, buffer, &lt;span style="color:#66d9ef">sizeof&lt;/span>(buffer), &lt;span style="color:#ae81ff">0&lt;/span>, (&lt;span style="color:#66d9ef">struct&lt;/span> &lt;span style="color:#a6e22e">sockaddr&lt;/span>&lt;span style="color:#f92672">*&lt;/span>)&lt;span style="color:#f92672">&amp;amp;&lt;/span>client_addr, &lt;span style="color:#f92672">&amp;amp;&lt;/span>client_len);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (recv_len &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> perror(&lt;span style="color:#e6db74">&amp;#34;Failed to receive message&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">continue&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> buffer[recv_len] &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#39;\0&amp;#39;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> std&lt;span style="color:#f92672">::&lt;/span>cout &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> &lt;span style="color:#e6db74">&amp;#34;Received message: &amp;#34;&lt;/span> &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> buffer &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> std&lt;span style="color:#f92672">::&lt;/span>endl;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// å¦‚æœæ¶ˆæ¯åŒ…å«ç‰¹å®šè¯·æ±‚ï¼Œå¯ä»¥å›å¤è‡ªå·±çš„IPåœ°å€
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> std&lt;span style="color:#f92672">::&lt;/span>string response &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;IP Address of B: &amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> response &lt;span style="color:#f92672">+=&lt;/span> inet_ntoa(client_addr.sin_addr);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> sendto(sockfd, response.c_str(), response.length(), &lt;span style="color:#ae81ff">0&lt;/span>, (&lt;span style="color:#66d9ef">struct&lt;/span> &lt;span style="color:#a6e22e">sockaddr&lt;/span>&lt;span style="color:#f92672">*&lt;/span>)&lt;span style="color:#f92672">&amp;amp;&lt;/span>client_addr, client_len);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> std&lt;span style="color:#f92672">::&lt;/span>cout &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> &lt;span style="color:#e6db74">&amp;#34;Sent response with IP address: &amp;#34;&lt;/span> &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> inet_ntoa(client_addr.sin_addr) &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> std&lt;span style="color:#f92672">::&lt;/span>endl;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> close(sockfd);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">int&lt;/span> &lt;span style="color:#a6e22e">main&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> listen_for_broadcasts();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="2-ä½¿ç”¨tcpåè®®ä¼ è¾“æ–‡ä»¶">2. ä½¿ç”¨TCPåè®®ä¼ è¾“æ–‡ä»¶&lt;/h3>
&lt;p>ä¸€æ—¦Aå¾—åˆ°äº†Bçš„IPåœ°å€ï¼ŒAå°±å¯ä»¥é€šè¿‡TCPè¿æ¥ä¸Bè¿›è¡Œæ–‡ä»¶ä¼ è¾“ã€‚&lt;/p></description></item><item><title>åˆ†æ®µé”æŠ€æœ¯è¯¦è§£åŠ C++ å®ç°</title><link>https://jekyulll.github.io/posts/cpp-%E5%88%86%E6%AE%B5%E9%94%81%E6%8A%80%E6%9C%AF%E8%AF%A6%E8%A7%A3%E5%8F%8A-c++-%E5%AE%9E%E7%8E%B0/</link><pubDate>Wed, 01 Jan 2025 14:05:47 +0800</pubDate><guid>https://jekyulll.github.io/posts/cpp-%E5%88%86%E6%AE%B5%E9%94%81%E6%8A%80%E6%9C%AF%E8%AF%A6%E8%A7%A3%E5%8F%8A-c++-%E5%AE%9E%E7%8E%B0/</guid><description>&lt;p>åˆ†æ®µé”ï¼ˆSegmented Lockingï¼‰æ˜¯ä¸€ç§ç”¨äºä¼˜åŒ–å¤šçº¿ç¨‹è®¿é—®å…±äº«èµ„æºæ—¶é”ç²’åº¦çš„æŠ€æœ¯ã€‚å®ƒé€šè¿‡å°†èµ„æºåˆ†æˆå¤šä¸ªå°æ®µï¼Œå¹¶ä¸ºæ¯æ®µåˆ†é…ç‹¬ç«‹çš„é”ï¼Œæ¥å‡å°‘é”çš„äº‰ç”¨ï¼Œä»è€Œæå‡å¹¶å‘æ€§èƒ½ã€‚&lt;/p>
&lt;p>åˆ†æ®µé”é€šè¿‡å‡å°‘é”ç²’åº¦ï¼Œè®©å¤šä¸ªçº¿ç¨‹å¯ä»¥åŒæ—¶è®¿é—®ä¸åŒçš„æ®µï¼Œä»è€Œæ˜¾è‘—æé«˜æ€§èƒ½ã€‚è¿™ç§æ–¹æ³•å¸¸è§äº &lt;strong>å“ˆå¸Œè¡¨&lt;/strong>ã€&lt;strong>æ•°æ®åº“ç´¢å¼•&lt;/strong> å’Œå…¶ä»–é«˜å¹¶å‘ç³»ç»Ÿä¸­ã€‚&lt;/p>
&lt;hr>
&lt;h4 id="åŸºæœ¬åŸç†">&lt;strong>åŸºæœ¬åŸç†&lt;/strong>&lt;/h4>
&lt;ol>
&lt;li>
&lt;p>&lt;strong>åˆ’åˆ†èµ„æº&lt;/strong>ï¼š
å°†å®¹å™¨åˆ’åˆ†ä¸ºå¤šä¸ªç‹¬ç«‹çš„æ®µï¼ˆ&lt;code>segment&lt;/code>ï¼‰ï¼Œæ¯æ®µå¯ä»¥åŒ…å«ä¸€éƒ¨åˆ†æ•°æ®ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªå“ˆå¸Œè¡¨å¯ä»¥æŒ‰å“ˆå¸Œå€¼å°†æ•°æ®åˆ†é…åˆ°å¤šä¸ªæ¡¶ï¼ˆ&lt;code>bucket&lt;/code>ï¼‰ï¼Œæ¯ä¸ªæ¡¶ä»£è¡¨ä¸€ä¸ªæ®µã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>ç‹¬ç«‹åŠ é”&lt;/strong>ï¼š
æ¯ä¸ªæ®µéƒ½æœ‰ä¸€ä¸ªç‹¬ç«‹çš„é”ï¼ˆå¦‚ &lt;code>std::mutex&lt;/code> æˆ– &lt;code>std::shared_mutex&lt;/code>ï¼‰ï¼Œå¯¹è¯¥æ®µçš„æ•°æ®æ“ä½œæ—¶ï¼Œåªéœ€è¦é”å®šå¯¹åº”çš„æ®µå³å¯ï¼Œå…¶ä»–æ®µä¸å—å½±å“ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>æ˜ å°„è§„åˆ™&lt;/strong>ï¼š
é€šè¿‡æŸç§æ˜ å°„è§„åˆ™ï¼ˆå¦‚å“ˆå¸Œå‡½æ•°ï¼‰å°†æ“ä½œå®šä½åˆ°ç‰¹å®šçš„æ®µã€‚è¿™ç§æ˜ å°„è§„åˆ™åº”å°½å¯èƒ½å‡åŒ€ï¼Œä»¥é¿å…&lt;em>çƒ­ç‚¹é—®é¢˜&lt;/em>ï¼ˆå³æŸäº›æ®µè¿‡äºé¢‘ç¹è¢«è®¿é—®ï¼Œå¯¼è‡´é”ç«äº‰ï¼‰ã€‚&lt;/p>
&lt;/li>
&lt;/ol>
&lt;hr>
&lt;h4 id="é€‚ç”¨åœºæ™¯">&lt;strong>é€‚ç”¨åœºæ™¯&lt;/strong>&lt;/h4>
&lt;ul>
&lt;li>&lt;strong>é«˜å¹¶å‘è¯»å†™&lt;/strong>ï¼šå¦‚å¤šçº¿ç¨‹è®¿é—®çš„å¤§å‹å“ˆå¸Œè¡¨ã€æ•°æ®åº“ç´¢å¼•ã€‚&lt;/li>
&lt;li>&lt;strong>çƒ­ç‚¹æ•°æ®åˆ†æ•£&lt;/strong>ï¼šé€šè¿‡åˆ†æ®µå‡å°‘å•ç‚¹é”çš„äº‰ç”¨ï¼Œæå‡æ€§èƒ½ã€‚&lt;/li>
&lt;li>&lt;strong>è¯»å¤šå†™å°‘&lt;/strong>ï¼šå¯ä»¥ç»“åˆ &lt;code>std::shared_mutex&lt;/code> æä¾›å…±äº«é”å’Œç‹¬å é”ï¼Œè¿›ä¸€æ­¥ä¼˜åŒ–è¯»æ€§èƒ½ã€‚&lt;/li>
&lt;/ul>
&lt;p>æ³¨ï¼š&lt;strong>è´Ÿè½½ä¸å‡é£é™©&lt;/strong>ï¼šå¦‚æœæ˜ å°„è§„åˆ™ä¸åˆç†ï¼Œå¯èƒ½å¯¼è‡´æŸäº›æ®µæˆä¸ºçƒ­ç‚¹(eg. çƒ­ç‚¹æ¡¶)ï¼Œå½±å“æ€§èƒ½ã€‚&lt;/p>
&lt;hr>
&lt;p>ä¸‹é¢é€šè¿‡ä¸€ä¸ªçº¿ç¨‹å®‰å…¨çš„å“ˆå¸Œè¡¨ï¼ˆ&lt;code>ThreadSafeHashMap&lt;/code>ï¼‰æ¥å±•ç¤ºåˆ†æ®µé”çš„å®ç°(ç”¨&lt;code>std::vector&lt;/code>ç®€å•æ¨¡æ‹Ÿ)ã€‚&lt;/p>
&lt;ol>
&lt;li>å°†å“ˆå¸Œè¡¨åˆ†ä¸ºå¤šä¸ªæ¡¶ï¼ˆ&lt;code>bucket&lt;/code>ï¼‰ï¼Œæ¯ä¸ªæ¡¶ç‹¬ç«‹ç®¡ç†å…¶æ•°æ®ã€‚&lt;/li>
&lt;li>ä½¿ç”¨å“ˆå¸Œå‡½æ•°å°†é”®æ˜ å°„åˆ°å¯¹åº”çš„æ¡¶ã€‚&lt;/li>
&lt;li>ä¸ºæ¯ä¸ªæ¡¶åˆ†é…ä¸€ä¸ª &lt;code>std::mutex&lt;/code> æ¥ä¿æŠ¤æ•°æ®ã€‚&lt;/li>
&lt;li>å¯¹äºè¯»æ“ä½œï¼Œåªé”å®šå¯¹åº”çš„æ¡¶ï¼Œæ”¯æŒå¹¶è¡Œè¯»å–ã€‚&lt;/li>
&lt;li>å¯¹äºå†™æ“ä½œï¼Œä¹Ÿåªé”å®šå¯¹åº”çš„æ¡¶ï¼Œå‡å°‘é”çš„èŒƒå›´ã€‚&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;iostream&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;vector&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;mutex&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;shared_mutex&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;thread&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#include&lt;/span> &lt;span style="color:#75715e">&amp;lt;functional&amp;gt;&lt;/span>&lt;span style="color:#75715e">
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">template&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#66d9ef">typename&lt;/span> Key, &lt;span style="color:#66d9ef">typename&lt;/span> Value&lt;span style="color:#f92672">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">class&lt;/span> &lt;span style="color:#a6e22e">ThreadSafeHashMap&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">private&lt;/span>&lt;span style="color:#f92672">:&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">struct&lt;/span> &lt;span style="color:#a6e22e">Bucket&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> std&lt;span style="color:#f92672">::&lt;/span>shared_mutex mtx; &lt;span style="color:#75715e">// æ¯ä¸ªæ¡¶çš„ç‹¬ç«‹é”
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> std&lt;span style="color:#f92672">::&lt;/span>vector&lt;span style="color:#f92672">&amp;lt;&lt;/span>std&lt;span style="color:#f92672">::&lt;/span>pair&lt;span style="color:#f92672">&amp;lt;&lt;/span>Key, Value&lt;span style="color:#f92672">&amp;gt;&amp;gt;&lt;/span> data;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> };
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> std&lt;span style="color:#f92672">::&lt;/span>vector&lt;span style="color:#f92672">&amp;lt;&lt;/span>Bucket&lt;span style="color:#f92672">&amp;gt;&lt;/span> buckets;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> size_t num_buckets;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// å“ˆå¸Œå‡½æ•°ï¼Œå°†é”®æ˜ å°„åˆ°å¯¹åº”çš„æ¡¶
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> size_t &lt;span style="color:#a6e22e">hash&lt;/span>(&lt;span style="color:#66d9ef">const&lt;/span> Key&lt;span style="color:#f92672">&amp;amp;&lt;/span> key) &lt;span style="color:#66d9ef">const&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> std&lt;span style="color:#f92672">::&lt;/span>hash&lt;span style="color:#f92672">&amp;lt;&lt;/span>Key&lt;span style="color:#f92672">&amp;gt;&lt;/span>{}(key) &lt;span style="color:#f92672">%&lt;/span> num_buckets;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">public&lt;/span>&lt;span style="color:#f92672">:&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ThreadSafeHashMap(size_t num_buckets &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">16&lt;/span>) &lt;span style="color:#f92672">:&lt;/span> num_buckets(num_buckets) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> buckets.resize(num_buckets);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// æ’å…¥æ“ä½œï¼ŒæŒ‰æ¡¶åˆ†æ®µåŠ é”
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">void&lt;/span> &lt;span style="color:#a6e22e">insert&lt;/span>(&lt;span style="color:#66d9ef">const&lt;/span> Key&lt;span style="color:#f92672">&amp;amp;&lt;/span> key, &lt;span style="color:#66d9ef">const&lt;/span> Value&lt;span style="color:#f92672">&amp;amp;&lt;/span> value) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> size_t index &lt;span style="color:#f92672">=&lt;/span> hash(key);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> std&lt;span style="color:#f92672">::&lt;/span>unique_lock&lt;span style="color:#f92672">&amp;lt;&lt;/span>std&lt;span style="color:#f92672">::&lt;/span>shared_mutex&lt;span style="color:#f92672">&amp;gt;&lt;/span> lock(buckets[index].mtx);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> buckets[index].data.push_back({key, value});
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// æŸ¥æ‰¾æ“ä½œï¼ŒæŒ‰æ¡¶åˆ†æ®µåŠ é”
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">bool&lt;/span> &lt;span style="color:#a6e22e">find&lt;/span>(&lt;span style="color:#66d9ef">const&lt;/span> Key&lt;span style="color:#f92672">&amp;amp;&lt;/span> key, Value&lt;span style="color:#f92672">&amp;amp;&lt;/span> value) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> size_t index &lt;span style="color:#f92672">=&lt;/span> hash(key);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> std&lt;span style="color:#f92672">::&lt;/span>shared_lock&lt;span style="color:#f92672">&amp;lt;&lt;/span>std&lt;span style="color:#f92672">::&lt;/span>shared_mutex&lt;span style="color:#f92672">&amp;gt;&lt;/span> lock(buckets[index].mtx);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">for&lt;/span> (&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#66d9ef">auto&lt;/span>&lt;span style="color:#f92672">&amp;amp;&lt;/span> pair : buckets[index].data) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (pair.first &lt;span style="color:#f92672">==&lt;/span> key) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> value &lt;span style="color:#f92672">=&lt;/span> pair.second;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> true;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> false;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// åˆ é™¤æ“ä½œï¼ŒæŒ‰æ¡¶åˆ†æ®µåŠ é”
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">bool&lt;/span> &lt;span style="color:#a6e22e">erase&lt;/span>(&lt;span style="color:#66d9ef">const&lt;/span> Key&lt;span style="color:#f92672">&amp;amp;&lt;/span> key) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> size_t index &lt;span style="color:#f92672">=&lt;/span> hash(key);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> std&lt;span style="color:#f92672">::&lt;/span>unique_lock&lt;span style="color:#f92672">&amp;lt;&lt;/span>std&lt;span style="color:#f92672">::&lt;/span>shared_mutex&lt;span style="color:#f92672">&amp;gt;&lt;/span> lock(buckets[index].mtx);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">auto&lt;/span>&lt;span style="color:#f92672">&amp;amp;&lt;/span> bucket &lt;span style="color:#f92672">=&lt;/span> buckets[index].data;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">for&lt;/span> (&lt;span style="color:#66d9ef">auto&lt;/span> it &lt;span style="color:#f92672">=&lt;/span> bucket.begin(); it &lt;span style="color:#f92672">!=&lt;/span> bucket.end(); &lt;span style="color:#f92672">++&lt;/span>it) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (it&lt;span style="color:#f92672">-&amp;gt;&lt;/span>first &lt;span style="color:#f92672">==&lt;/span> key) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> bucket.erase(it);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> true;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> false;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">int&lt;/span> &lt;span style="color:#a6e22e">main&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ThreadSafeHashMap&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#66d9ef">int&lt;/span>, std&lt;span style="color:#f92672">::&lt;/span>string&lt;span style="color:#f92672">&amp;gt;&lt;/span> map;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// å¤šçº¿ç¨‹æ’å…¥æ•°æ®
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> std&lt;span style="color:#f92672">::&lt;/span>&lt;span style="color:#66d9ef">thread&lt;/span> t1([&lt;span style="color:#f92672">&amp;amp;&lt;/span>]() { map.insert(&lt;span style="color:#ae81ff">1&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;one&amp;#34;&lt;/span>); });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> std&lt;span style="color:#f92672">::&lt;/span>&lt;span style="color:#66d9ef">thread&lt;/span> t2([&lt;span style="color:#f92672">&amp;amp;&lt;/span>]() { map.insert(&lt;span style="color:#ae81ff">2&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;two&amp;#34;&lt;/span>); });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> std&lt;span style="color:#f92672">::&lt;/span>&lt;span style="color:#66d9ef">thread&lt;/span> t3([&lt;span style="color:#f92672">&amp;amp;&lt;/span>]() { map.insert(&lt;span style="color:#ae81ff">3&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;three&amp;#34;&lt;/span>); });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> t1.join();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> t2.join();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> t3.join();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// æŸ¥æ‰¾æ•°æ®
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> std&lt;span style="color:#f92672">::&lt;/span>string value;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (map.find(&lt;span style="color:#ae81ff">2&lt;/span>, value)) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> std&lt;span style="color:#f92672">::&lt;/span>cout &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> &lt;span style="color:#e6db74">&amp;#34;Found: &amp;#34;&lt;/span> &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> value &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> std&lt;span style="color:#f92672">::&lt;/span>endl;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// åˆ é™¤æ•°æ®
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> map.erase(&lt;span style="color:#ae81ff">2&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>åƒ &lt;a href="https://github.com/uxlfoundation/oneTBB">Intel TBB&lt;/a> ç­‰å¹¶å‘åº“æä¾›äº†æ›´åŠ é«˜æ•ˆçš„çº¿ç¨‹å®‰å…¨å®¹å™¨ã€‚&lt;/p></description></item><item><title>ç®€è¿°å¦‚ä½•è§£å†³å“ˆå¸Œå†²çªï¼Ÿ</title><link>https://jekyulll.github.io/posts/cpp-%E5%A6%82%E4%BD%95%E8%A7%A3%E5%86%B3%E5%93%88%E5%B8%8C%E5%86%B2%E7%AA%81/</link><pubDate>Wed, 01 Jan 2025 12:05:47 +0800</pubDate><guid>https://jekyulll.github.io/posts/cpp-%E5%A6%82%E4%BD%95%E8%A7%A3%E5%86%B3%E5%93%88%E5%B8%8C%E5%86%B2%E7%AA%81/</guid><description>&lt;blockquote>
&lt;p>å“ˆå¸Œå†²çªæ˜¯æŒ‡ &lt;strong>ä¸åŒçš„è¾“å…¥&lt;/strong>ï¼ˆé€šå¸¸æ˜¯ä¸åŒçš„é”®ï¼‰é€šè¿‡å“ˆå¸Œå‡½æ•°è®¡ç®—åï¼Œå¾—åˆ°ç›¸åŒçš„å“ˆå¸Œå€¼å¹¶è¢«æ˜ å°„åˆ°ç›¸åŒçš„æ¡¶æˆ–ä½ç½®ã€‚è¿™æ˜¯å“ˆå¸Œç®—æ³•çš„ä¸€ä¸ªå›ºæœ‰é—®é¢˜ï¼Œé€šå¸¸å‘ç”Ÿåœ¨å“ˆå¸Œè¡¨ä¸­ã€‚&lt;/p>
&lt;/blockquote>
&lt;hr>
&lt;h4 id="ä¸ºä»€ä¹ˆä¼šæœ‰å“ˆå¸Œå†²çª">&lt;strong>ä¸ºä»€ä¹ˆä¼šæœ‰å“ˆå¸Œå†²çªï¼Ÿ&lt;/strong>&lt;/h4>
&lt;ol>
&lt;li>
&lt;p>&lt;strong>æœ‰é™çš„å“ˆå¸Œç©ºé—´&lt;/strong>ï¼š&lt;br>
å‡è®¾å“ˆå¸Œå‡½æ•°å°†é”®æ˜ å°„åˆ°ä¸€ä¸ªå›ºå®šå¤§å°çš„æ•°ç»„ä¸­ï¼Œå“ˆå¸Œè¡¨çš„æ¡¶æ•°æœ‰é™ï¼Œè€Œé”®çš„æ•°é‡å¯èƒ½å¾ˆå¤§ï¼ˆä¾‹å¦‚ç™¾ä¸‡ä¸ªä¸åŒçš„é”®ï¼‰ï¼Œé‚£ä¹ˆæ— è®ºå“ˆå¸Œå‡½æ•°è®¾è®¡å¾—å¤šä¹ˆå·§å¦™ï¼Œéƒ½å¯èƒ½æœ‰å¤šä¸ªé”®æ˜ å°„åˆ°åŒä¸€ä¸ªæ¡¶ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>å“ˆå¸Œå‡½æ•°çš„ç¢°æ’&lt;/strong>ï¼š&lt;br>
å“ˆå¸Œå‡½æ•°çš„è®¾è®¡å†³å®šäº†å¦‚ä½•å°†é”®æ˜ å°„åˆ°å“ˆå¸Œè¡¨çš„æ¡¶ä¸­ã€‚å¦‚æœå“ˆå¸Œå‡½æ•°ä¸è¶³å¤Ÿâ€œåˆ†æ•£â€é”®å€¼ï¼Œå¯¼è‡´å¤šä¸ªé”®çš„å“ˆå¸Œå€¼ç›¸åŒï¼Œå°±ä¼šäº§ç”Ÿå†²çªã€‚å³ä½¿ä¸¤ä¸ªé”®çš„å®é™…å€¼ä¸åŒï¼Œå®ƒä»¬ä¹Ÿå¯èƒ½å› ä¸ºå“ˆå¸Œå‡½æ•°çš„é™åˆ¶è€Œå¾—åˆ°ç›¸åŒçš„å“ˆå¸Œå€¼ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>é”®çš„åˆ†å¸ƒä¸å‡åŒ€&lt;/strong>ï¼š&lt;br>
å¦‚æœæ•°æ®ï¼ˆå³é”®ï¼‰åœ¨å“ˆå¸Œè¡¨ä¸­çš„åˆ†å¸ƒä¸å‡åŒ€ï¼ŒæŸäº›æ¡¶å¯èƒ½ä¼šæœ‰å¤§é‡çš„é”®ï¼Œè€Œå…¶ä»–æ¡¶åˆ™å‡ ä¹æ²¡æœ‰ã€‚è¿™é€šå¸¸æ˜¯ç”±äºé€‰æ‹©çš„å“ˆå¸Œå‡½æ•°æ— æ³•å‡åŒ€åœ°åˆ†å¸ƒé”®å€¼ï¼Œå¯¼è‡´å“ˆå¸Œå†²çªåœ¨æŸäº›æ¡¶ä¸­æ›´åŠ é›†ä¸­ã€‚&lt;/p>
&lt;/li>
&lt;/ol>
&lt;p>å“ˆå¸Œå†²çªçš„å‘ç”Ÿæ˜¯ä¸å¯é¿å…çš„ï¼Œå› ä¸ºï¼š&lt;/p>
&lt;ul>
&lt;li>
&lt;p>&lt;strong>æœ‰é™çš„è¾“å‡ºç©ºé—´&lt;/strong>ï¼š
å“ˆå¸Œå‡½æ•°çš„è¾“å‡ºé€šå¸¸æ˜¯å›ºå®šé•¿åº¦çš„ï¼ˆæ¯”å¦‚ 32 ä½ã€64 ä½æˆ–æ›´é«˜ï¼‰ï¼Œè€Œå®é™…çš„è¾“å…¥æ•°æ®å¯ä»¥éå¸¸åºå¤§ã€‚ä¾‹å¦‚ï¼Œè¾“å…¥å¯èƒ½æ˜¯æ‰€æœ‰çš„æ•´æ•°ã€å­—ç¬¦ä¸²æˆ–è€…æ›´å¤æ‚çš„æ•°æ®ç»“æ„ï¼Œæ•°é‡è¿œè¿œè¶…è¿‡äº†å“ˆå¸Œå€¼çš„ç§ç±»ã€‚å› æ­¤ï¼Œæ€»ä¼šæœ‰ä¸¤ä¸ªä¸åŒçš„è¾“å…¥æ•°æ®è¢«æ˜ å°„åˆ°ç›¸åŒçš„å“ˆå¸Œå€¼ï¼ˆå³å“ˆå¸Œå†²çªï¼‰ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>æŠ½è±¡æ•°æ®ç±»å‹&lt;/strong>ï¼š
å¯¹äºå¤æ‚çš„æ•°æ®ç±»å‹ï¼ˆå¦‚å¯¹è±¡ã€ç»“æ„ä½“ã€å­—ç¬¦ä¸²ç­‰ï¼‰ï¼Œè®¾è®¡ä¸€ä¸ªå®Œç¾çš„å“ˆå¸Œå‡½æ•°æ˜¯éå¸¸å›°éš¾çš„ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå³ä½¿è®¾è®¡äº†é«˜æ•ˆçš„å“ˆå¸Œç®—æ³•ï¼Œä¹Ÿå¾ˆéš¾ä¿è¯å“ˆå¸Œå€¼çš„å®Œå…¨å‡åŒ€åˆ†å¸ƒï¼Œå› æ­¤å†²çªä¸å¯é¿å…ã€‚&lt;/p>
&lt;/li>
&lt;/ul>
&lt;hr>
&lt;h3 id="å¦‚ä½•å¤„ç†å“ˆå¸Œå†²çª">&lt;strong>å¦‚ä½•å¤„ç†å“ˆå¸Œå†²çªï¼Ÿ&lt;/strong>&lt;/h3>
&lt;p>å°½ç®¡å“ˆå¸Œå†²çªä¸å¯é¿å…ï¼Œä½†æˆ‘ä»¬å¯ä»¥é‡‡ç”¨å¤šç§æ–¹æ³•æ¥è§£å†³æˆ–å‡å°‘å†²çªçš„å½±å“ï¼š&lt;/p>
&lt;h4 id="1-é“¾è¡¨æ³•separate-chaining">1. &lt;strong>é“¾è¡¨æ³•ï¼ˆSeparate Chainingï¼‰&lt;/strong>&lt;/h4>
&lt;p>æ¯ä¸ªæ¡¶ï¼ˆå“ˆå¸Œè¡¨çš„ä¸€ä¸ªä½ç½®ï¼‰å­˜å‚¨ä¸€ä¸ªé“¾è¡¨ï¼Œæ‰€æœ‰æ˜ å°„åˆ°ç›¸åŒå“ˆå¸Œå€¼çš„å…ƒç´ éƒ½æ”¾åœ¨è¿™ä¸ªé“¾è¡¨ä¸­ã€‚è™½ç„¶å“ˆå¸Œå†²çªå‘ç”Ÿï¼Œä½†å¯ä»¥é€šè¿‡éå†é“¾è¡¨æ¥è§£å†³ã€‚&lt;/p>
&lt;ul>
&lt;li>&lt;strong>ä¼˜ç‚¹&lt;/strong>ï¼šç®€å•æ˜“æ‡‚ï¼Œé€‚ç”¨äºåŠ¨æ€æ‰©å®¹ã€‚&lt;/li>
&lt;li>&lt;strong>ç¼ºç‚¹&lt;/strong>ï¼šæ€§èƒ½å–å†³äºé“¾è¡¨çš„é•¿åº¦ï¼Œå¦‚æœé“¾è¡¨è¾ƒé•¿ï¼ŒæŸ¥æ‰¾ã€æ’å…¥ã€åˆ é™¤çš„æ—¶é—´å¤æ‚åº¦ä¼šé€€åŒ–ä¸º &lt;code>O(n)&lt;/code>ã€‚&lt;/li>
&lt;/ul>
&lt;h4 id="2-å¼€æ”¾åœ°å€æ³•open-addressing">2. &lt;strong>å¼€æ”¾åœ°å€æ³•ï¼ˆOpen Addressingï¼‰&lt;/strong>&lt;/h4>
&lt;p>åœ¨è¿™ç§æ–¹æ³•ä¸­ï¼Œå½“å“ˆå¸Œå†²çªå‘ç”Ÿæ—¶ï¼Œç¨‹åºä¼šå°è¯•åœ¨è¡¨ä¸­å¯»æ‰¾å¦ä¸€ä¸ªç©ºçš„ä½ç½®æ¥å­˜å‚¨æ•°æ®ã€‚å¸¸è§çš„è§£å†³æ–¹å¼åŒ…æ‹¬ï¼š&lt;/p>
&lt;ul>
&lt;li>
&lt;p>&lt;strong>çº¿æ€§æ¢æµ‹&lt;/strong>ï¼šæ£€æŸ¥å½“å‰ä½ç½®ä¹‹åçš„ä¸‹ä¸€ä¸ªä½ç½®ï¼Œç›´åˆ°æ‰¾åˆ°ç©ºä½ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>äºŒæ¬¡æ¢æµ‹&lt;/strong>ï¼šå°è¯•æ£€æŸ¥å½“å‰ä½ç½®ä¹‹åçš„å¹³æ–¹è·ç¦»çš„å…¶ä»–ä½ç½®ï¼Œé¿å…çº¿æ€§æ¢æµ‹ä¸­å¯èƒ½å‡ºç°çš„èšé›†é—®é¢˜ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>åŒé‡å“ˆå¸Œ&lt;/strong>ï¼šä½¿ç”¨ç¬¬äºŒä¸ªå“ˆå¸Œå‡½æ•°æ¥å†³å®šæ¢æµ‹çš„æ­¥é•¿ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>ä¼˜ç‚¹&lt;/strong>ï¼šé¿å…äº†é“¾è¡¨æ³•çš„é¢å¤–å†…å­˜å¼€é”€ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>ç¼ºç‚¹&lt;/strong>ï¼šå½“å“ˆå¸Œè¡¨è£…è½½è¿‡é«˜æ—¶ï¼ŒæŸ¥æ‰¾æ•ˆç‡ä¼šä¸‹é™ã€‚&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h4 id="3-å†å“ˆå¸Œrehashing">3. &lt;strong>å†å“ˆå¸Œï¼ˆRehashingï¼‰&lt;/strong>&lt;/h4>
&lt;p>å†å“ˆå¸Œæ˜¯é€šè¿‡æ‰©å±•å“ˆå¸Œè¡¨çš„å¤§å°å¹¶é‡æ–°è®¡ç®—æ¯ä¸ªå…ƒç´ çš„å“ˆå¸Œå€¼æ¥è§£å†³å†²çªã€‚å½“å“ˆå¸Œè¡¨è£…è½½å› å­è¿‡é«˜æ—¶ï¼ˆå³å…ƒç´ æ•°é‡æ¥è¿‘æ¡¶çš„æ•°é‡ï¼‰ï¼Œä¼šè§¦å‘å†å“ˆå¸Œè¿‡ç¨‹ã€‚&lt;/p>
&lt;ul>
&lt;li>&lt;strong>ä¼˜ç‚¹&lt;/strong>ï¼šèƒ½å¤Ÿæœ‰æ•ˆå‡å°‘å†²çªï¼Œæé«˜æ€§èƒ½ã€‚&lt;/li>
&lt;li>&lt;strong>ç¼ºç‚¹&lt;/strong>ï¼šå†å“ˆå¸Œæ—¶ä¼šæ¶‰åŠåˆ°å¤§é‡çš„é‡æ–°è®¡ç®—å’Œå†…å­˜åˆ†é…ï¼Œå¯èƒ½å¯¼è‡´æ€§èƒ½ä¸‹é™ã€‚&lt;/li>
&lt;/ul>
&lt;h4 id="4-ä½¿ç”¨å¹³è¡¡æ ‘å¦‚çº¢é»‘æ ‘">4. &lt;strong>ä½¿ç”¨å¹³è¡¡æ ‘ï¼ˆå¦‚çº¢é»‘æ ‘ï¼‰&lt;/strong>&lt;/h4>
&lt;p>åœ¨å“ˆå¸Œè¡¨ä¸­ï¼Œå¦‚æœæŸä¸ªæ¡¶çš„å†²çªè¿‡å¤šï¼Œå¯ä»¥ä½¿ç”¨çº¢é»‘æ ‘ï¼ˆæˆ–è€…å…¶ä»–å¹³è¡¡äºŒå‰æ ‘ï¼‰æ¥å­˜å‚¨å†²çªçš„å…ƒç´ ï¼Œè¿™æ ·å¯ä»¥åœ¨æ¯ä¸ªæ¡¶å†…ä¿æŒè¾ƒå¥½çš„æŸ¥æ‰¾ã€æ’å…¥æ€§èƒ½ã€‚çº¢é»‘æ ‘çš„æŸ¥æ‰¾ã€æ’å…¥ã€åˆ é™¤æ—¶é—´å¤æ‚åº¦ä¸º &lt;code>O(log N)&lt;/code>ã€‚&lt;/p>
&lt;ul>
&lt;li>&lt;strong>ä¼˜ç‚¹&lt;/strong>ï¼šæ¯”é“¾è¡¨æ³•æ›´é«˜æ•ˆï¼Œèƒ½å¤Ÿæä¾›å¯¹æ•°æ—¶é—´çš„æ“ä½œã€‚&lt;/li>
&lt;li>&lt;strong>ç¼ºç‚¹&lt;/strong>ï¼šç›¸æ¯”é“¾è¡¨æ³•ï¼Œç»´æŠ¤å¹³è¡¡æ ‘éœ€è¦æ›´å¤šçš„æ—¶é—´å’Œå†…å­˜ã€‚&lt;/li>
&lt;/ul></description></item><item><title>C++ ç¼–è¯‘å™¨è¿”å›å€¼ä¼˜åŒ–</title><link>https://jekyulll.github.io/posts/cpp-c++-%E7%BC%96%E8%AF%91%E5%99%A8%E8%BF%94%E5%9B%9E%E5%80%BC%E4%BC%98%E5%8C%96/</link><pubDate>Mon, 23 Dec 2024 08:42:29 +0800</pubDate><guid>https://jekyulll.github.io/posts/cpp-c++-%E7%BC%96%E8%AF%91%E5%99%A8%E8%BF%94%E5%9B%9E%E5%80%BC%E4%BC%98%E5%8C%96/</guid><description>&lt;p>åœ¨ C++ ä¸­ï¼Œå½“å‡½æ•°è¿”å›ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œç¼–è¯‘å™¨é€šå¸¸éœ€è¦è¿›è¡Œå¯¹è±¡çš„æ‹·è´æˆ–ç§»åŠ¨æ“ä½œã€‚ä¾‹å¦‚ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>SomeClass &lt;span style="color:#a6e22e">createObject&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> SomeClass obj;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// è®¾ç½® obj çš„ä¸€äº›æˆå‘˜
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">return&lt;/span> obj; &lt;span style="color:#75715e">// è¿”å›ä¸€ä¸ªå¯¹è±¡
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>åœ¨æ²¡æœ‰ä¼˜åŒ–çš„æƒ…å†µä¸‹ï¼Œ&lt;code>obj&lt;/code> è¢«è¿”å›æ—¶ï¼Œç¼–è¯‘å™¨å¯èƒ½ä¼šæ‰§è¡Œä¸€æ¬¡æ‹·è´æ„é€ æˆ–ç§»åŠ¨æ„é€ æ“ä½œï¼Œç”šè‡³å¯èƒ½æ˜¯ä¸¤æ¬¡ï¼ˆå…ˆæ‹·è´åˆ°ä¸´æ—¶å¯¹è±¡ï¼Œå†ä»ä¸´æ—¶å¯¹è±¡æ‹·è´åˆ°ç›®æ ‡å˜é‡ï¼‰ã€‚è¿™äº›é¢å¤–çš„æ‹·è´æˆ–ç§»åŠ¨æ“ä½œä¼šå¯¼è‡´æ€§èƒ½ä¸‹é™ã€‚&lt;/p>
&lt;p>ä¸ºäº†å‡å°‘è¿™ç§ä¸å¿…è¦çš„å¼€é”€ï¼Œç°ä»£ C++ ç¼–è¯‘å™¨é€šå¸¸ä¼šè¿›è¡Œä¼˜åŒ–ï¼Œå‡å°‘è¿”å›å€¼æ—¶çš„æ‹·è´æˆ–ç§»åŠ¨ï¼Œä½¿ç”¨å¦‚ &lt;strong>RVO&lt;/strong> å’Œ &lt;strong>NRVO&lt;/strong> çš„ä¼˜åŒ–ç­–ç•¥ã€‚&lt;/p>
&lt;h3 id="1-rvoreturn-value-optimizationè¿”å›å€¼ä¼˜åŒ–">1. RVOï¼ˆReturn Value Optimizationï¼Œè¿”å›å€¼ä¼˜åŒ–ï¼‰&lt;/h3>
&lt;p>RVOï¼ˆReturn Value Optimizationï¼Œè¿”å›å€¼ä¼˜åŒ–ï¼‰ï¼Œç¼–è¯‘å™¨å¯ä»¥ç›´æ¥åœ¨ç›®æ ‡å˜é‡çš„ä½ç½®æ„é€ è¿”å›å€¼ï¼Œå‡å°‘ä¸å¿…è¦çš„å¯¹è±¡æ‹·è´å’Œå†…å­˜å¼€é”€ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>SomeClass &lt;span style="color:#a6e22e">createObject&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> SomeClass obj; &lt;span style="color:#75715e">// å±€éƒ¨å¯¹è±¡
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">return&lt;/span> obj; &lt;span style="color:#75715e">// è¿”å›è¯¥å¯¹è±¡
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>åœ¨æ²¡æœ‰ä¼˜åŒ–çš„æƒ…å†µä¸‹ï¼Œ&lt;code>obj&lt;/code> è¢«è¿”å›æ—¶ï¼Œç¼–è¯‘å™¨å¯èƒ½ä¼šåšä¸¤æ¬¡æ“ä½œï¼š&lt;/p>
&lt;ol>
&lt;li>å°† &lt;code>obj&lt;/code> æ‹·è´æˆ–ç§»åŠ¨åˆ°ä¸€ä¸ªä¸´æ—¶å¯¹è±¡ä¸­ã€‚&lt;/li>
&lt;li>å°†ä¸´æ—¶å¯¹è±¡æ‹·è´æˆ–ç§»åŠ¨åˆ°è°ƒç”¨è€…çš„ç›®æ ‡å˜é‡ã€‚&lt;/li>
&lt;/ol>
&lt;p>RVO çš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼Œåœ¨å‡½æ•°è¿”å›ä¸´æ—¶å¯¹è±¡æ—¶ï¼Œç¼–è¯‘å™¨å¯ä»¥&lt;u>ç›´æ¥å°†è¿”å›å€¼æ„é€ åˆ°è°ƒç”¨è€…çš„æ¥æ”¶å˜é‡ä¸­&lt;/u>ï¼Œè€Œæ— éœ€é€šè¿‡ä¸­é—´çš„ä¸´æ—¶å¯¹è±¡è¿›è¡Œæ‹·è´æˆ–ç§»åŠ¨ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">int&lt;/span> &lt;span style="color:#a6e22e">main&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> SomeClass obj &lt;span style="color:#f92672">=&lt;/span> createObject(); &lt;span style="color:#75715e">// RVO ä¼˜åŒ–å°†ç›´æ¥æ„é€ åœ¨ obj ä¸­
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>RVO åªé€‚ç”¨äºä¸´æ—¶å¯¹è±¡è¿”å›çš„åœºæ™¯ï¼Œå¯¹äºå…·åå¯¹è±¡ï¼ˆæœ‰åç§°çš„å±€éƒ¨å¯¹è±¡ï¼‰ï¼Œç¼–è¯‘å™¨ä¸€èˆ¬ä¸èƒ½ç›´æ¥åº”ç”¨ RVOã€‚è¿”å›å…·åå¯¹è±¡æ—¶ï¼Œç¼–è¯‘å™¨ä¼šå°è¯•åº”ç”¨ NRVOï¼ˆNamed Return Value Optimizationï¼Œå‘½åè¿”å›å€¼ä¼˜åŒ–ï¼‰ï¼Œä»¥å‡å°‘ä¸å¿…è¦çš„æ‹·è´æˆ–ç§»åŠ¨ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>SomeClass &lt;span style="color:#a6e22e">createObject&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> SomeClass obj; &lt;span style="color:#75715e">// å…·åå±€éƒ¨å˜é‡
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">return&lt;/span> obj; &lt;span style="color:#75715e">// è¿™é‡Œä¸èƒ½ä½¿ç”¨ RVO
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç¼–è¯‘å™¨è¡Œä¸ºï¼š&lt;/p></description></item><item><title>ç¼“å­˜çš„è®¾è®¡</title><link>https://jekyulll.github.io/posts/cpp-%E7%BC%93%E5%AD%98%E7%9A%84%E8%AE%BE%E8%AE%A1/</link><pubDate>Sat, 21 Dec 2024 18:05:47 +0800</pubDate><guid>https://jekyulll.github.io/posts/cpp-%E7%BC%93%E5%AD%98%E7%9A%84%E8%AE%BE%E8%AE%A1/</guid><description>&lt;ol>
&lt;li>æ•°æ®ç»“æ„&lt;/li>
&lt;/ol>
&lt;ul>
&lt;li>&lt;code>std::unordered_map&lt;/code>ï¼šç”¨äºå¿«é€ŸæŸ¥æ‰¾é”®å€¼å¯¹ã€‚&lt;/li>
&lt;li>åŒå‘é“¾è¡¨ï¼šä¸å“ˆå¸Œè¡¨ç»“åˆå®ç° LRU ç¼“å­˜ã€‚&lt;/li>
&lt;/ul>
&lt;ol>
&lt;li>æ·˜æ±°ç­–ç•¥&lt;/li>
&lt;/ol>
&lt;ul>
&lt;li>&lt;strong>LRU&lt;/strong> (Least Recently Used)ï¼šåˆ é™¤æœ€è¿‘æœ€å°‘ä½¿ç”¨çš„å…ƒç´ ã€‚&lt;/li>
&lt;li>&lt;strong>LFU&lt;/strong> (Least Frequently Used)ï¼šåˆ é™¤ä½¿ç”¨é¢‘ç‡æœ€ä½çš„å…ƒç´ ã€‚&lt;/li>
&lt;li>&lt;strong>FIFO&lt;/strong> (First In First Out)ï¼šåˆ é™¤æœ€æ—©è¿›å…¥ç¼“å­˜çš„å…ƒç´ ã€‚&lt;/li>
&lt;/ul>
&lt;ol>
&lt;li>å¹¶å‘å¤„ç†&lt;/li>
&lt;/ol>
&lt;ul>
&lt;li>&lt;strong>è¯»å†™é”&lt;/strong>ï¼ˆå¦‚std::shared_mutexï¼‰ï¼šå…è®¸å¤šä¸ªè¯»è€…æˆ–ä¸€ä¸ªå†™è€…ã€‚&lt;/li>
&lt;li>&lt;strong>çº¿ç¨‹å®‰å…¨å®¹å™¨&lt;/strong>ï¼šå¯ä»¥ä½¿ç”¨åº“ï¼ˆå¦‚ TBB æˆ– Follyï¼‰æä¾›çš„çº¿ç¨‹å®‰å…¨å®¹å™¨ã€‚&lt;/li>
&lt;/ul>
&lt;ol>
&lt;li>é«˜çº§ä¼˜åŒ–&lt;/li>
&lt;/ol>
&lt;ul>
&lt;li>&lt;strong>åˆ†ç‰‡ç¼“å­˜&lt;/strong>ï¼šä½¿ç”¨åˆ†ç‰‡ï¼ˆshardingï¼‰å°†ç¼“å­˜åˆ’åˆ†æˆå¤šä¸ªç‹¬ç«‹çš„éƒ¨åˆ†ï¼Œä»¥å‡å°‘é”äº‰ç”¨ã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨é”®çš„å“ˆå¸Œå€¼å¯¹åˆ†ç‰‡æ•°é‡å–æ¨¡ã€‚&lt;/li>
&lt;li>&lt;strong>æŒä¹…åŒ–&lt;/strong>ï¼šå°†ç¼“å­˜æ•°æ®ä¿å­˜åˆ°ç£ç›˜ï¼ˆå¦‚ä½¿ç”¨ RocksDB æˆ– Redisï¼‰ï¼Œä»¥ä¾¿æœåŠ¡é‡å¯åæ¢å¤ã€‚&lt;/li>
&lt;li>&lt;strong>é¢„åŠ è½½&lt;/strong>ï¼šåœ¨æœåŠ¡å¯åŠ¨æ—¶ï¼Œé¢„åŠ è½½å¸¸ç”¨çš„æ•°æ®åˆ°ç¼“å­˜ä¸­ï¼Œå‡å°‘å†·å¯åŠ¨æ—¶é—´ã€‚&lt;/li>
&lt;li>&lt;strong>åˆ†å¸ƒå¼ç¼“å­˜&lt;/strong>ï¼šå¦‚æœå•æœºç¼“å­˜ä¸è¶³ï¼Œå¯ä»¥ä½¿ç”¨åˆ†å¸ƒå¼ç¼“å­˜ï¼ˆå¦‚ Memcached æˆ– Redisï¼‰æ¥æ‰©å±•å®¹é‡ã€‚&lt;/li>
&lt;li>&lt;strong>ç›‘æ§å’Œè°ƒè¯•&lt;/strong>ï¼šæ·»åŠ ç¼“å­˜å‘½ä¸­ç‡ç»Ÿè®¡ã€æ—¥å¿—è®°å½•å’Œç›‘æ§æ¥å£ï¼Œä»¥ä¾¿åˆ†ææ€§èƒ½å’Œä¼˜åŒ–ç¼“å­˜ç­–ç•¥ã€‚&lt;/li>
&lt;/ul></description></item><item><title>è¡¨æ ¼å±•ç¤º MySQL åŸºç¡€æ•°æ®ç±»å‹</title><link>https://jekyulll.github.io/posts/database-%E8%A1%A8%E6%A0%BC%E5%B1%95%E7%A4%BA-mysql-%E5%9F%BA%E7%A1%80%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/</link><pubDate>Thu, 21 Nov 2024 18:05:47 +0800</pubDate><guid>https://jekyulll.github.io/posts/database-%E8%A1%A8%E6%A0%BC%E5%B1%95%E7%A4%BA-mysql-%E5%9F%BA%E7%A1%80%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/</guid><description>&lt;table>
 &lt;thead>
 &lt;tr>
 &lt;th>æ•°æ®ç±»å‹&lt;/th>
 &lt;th>æè¿°&lt;/th>
 &lt;th>å­˜å‚¨èŒƒå›´/æ ¼å¼&lt;/th>
 &lt;th>ç¤ºä¾‹&lt;/th>
 &lt;/tr>
 &lt;/thead>
 &lt;tbody>
 &lt;tr>
 &lt;td>INTï¼ˆæ•´æ•°å‹ï¼‰&lt;/td>
 &lt;td>å­˜å‚¨æ•´æ•°ï¼Œæœ‰ä¸åŒçš„å­—èŠ‚å¤§å°æ¥é€‚åº”ä¸åŒèŒƒå›´çš„æ•´æ•°&lt;/td>
 &lt;td>æœ‰TINYINTï¼ˆ1å­—èŠ‚ï¼ŒèŒƒå›´ - 128åˆ°127ï¼‰ã€SMALLINTï¼ˆ2å­—èŠ‚ï¼ŒèŒƒå›´ - 32768åˆ°32767ï¼‰ã€MEDIUMINTï¼ˆ3å­—èŠ‚ï¼‰ã€INTï¼ˆ4å­—èŠ‚ï¼ŒèŒƒå›´ - 2147483648åˆ°2147483647ï¼‰ã€BIGINTï¼ˆ8å­—èŠ‚ï¼‰&lt;/td>
 &lt;td>&lt;code>age INT;&lt;/code>ï¼Œå¯ä»¥å­˜å‚¨åƒ25è¿™æ ·çš„å¹´é¾„å€¼&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>FLOATå’ŒDOUBLEï¼ˆæµ®ç‚¹å‹ï¼‰&lt;/td>
 &lt;td>ç”¨äºå­˜å‚¨å¸¦æœ‰å°æ•°éƒ¨åˆ†çš„æ•°å€¼ï¼ŒFLOATç²¾åº¦è¾ƒä½ï¼ŒDOUBLEç²¾åº¦è¾ƒé«˜&lt;/td>
 &lt;td>FLOATå•ç²¾åº¦æµ®ç‚¹æ•°ï¼Œå¤§çº¦7ä½æœ‰æ•ˆæ•°å­—ï¼›DOUBLEåŒç²¾åº¦æµ®ç‚¹æ•°ï¼Œå¤§çº¦15ä½æœ‰æ•ˆæ•°å­—&lt;/td>
 &lt;td>&lt;code>price FLOAT;&lt;/code>å¯ä»¥å­˜å‚¨åƒ9.99è¿™æ ·çš„ä»·æ ¼å€¼ï¼Œå¯¹äºæ›´é«˜ç²¾åº¦çš„ç§‘å­¦è®¡ç®—å¯èƒ½ä½¿ç”¨&lt;code>measurement DOUBLE;&lt;/code>&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>DECIMAL&lt;/td>
 &lt;td>ç²¾ç¡®çš„å°æ•°å€¼å­˜å‚¨ï¼Œå¸¸ç”¨äºé‡‘èç­‰å¯¹ç²¾åº¦è¦æ±‚æé«˜çš„é¢†åŸŸ&lt;/td>
 &lt;td>æ ¼å¼ä¸ºDECIMAL(M,D)ï¼ŒMæ˜¯æ•°å­—æ€»ä½æ•°ï¼ŒDæ˜¯å°æ•°ç‚¹åçš„ä½æ•°&lt;/td>
 &lt;td>&lt;code>amount DECIMAL(10,2);&lt;/code>å¯ä»¥ç²¾ç¡®å­˜å‚¨åƒ12345.67è¿™æ ·çš„é‡‘é¢ï¼Œå…¶ä¸­æ€»å…±å¯ä»¥å­˜å‚¨10ä½æ•°å­—ï¼Œå°æ•°ç‚¹å2ä½&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>CHAR&lt;/td>
 &lt;td>å®šé•¿å­—ç¬¦ä¸²ï¼Œå­˜å‚¨å›ºå®šé•¿åº¦çš„å­—ç¬¦åºåˆ—&lt;/td>
 &lt;td>å®šä¹‰æ—¶æŒ‡å®šé•¿åº¦ï¼Œå¦‚CHAR(10)ï¼Œæœ€å¤šå­˜å‚¨10ä¸ªå­—ç¬¦ï¼Œä¸è¶³éƒ¨åˆ†ç”¨ç©ºæ ¼å¡«å……&lt;/td>
 &lt;td>&lt;code>code CHAR(5);&lt;/code>å¯ä»¥å­˜å‚¨åƒ&amp;rsquo;ABCD &amp;lsquo;ï¼ˆæ³¨æ„åé¢æœ‰ç©ºæ ¼ï¼‰è¿™æ ·çš„å­—ç¬¦ä¸²&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>VARCHAR&lt;/td>
 &lt;td>å¯å˜é•¿å­—ç¬¦ä¸²ï¼Œæ ¹æ®å®é™…å­˜å‚¨çš„å­—ç¬¦é•¿åº¦å ç”¨ç©ºé—´&lt;/td>
 &lt;td>å®šä¹‰æœ€å¤§é•¿åº¦ï¼Œå¦‚VARCHAR(255)ï¼Œå®é™…å­˜å‚¨å¤šé•¿å°±å ç”¨å¤šå°‘ç©ºé—´åŠ ä¸Š1 - 2å­—èŠ‚ç”¨äºè®°å½•é•¿åº¦&lt;/td>
 &lt;td>&lt;code>name VARCHAR(50);&lt;/code>å¯ä»¥å­˜å‚¨åƒ&amp;rsquo;John Doe&amp;rsquo;è¿™æ ·çš„åå­—ï¼Œé•¿åº¦å°äºç­‰äº50ä¸ªå­—ç¬¦&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>TEXT&lt;/td>
 &lt;td>ç”¨äºå­˜å‚¨å¤§é‡æ–‡æœ¬å†…å®¹&lt;/td>
 &lt;td>æœ‰TINYTEXTã€TEXTã€MEDIUMTEXTå’ŒLONGTEXTï¼Œå­˜å‚¨å¤§å°é€æ¸å¢å¤§&lt;/td>
 &lt;td>&lt;code>description TEXT;&lt;/code>å¯ä»¥å­˜å‚¨ä¸€ç¯‡çŸ­æ–‡æˆ–è€…äº§å“æè¿°&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>BLOB&lt;/td>
 &lt;td>å­˜å‚¨äºŒè¿›åˆ¶å¤§å‹å¯¹è±¡ï¼Œå¦‚å›¾åƒã€éŸ³é¢‘ç­‰&lt;/td>
 &lt;td>æœ‰TINYBLOBã€BLOBã€MEDIUMBLOBå’ŒLONGBLOBï¼Œå­˜å‚¨å¤§å°é€æ¸å¢å¤§&lt;/td>
 &lt;td>&lt;code>image BLOB;&lt;/code>å¯ä»¥å­˜å‚¨ä¸€å¼ ç…§ç‰‡çš„äºŒè¿›åˆ¶æ•°æ®&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>DATE&lt;/td>
 &lt;td>å­˜å‚¨æ—¥æœŸï¼Œæ ¼å¼ä¸ºYYYY - MM - DD&lt;/td>
 &lt;td>ä»1000 - 01 - 01åˆ°9999 - 12 - 31&lt;/td>
 &lt;td>&lt;code>birth_date DATE;&lt;/code>å¯ä»¥å­˜å‚¨åƒ'2000 - 01 - 01&amp;rsquo;è¿™æ ·çš„å‡ºç”Ÿæ—¥æœŸ&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>TIME&lt;/td>
 &lt;td>å­˜å‚¨æ—¶é—´ï¼Œæ ¼å¼ä¸ºHH:MM:SS&lt;/td>
 &lt;td>-&lt;/td>
 &lt;td>&lt;code>start_time TIME;&lt;/code>å¯ä»¥å­˜å‚¨åƒ'09:00:00&amp;rsquo;è¿™æ ·çš„å¼€å§‹æ—¶é—´&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>DATETIME&lt;/td>
 &lt;td>å­˜å‚¨æ—¥æœŸå’Œæ—¶é—´ï¼Œæ ¼å¼ä¸ºYYYY - MM - DD HH:MM:SS&lt;/td>
 &lt;td>ä»1000 - 01 - 01 00:00:00åˆ°9999 - 12 - 31 23:59:59&lt;/td>
 &lt;td>&lt;code>order_time DATETIME;&lt;/code>å¯ä»¥å­˜å‚¨åƒ'2024 - 01 - 01 10:30:00&amp;rsquo;è¿™æ ·çš„è®¢å•æ—¶é—´&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>TIMESTAMP&lt;/td>
 &lt;td>å­˜å‚¨æ—¥æœŸå’Œæ—¶é—´æˆ³ï¼Œä¼šå—åˆ°æ—¶åŒºå½±å“&lt;/td>
 &lt;td>ä»1970 - 01 - 01 00:00:00 UTCåˆ°2038 - 01 - 19 03:14:07 UTC&lt;/td>
 &lt;td>&lt;code>update_time TIMESTAMP;&lt;/code>ç”¨äºè®°å½•æ›´æ–°æ—¶é—´ï¼Œåœ¨ä¸åŒæ—¶åŒºè®¾ç½®ä¸‹å¯èƒ½ä¼šæœ‰å˜åŒ–&lt;/td>
 &lt;/tr>
 &lt;/tbody>
&lt;/table></description></item><item><title>Linux è¿›ç¨‹ä¼˜å…ˆçº§</title><link>https://jekyulll.github.io/posts/linux-linux-%E8%BF%9B%E7%A8%8B%E4%BC%98%E5%85%88%E7%BA%A7/</link><pubDate>Mon, 04 Nov 2024 21:05:47 +0800</pubDate><guid>https://jekyulll.github.io/posts/linux-linux-%E8%BF%9B%E7%A8%8B%E4%BC%98%E5%85%88%E7%BA%A7/</guid><description>&lt;h5 id="å›¾è§£linuxè¿›ç¨‹ä¼˜å…ˆçº§httpsmpweixinqqcoms__bizmzkyndiynzu4mgmid2247484435idx1snb6f30489cf388f1024d6883abb8237c8chksmc1d84682f6afcf94c1af14678d5401d558d2b728f0e6c853dbe4efe02c12dfa147369ceee13frd">&lt;a href="https://mp.weixin.qq.com/s?__biz=MzkyNDIyNzU4Mg==&amp;amp;mid=2247484435&amp;amp;idx=1&amp;amp;sn=b6f30489cf388f1024d6883abb8237c8&amp;amp;chksm=c1d84682f6afcf94c1af14678d5401d558d2b728f0e6c853dbe4efe02c12dfa147369ceee13f#rd">å›¾è§£Linuxè¿›ç¨‹ä¼˜å…ˆçº§&lt;/a>&lt;/h5>
&lt;p>&lt;em>å®æ—¶ä¼˜å…ˆçº§&lt;/em>ç”¨äºå®æ—¶åº”ç”¨ç¨‹åºï¼Œå¦‚ç¡¬å®æ—¶ä»»åŠ¡å’Œå®æ—¶æ§åˆ¶ç³»ç»Ÿï¼Œè€Œ&lt;em>æ™®é€šä¼˜å…ˆçº§&lt;/em>ç”¨äºéå®æ—¶åº”ç”¨ç¨‹åºã€‚&lt;/p>
&lt;ul>
&lt;li>&lt;strong>å®æ—¶è¿›ç¨‹&lt;/strong>ï¼šåŠ¨æ€ä¼˜å…ˆçº§ä¸º0-99çš„è¿›ç¨‹ï¼Œé‡‡ç”¨&lt;em>å®æ—¶è°ƒåº¦ç®—æ³•&lt;/em>è°ƒåº¦ã€‚&lt;/li>
&lt;li>&lt;strong>æ™®é€šè¿›ç¨‹&lt;/strong>ï¼šåŠ¨æ€ä¼˜å…ˆçº§ä¸º100-139çš„è¿›ç¨‹ï¼Œé‡‡ç”¨&lt;em>å®Œå…¨å…¬å¹³è°ƒåº¦ç®—æ³•&lt;/em>è°ƒåº¦ã€‚&lt;/li>
&lt;/ul>
&lt;p>&lt;a href="https://mp.weixin.qq.com/s?__biz=MzkyNDIyNzU4Mg==&amp;amp;mid=2247484458&amp;amp;idx=1&amp;amp;sn=e4e64c006d4d822c6e7c184ab50540c1&amp;amp;chksm=c1d846bbf6afcfad20af0a7132eca1e3fd3c765ea5d4ee4134985b2b03f2461c207239fcc208#rd">Linuxè¿›ç¨‹è°ƒåº¦ä¹‹å®Œå…¨å…¬å¹³è°ƒåº¦ï¼ˆå‹ç®±åº•çš„å¹²è´§åˆ†äº«ï¼‰&lt;/a>ã€‚å®Œå…¨å…¬å¹³è°ƒåº¦ï¼ŒCFS (Completely Fair Scheduler) ã€‚&lt;/p>
&lt;p>&lt;strong>niceå€¼&lt;/strong>ï¼šæ˜¯ç”¨äºè°ƒæ•´æ™®é€šè¿›ç¨‹ä¼˜å…ˆçº§çš„å‚æ•°ã€‚èŒƒå›´ï¼š&lt;code>-20&lt;/code>-&lt;code>19&lt;/code>ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-c" data-lang="c">&lt;span style="display:flex;">&lt;span>task_struct {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>......
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">int&lt;/span> prio; 			&lt;span style="color:#75715e">// prioï¼ˆåŠ¨æ€ä¼˜å…ˆçº§ï¼‰
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">int&lt;/span> static_prio;	&lt;span style="color:#75715e">// static_prioï¼ˆé™æ€ä¼˜å…ˆçº§ï¼‰
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">int&lt;/span> normal_prio;	&lt;span style="color:#75715e">// normal_prioï¼ˆå½’ä¸€åŒ–ä¼˜å…ˆçº§ï¼‰
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">unsigned&lt;/span> &lt;span style="color:#66d9ef">int&lt;/span> rt_priority; 	&lt;span style="color:#75715e">// rt_priorityï¼ˆå®æ—¶ä¼˜å…ˆçº§ï¼‰
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>};
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol>
&lt;li>&lt;code>prio&lt;/code>ï¼ˆåŠ¨æ€ä¼˜å…ˆçº§ï¼‰&lt;br>
åŠ¨æ€ä¼˜å…ˆçº§ï¼Œæœ‰æ•ˆä¼˜å…ˆçº§ï¼Œè°ƒåº¦å™¨æœ€ç»ˆä½¿ç”¨çš„ä¼˜å…ˆçº§æ•°å€¼ï¼ŒèŒƒå›´0-139ï¼Œå€¼è¶Šå°ï¼Œä¼˜å…ˆçº§è¶Šé«˜ã€‚&lt;/li>
&lt;li>&lt;code>static_prio&lt;/code>ï¼ˆé™æ€ä¼˜å…ˆçº§ï¼‰&lt;br>
é™æ€ä¼˜å…ˆçº§ï¼Œé‡‡ç”¨&lt;code>SCHED_NORMAL&lt;/code>å’Œ&lt;code>SCHED_BATCH&lt;/code>è°ƒåº¦ç­–ç•¥çš„è¿›ç¨‹ï¼ˆå³æ™®é€šè¿›ç¨‹ï¼‰ç”¨äºè®¡ç®—åŠ¨æ€ä¼˜å…ˆçº§çš„ï¼ŒèŒƒå›´100-139ã€‚
prio = static_prio = nice + DEFAULT_PRIO = nice + 120&lt;/li>
&lt;li>&lt;code>normal_prio&lt;/code>ï¼ˆå½’ä¸€åŒ–ä¼˜å…ˆçº§ï¼‰&lt;br>
ç”¨äºè®¡ç®—&lt;code>prio&lt;/code>çš„ä¸­é—´å˜é‡ï¼Œä¸éœ€è¦å¤ªå…³å¿ƒã€‚&lt;/li>
&lt;li>&lt;code>rt_priority&lt;/code>ï¼ˆå®æ—¶ä¼˜å…ˆçº§ï¼‰&lt;br>
å®æ—¶ä¼˜å…ˆçº§ï¼Œé‡‡ç”¨&lt;code>SCHED_FIFO&lt;/code>å’Œ&lt;code>SCHED_RR&lt;/code>è°ƒåº¦ç­–ç•¥è¿›ç¨‹ï¼ˆå³å®æ—¶è¿›ç¨‹ï¼‰ç”¨äºè®¡ç®—åŠ¨æ€ä¼˜å…ˆçº§ï¼ŒèŒƒå›´0-99ã€‚
prio = MAX_RT_PRIO - 1 - rt_prio = 100 - 1 - rt_priority;&lt;/li>
&lt;/ol>
&lt;p>å®æ—¶ä¼˜å…ˆçº§æ•°å€¼è¶Šå¤§ï¼Œå¾—åˆ°çš„åŠ¨æ€ä¼˜å…ˆçº§æ•°å€¼è¶Šå°ï¼Œä¼˜å…ˆçº§è¶Šé«˜ã€‚&lt;/p>
&lt;p>&lt;code>ps -elf&lt;/code>å‘½ä»¤æŸ¥çœ‹è¿›ç¨‹ä¼˜å…ˆçº§ã€‚&lt;code>PRI&lt;/code>ï¼šè¿›ç¨‹ä¼˜å…ˆçº§ï¼Œæ•°å€¼è¶Šå°ï¼Œä¼˜å…ˆçº§è¶Šé«˜ã€‚ï¼ˆå¹¶éåŠ¨æ€ä¼˜å…ˆçº§ï¼‰&lt;code>NI&lt;/code>ï¼šniceå€¼ã€‚&lt;/p>
&lt;p>&lt;code>SCHED_FIFO&lt;/code>ï¼ˆå…ˆè¿›å…ˆå‡ºè°ƒåº¦ï¼‰å’Œ&lt;code>SCHED_RR&lt;/code>ï¼ˆæ—¶é—´ç‰‡è½®è½¬è°ƒåº¦ï¼‰ï¼Œè¿™äº›ç­–ç•¥å¯ä»¥é€šè¿‡&lt;code>sched_setscheduler()&lt;/code>ç³»ç»Ÿè°ƒç”¨ï¼ˆå¤´æ–‡ä»¶&lt;code>&amp;lt;sched.h&amp;gt;&lt;/code>ï¼‰æ¥è®¾ç½®ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">struct&lt;/span> &lt;span style="color:#a6e22e">sched_param&lt;/span> param;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// è®¾ç½®ä¼˜å…ˆçº§ä¸ºæœ€é«˜ä¼˜å…ˆçº§
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> param.sched_priority &lt;span style="color:#f92672">=&lt;/span> sched_get_priority_max(SCHED_FIFO);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// è®¾ç½®è°ƒåº¦ç­–ç•¥ä¸ºSCHED_FIFO
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">if&lt;/span> (sched_setscheduler(getpid(), SCHED_FIFO, &lt;span style="color:#f92672">&amp;amp;&lt;/span>param) &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> std&lt;span style="color:#f92672">::&lt;/span>cerr &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> &lt;span style="color:#e6db74">&amp;#34;æ— æ³•è®¾ç½®å®æ—¶è°ƒåº¦ç­–ç•¥&amp;#34;&lt;/span> &lt;span style="color:#f92672">&amp;lt;&amp;lt;&lt;/span> std&lt;span style="color:#f92672">::&lt;/span>endl;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Linux æ–‡ä»¶ç³»ç»Ÿä¸è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿ</title><link>https://jekyulll.github.io/posts/linux-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E4%B8%8E%E8%99%9A%E6%8B%9F%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/</link><pubDate>Mon, 04 Nov 2024 20:05:47 +0800</pubDate><guid>https://jekyulll.github.io/posts/linux-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E4%B8%8E%E8%99%9A%E6%8B%9F%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/</guid><description>&lt;h1 id="linux-æ–‡ä»¶ç³»ç»Ÿ">Linux æ–‡ä»¶ç³»ç»Ÿ&lt;/h1>
&lt;p>&lt;strong>æ–‡ä»¶æè¿°ç¬¦&lt;/strong>(File Descriptorï¼ŒFD)(winé‡Œä¸€èˆ¬ç§°ä¸ºæ–‡ä»¶å¥æŸ„)æ˜¯æ“ä½œç³»ç»Ÿä¸­ç”¨äºæ ‡è¯†å’Œç®¡ç†å·²æ‰“å¼€æ–‡ä»¶æˆ–I/Oèµ„æºçš„æ•´æ•°å€¼ã€‚&lt;br>
å½“è¿›ç¨‹è¯·æ±‚æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶æˆ–èµ„æºæ—¶ï¼Œæ“ä½œç³»ç»Ÿä¸ºè¯¥èµ„æºåˆ†é…ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œå¹¶å°†å…¶è¿”å›ç»™è¿›ç¨‹ã€‚è¿›ç¨‹éšåä½¿ç”¨è¯¥æ–‡ä»¶æè¿°ç¬¦æ¥è¿›è¡Œè¯»å†™æ“ä½œã€‚
æ˜¯ä¸€ä¸ªè¿›ç¨‹çº§åˆ«çš„æ¦‚å¿µã€‚&lt;/p>
&lt;ul>
&lt;li>ç»§æ‰¿ï¼šåœ¨åˆ›å»ºå­è¿›ç¨‹æ—¶ï¼Œæ–‡ä»¶æè¿°ç¬¦å¯ä»¥åœ¨çˆ¶å­è¿›ç¨‹ä¹‹é—´å…±äº«ï¼ˆä¾‹å¦‚é€šè¿‡ fork()ï¼‰ã€‚&lt;/li>
&lt;li>å¤åˆ¶ï¼šé€šè¿‡ç³»ç»Ÿè°ƒç”¨ dup() æˆ– dup2() å¯ä»¥å¤åˆ¶æ–‡ä»¶æè¿°ç¬¦ï¼Œä½¿å®ƒä»¬å¼•ç”¨åŒä¸€ä¸ªæ–‡ä»¶æˆ–èµ„æºã€‚&lt;/li>
&lt;/ul>
&lt;p>æ–‡ä»¶æè¿°ç¬¦ä¸ä»…ç”¨äºæ“ä½œæ–‡ä»¶ï¼Œè¿˜å¯ä»¥æŒ‡å‘ï¼š&lt;/p>
&lt;ul>
&lt;li>ç®¡é“ï¼ˆPipesï¼‰ï¼šç”¨äºè¿›ç¨‹é—´é€šä¿¡ã€‚&lt;/li>
&lt;li>å¥—æ¥å­—ï¼ˆSocketsï¼‰ï¼šç”¨äºç½‘ç»œé€šä¿¡ã€‚&lt;/li>
&lt;li>è®¾å¤‡æ–‡ä»¶ï¼šä¾‹å¦‚ç¡¬ç›˜ã€ä¸²å£ç­‰è®¾å¤‡ã€‚&lt;/li>
&lt;/ul>
&lt;p>&lt;strong>æ–‡ä»¶åˆ†é…è¡¨&lt;/strong>(File Allocation Table, FAT)ã€‚&lt;/p>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1jy4y1K73r/?spm_id_from=333.337.search-card.all.click&amp;amp;vd_source=9b0b9cbfd8c349b95b4776bd10953f3a">ä½•ä¸ºæ–‡ä»¶ç´¢å¼•èŠ‚ç‚¹?æ–‡ä»¶ä¸ç£ç›˜çš„çˆ±æ¨æƒ…ä»‡ã€‚&lt;/a>ã€‚&lt;br>
&lt;a href="https://ruanyifeng.com/blog/2011/12/inode.html">é˜®ä¸€å³°çš„ä¸ªäººç½‘ç«™&lt;/a>ã€‚&lt;br>
&lt;strong>inode&lt;/strong>ï¼ˆç´¢å¼•èŠ‚ç‚¹ï¼‰ã€‚&lt;a href="https://ruanyifeng.com/blog/2011/12/inode.html">ç†è§£inode&lt;/a>ã€‚&lt;/p>
&lt;blockquote>
&lt;p>æ–‡ä»¶å‚¨å­˜åœ¨ç¡¬ç›˜ä¸Šï¼Œç¡¬ç›˜çš„æœ€å°å­˜å‚¨å•ä½å«åš&amp;quot;æ‰‡åŒº&amp;quot;ï¼ˆSectorï¼‰ã€‚æ¯ä¸ªæ‰‡åŒºå‚¨å­˜512å­—èŠ‚ï¼ˆç›¸å½“äº0.5KBï¼‰ã€‚
æ“ä½œç³»ç»Ÿè¯»å–ç¡¬ç›˜çš„æ—¶å€™ï¼Œä¸ä¼šä¸€ä¸ªä¸ªæ‰‡åŒºåœ°è¯»å–ï¼Œè¿™æ ·æ•ˆç‡å¤ªä½ï¼Œè€Œæ˜¯ä¸€æ¬¡æ€§è¿ç»­è¯»å–å¤šä¸ªæ‰‡åŒºï¼Œå³ä¸€æ¬¡æ€§è¯»å–ä¸€ä¸ª&amp;quot;å—&amp;quot;ï¼ˆblockï¼‰ã€‚è¿™ç§ç”±å¤šä¸ªæ‰‡åŒºç»„æˆçš„&amp;quot;å—&amp;quot;ï¼Œæ˜¯æ–‡ä»¶å­˜å–çš„æœ€å°å•ä½ã€‚&amp;ldquo;å—&amp;quot;çš„å¤§å°ï¼Œæœ€å¸¸è§çš„æ˜¯4KBï¼Œå³è¿ç»­å…«ä¸ª sectorç»„æˆä¸€ä¸ª blockã€‚
æ–‡ä»¶æ•°æ®éƒ½å‚¨å­˜åœ¨&amp;quot;å—&amp;quot;ä¸­ï¼Œé‚£ä¹ˆå¾ˆæ˜¾ç„¶ï¼Œæˆ‘ä»¬è¿˜å¿…é¡»æ‰¾åˆ°ä¸€ä¸ªåœ°æ–¹å‚¨å­˜æ–‡ä»¶çš„å…ƒä¿¡æ¯ï¼Œæ¯”å¦‚æ–‡ä»¶çš„åˆ›å»ºè€…ã€æ–‡ä»¶çš„åˆ›å»ºæ—¥æœŸã€æ–‡ä»¶çš„å¤§å°ç­‰ç­‰ã€‚è¿™ç§å‚¨å­˜æ–‡ä»¶å…ƒä¿¡æ¯çš„åŒºåŸŸå°±å«åšinodeï¼Œä¸­æ–‡è¯‘åä¸º&amp;quot;ç´¢å¼•èŠ‚ç‚¹&amp;rdquo;ã€‚&lt;br>
å¯ä»¥ç”¨&lt;code>stat&lt;/code>å‘½ä»¤ï¼ŒæŸ¥çœ‹æŸä¸ªæ–‡ä»¶çš„inodeä¿¡æ¯ã€‚
inodeä¹Ÿä¼šæ¶ˆè€—ç¡¬ç›˜ç©ºé—´ï¼Œæ‰€ä»¥ç¡¬ç›˜æ ¼å¼åŒ–çš„æ—¶å€™ï¼Œæ“ä½œç³»ç»Ÿè‡ªåŠ¨å°†ç¡¬ç›˜åˆ†æˆä¸¤ä¸ªåŒºåŸŸã€‚ä¸€ä¸ªæ˜¯æ•°æ®åŒºï¼Œå­˜æ”¾æ–‡ä»¶æ•°æ®ï¼›å¦ä¸€ä¸ªæ˜¯&lt;strong>inodeåŒº&lt;/strong>ï¼ˆinode tableï¼‰ï¼Œå­˜æ”¾inodeæ‰€åŒ…å«çš„ä¿¡æ¯ã€‚
Unix/Linuxç³»ç»Ÿå†…éƒ¨ä¸ä½¿ç”¨æ–‡ä»¶åï¼Œè€Œä½¿ç”¨inodeå·ç æ¥è¯†åˆ«æ–‡ä»¶ã€‚&lt;/p>
&lt;/blockquote>
&lt;p>&lt;strong>è¶…çº§å—&lt;/strong>ï¼ˆSuperblockï¼‰ä½äºæ¯ä¸ªæ–‡ä»¶ç³»ç»Ÿçš„å¼€å¤´ï¼Œæä¾›äº†æ“ä½œç³»ç»Ÿå¦‚ä½•è§£é‡Šå’Œç®¡ç†è¯¥æ–‡ä»¶ç³»ç»Ÿçš„å…ƒæ•°æ®ã€‚(è®°å½•å„ä¸ªinode?)&lt;/p>
&lt;p>&lt;strong>è½¯é“¾æ¥å’Œç¡¬é“¾æ¥ï¼š&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>è½¯é“¾æ¥æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„æ–‡ä»¶ï¼Œå®ƒåŒ…å«äº†å¦ä¸€ä¸ªæ–‡ä»¶æˆ–ç›®å½•çš„è·¯å¾„ã€‚å®ƒç±»ä¼¼äº Windows ç³»ç»Ÿä¸­çš„å¿«æ·æ–¹å¼ã€‚&lt;/li>
&lt;li>ç¡¬é“¾æ¥æ˜¯æ–‡ä»¶çš„ä¸€ä¸ªç›´æ¥å¼•ç”¨ï¼ˆæˆ–è€…è¯´æ˜¯æŒ‡é’ˆï¼‰ï¼Œå®ƒä¸åŸæ–‡ä»¶å…±äº«ç›¸åŒçš„inodeã€‚åˆ é™¤åŸæ–‡ä»¶åï¼Œç¡¬é“¾æ¥ä»ç„¶æœ‰æ•ˆï¼Œå› ä¸ºå®ƒç›´æ¥å¼•ç”¨äº†æ–‡ä»¶çš„æ•°æ®ï¼›æ–‡ä»¶åªæœ‰å½“æ‰€æœ‰ç¡¬é“¾æ¥éƒ½è¢«åˆ é™¤åï¼Œæ•°æ®æ‰ä¼šè¢«æ¸…é™¤ã€‚inodeä¿¡æ¯ä¸­æœ‰ä¸€é¡¹å«åš&amp;quot;é“¾æ¥æ•°&amp;quot;ï¼Œè®°å½•æŒ‡å‘è¯¥inodeçš„æ–‡ä»¶åæ€»æ•°ã€‚&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>linuxè½¯ä»¶æ›´æ–°è¿‡ç¨‹ï¼šè½¯ä»¶æ›´æ–°å˜å¾—ç®€å•ï¼šç³»ç»Ÿé€šè¿‡inodeå·ç ï¼Œè¯†åˆ«è¿è¡Œä¸­çš„æ–‡ä»¶ï¼Œä¸é€šè¿‡æ–‡ä»¶åã€‚æ›´æ–°çš„æ—¶å€™ï¼Œæ–°ç‰ˆæ–‡ä»¶ä»¥åŒæ ·çš„æ–‡ä»¶åï¼Œç”Ÿæˆä¸€ä¸ªæ–°çš„inodeï¼Œä¸ä¼šå½±å“åˆ°è¿è¡Œä¸­çš„æ–‡ä»¶ã€‚ç­‰åˆ°ä¸‹ä¸€æ¬¡è¿è¡Œè¿™ä¸ªè½¯ä»¶çš„æ—¶å€™ï¼Œæ–‡ä»¶åå°±è‡ªåŠ¨æŒ‡å‘æ–°ç‰ˆæ–‡ä»¶ï¼Œæ—§ç‰ˆæ–‡ä»¶çš„inodeåˆ™è¢«å›æ”¶ã€‚&lt;/p>
&lt;/blockquote>
&lt;hr>
&lt;h1 id="linux-è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿ">Linux è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿ&lt;/h1>
&lt;p>&lt;a href="https://zhuanlan.zhihu.com/p/3815712411">linux I/OåŸç†ã€ç›‘æ§ã€å’Œè°ƒä¼˜æ€è·¯&lt;/a>ã€‚&lt;br>
&lt;a href="https://zhuanlan.zhihu.com/p/681048030">å›¾è§£Linuxè™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿ(VFS)ä¹‹å…³ç³»ç¯‡&lt;/a>ã€‚&lt;/p>
&lt;p>&lt;strong>è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿ&lt;/strong>ï¼ˆVirtual File Systemï¼ŒVFSï¼‰ï¼šå®ƒæä¾›äº†ä¸€ä¸ªç»Ÿä¸€çš„æ¥å£ï¼Œä½¿å¾—ç”¨æˆ·å’Œåº”ç”¨ç¨‹åºå¯ä»¥é€šè¿‡ç›¸åŒçš„æ–¹å¼è®¿é—®ä¸åŒç±»å‹çš„æ–‡ä»¶ç³»ç»Ÿã€‚&lt;/p>
&lt;blockquote>
&lt;p>é€šè¿‡VFSç”¨æˆ·å¯ä»¥ä½¿ç”¨ç›¸åŒçš„ç³»ç»Ÿè°ƒç”¨ï¼ˆå¦‚&lt;code>open&lt;/code>ã€&lt;code>read&lt;/code>ã€&lt;code>write&lt;/code>ç­‰ï¼‰æ¥è®¿é—®ä¸åŒç±»å‹çš„æ–‡ä»¶ç³»ç»Ÿï¼ŒåŒ…æ‹¬æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿï¼ˆå¦‚ext4ã€XFSç­‰ï¼‰ã€ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿï¼ˆå¦‚NFSã€CIFSç­‰ï¼‰ä»¥åŠè™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿï¼ˆå¦‚procfsã€sysfsç­‰ï¼‰ã€‚&lt;/p>
&lt;/blockquote>
&lt;p>VFSç”±ä»¥ä¸‹å‡ ä¸ªä¸»è¦ç»„ä»¶ç»„æˆï¼š&lt;/p>
&lt;ol>
&lt;li>&lt;strong>è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿæ¥å£&lt;/strong>ï¼šVFSå®šä¹‰äº†ä¸€ç»„é€šç”¨çš„æ–‡ä»¶ç³»ç»Ÿæ“ä½œæ¥å£ã€‚&lt;/li>
&lt;li>&lt;strong>è¶…çº§å—(super_block)&lt;/strong>ï¼šæ¯ä¸ªæ–‡ä»¶ç³»ç»Ÿéƒ½æœ‰ä¸€ä¸ªè¶…çº§å—ï¼Œå®ƒåŒ…å«äº†æ–‡ä»¶ç³»ç»Ÿçš„å…ƒæ•°æ®ä¿¡æ¯ï¼Œå¦‚æ–‡ä»¶ç³»ç»Ÿç±»å‹ã€å—å¤§å°ã€inodeè¡¨ç­‰ï¼Œè¶…çº§å—æä¾›äº†å¯¹æ–‡ä»¶ç³»ç»Ÿçš„æ•´ä½“æè¿°å’Œç®¡ç†ã€‚&lt;/li>
&lt;li>&lt;strong>ç›®å½•é¡¹(dentry)&lt;/strong>ï¼šDirectory Entryï¼Œç”¨äºè¡¨ç¤ºæ–‡ä»¶ç³»ç»Ÿä¸­çš„ç›®å½•å’Œæ–‡ä»¶ï¼ŒdentryåŒ…å«äº†ç›®å½•å’Œæ–‡ä»¶å¯¹åº”çš„inodeæŒ‡é’ˆã€å±‚çº§å…³ç³»(parent)ç­‰ã€‚
&lt;blockquote>
&lt;p>dentryç»“æ„ä½“çš„ä¸»è¦ä½œç”¨æ˜¯æä¾›æ–‡ä»¶ç³»ç»Ÿå±‚æ¬¡ç»“æ„çš„è¡¨ç¤ºï¼Œå®ƒä»¬é€šè¿‡å½¢æˆä¸€ä¸ªæ ‘çŠ¶ç»“æ„æ¥ç»„ç»‡ç›®å½•å’Œæ–‡ä»¶ï¼Œæ¯ä¸ªdentryéƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„è·¯å¾„åï¼Œå¯ä»¥é€šè¿‡éå†dentryæ ‘æ¥æ‰¾åˆ°ç‰¹å®šæ–‡ä»¶æˆ–ç›®å½•ã€‚&lt;/p>
&lt;/blockquote>
&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-c" data-lang="c">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">struct&lt;/span> dentry {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">struct&lt;/span> dentry &lt;span style="color:#f92672">*&lt;/span>d_parent;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">struct&lt;/span> qstr d_name;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">struct&lt;/span> inode &lt;span style="color:#f92672">*&lt;/span>d_inode;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#66d9ef">struct&lt;/span> dentry_operations &lt;span style="color:#f92672">*&lt;/span>d_op;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">struct&lt;/span> super_block &lt;span style="color:#f92672">*&lt;/span>d_sb;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">struct&lt;/span> list_head d_child;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">struct&lt;/span> list_head d_subdirs;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ....
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="4">
&lt;li>&lt;strong>æ–‡ä»¶èŠ‚ç‚¹(inode)&lt;/strong>ï¼šinodeæ˜¯æ–‡ä»¶ç³»ç»Ÿä¸­çš„ä¸€ä¸ªæ•°æ®ç»“æ„ï¼Œç”¨äºå­˜å‚¨æ–‡ä»¶æˆ–ç›®å½•çš„å…ƒæ•°æ®ä¿¡æ¯ï¼Œå¦‚æ–‡ä»¶å¤§å°ã€æƒé™ã€æ‰€æœ‰è€…ç­‰ï¼Œæ¯ä¸ªæ–‡ä»¶æˆ–ç›®å½•éƒ½å¯¹åº”ä¸€ä¸ªå”¯ä¸€çš„inodeã€‚&lt;/li>
&lt;li>&lt;strong>æ–‡ä»¶å¯¹è±¡(file)&lt;/strong>ï¼šfileæ˜¯è¡¨ç¤ºæ‰“å¼€æ–‡ä»¶çš„æ•°æ®ç»“æ„ï¼Œå®ƒåŒ…å«äº†å¯¹åº”çš„inodeæŒ‡é’ˆã€å½“å‰è¯»å†™ä½ç½®ç­‰ä¿¡æ¯ï¼Œé€šè¿‡fileå¯ä»¥è¿›è¡Œæ–‡ä»¶çš„è¯»å†™æ“ä½œã€‚&lt;/li>
&lt;/ol>
&lt;ul>
&lt;li>&lt;strong>ç´¢å¼•èŠ‚ç‚¹&lt;/strong>(index node, inode)ï¼Œç”¨æ¥è®°å½•æ–‡ä»¶çš„å…ƒæ•°æ®ï¼Œæ¯”å¦‚ inode ç¼–å·ã€æ–‡ä»¶å¤§å°ã€è®¿é—®æƒé™ã€ä¿®æ”¹æ—¥æœŸã€æ•°æ®çš„ä½ç½®ç­‰ã€‚ç´¢å¼•èŠ‚ç‚¹å’Œæ–‡ä»¶ä¸€ä¸€å¯¹åº”ï¼Œå®ƒè·Ÿæ–‡ä»¶å†…å®¹ä¸€æ ·ï¼Œéƒ½ä¼šè¢«æŒä¹…åŒ–å­˜å‚¨åˆ°ç£ç›˜ä¸­ã€‚æ‰€ä»¥è®°ä½ï¼Œç´¢å¼•èŠ‚ç‚¹åŒæ ·å ç”¨ç£ç›˜ç©ºé—´ã€‚&lt;/li>
&lt;li>&lt;strong>ç›®å½•é¡¹&lt;/strong>(directory entry, dentry)ï¼Œç”¨æ¥è®°å½•æ–‡ä»¶çš„åå­—ã€ç´¢å¼•èŠ‚ç‚¹æŒ‡é’ˆä»¥åŠä¸å…¶ä»–ç›®å½•é¡¹çš„å…³è”å…³ç³»ã€‚å¤šä¸ªå…³è”çš„ç›®å½•é¡¹ï¼Œå°±æ„æˆäº†æ–‡ä»¶ç³»ç»Ÿçš„ç›®å½•ç»“æ„ã€‚ä¸è¿‡ï¼Œä¸åŒäºç´¢å¼•èŠ‚ç‚¹ï¼Œç›®å½•é¡¹æ˜¯ç”±å†…æ ¸ç»´æŠ¤çš„ä¸€ä¸ªå†…å­˜æ•°æ®ç»“æ„ï¼Œæ‰€ä»¥é€šå¸¸ä¹Ÿè¢«å«åšç›®å½•é¡¹ç¼“å­˜ã€‚&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>&lt;strong>ramfs&lt;/strong>æ˜¯ä¸€ç§åŸºäºå†…å­˜çš„æ–‡ä»¶ç³»ç»Ÿã€‚å®ƒå°†æ‰€æœ‰çš„æ–‡ä»¶æ•°æ®å­˜å‚¨åœ¨å†…å­˜ï¼ˆRAMï¼‰ä¸­ï¼Œè€Œä¸æ˜¯åƒä¼ ç»Ÿçš„æ–‡ä»¶ç³»ç»Ÿé‚£æ ·å­˜å‚¨åœ¨ç£ç›˜ç­‰å¤–éƒ¨å­˜å‚¨è®¾å¤‡ä¸Šã€‚&lt;/p></description></item><item><title>äº‹åŠ¡ Transaction çš„åŸºç¡€ç‰¹æ€§</title><link>https://jekyulll.github.io/posts/database-%E4%BA%8B%E5%8A%A1transaction%E7%9A%84%E5%9F%BA%E7%A1%80%E7%89%B9%E6%80%A7/</link><pubDate>Mon, 04 Nov 2024 18:05:47 +0800</pubDate><guid>https://jekyulll.github.io/posts/database-%E4%BA%8B%E5%8A%A1transaction%E7%9A%84%E5%9F%BA%E7%A1%80%E7%89%B9%E6%80%A7/</guid><description>&lt;p>&lt;strong>äº‹åŠ¡&lt;/strong>ï¼ˆTransactionï¼‰æ˜¯æ•°æ®åº“ç®¡ç†ç³»ç»Ÿæ‰§è¡Œè¿‡ç¨‹ä¸­çš„ä¸€ä¸ªé€»è¾‘å•ä½ï¼Œå®ƒç”±ä¸€ä¸ªæˆ–å¤šä¸ªæ•°æ®åº“æ“ä½œç»„æˆï¼Œè¿™äº›æ“ä½œè¦ä¹ˆå…¨éƒ¨æ‰§è¡ŒæˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨ä¸æ‰§è¡Œï¼Œä»¥ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§å’Œå®Œæ•´æ€§ã€‚&lt;br>
&lt;strong>ACID&lt;/strong> æ˜¯äº‹åŠ¡çš„å››ä¸ªé‡è¦ç‰¹æ€§ï¼š&lt;/p>
&lt;ol>
&lt;li>
&lt;p>&lt;strong>åŸå­æ€§&lt;/strong>ï¼ˆAtomicityï¼‰;&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>ä¸€è‡´æ€§&lt;/strong>ï¼ˆConsistencyï¼‰;&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>éš”ç¦»æ€§&lt;/strong>ï¼ˆIsolationï¼‰ï¼›ä¸åŒçš„éš”ç¦»çº§åˆ«ï¼š&lt;/p>
&lt;ol>
&lt;li>&lt;strong>è¯»æœªæäº¤&lt;/strong>ï¼ˆRead Uncommittedï¼‰ï¼šæœ€ä½çš„éš”ç¦»çº§åˆ«ã€‚ä¸€ä¸ªäº‹åŠ¡å¯ä»¥è¯»å–å¦ä¸€ä¸ªæœªæäº¤äº‹åŠ¡çš„æ•°æ®ã€‚
&lt;ul>
&lt;li>å¯èƒ½ä¼šå‡ºç°&lt;strong>è„è¯»&lt;/strong>ï¼ˆDirty Readï¼‰çš„æƒ…å†µã€‚
&lt;blockquote>
&lt;p>è„è¯»æ˜¯æŒ‡ä¸€ä¸ªäº‹åŠ¡è¯»å–äº†å¦ä¸€ä¸ªå°šæœªæäº¤çš„äº‹åŠ¡ä¿®æ”¹çš„æ•°æ®ã€‚eg.äº‹åŠ¡ T1 ä¿®æ”¹äº†ä¸€æ¡è®°å½•ä½†å°šæœªæäº¤ï¼Œäº‹åŠ¡ T2 åœ¨è¿™ä¸ªæ—¶å€™è¯»å–äº†è¿™æ¡è¢«ä¿®æ”¹çš„è®°å½•ã€‚å¦‚æœ T1 åæ¥å›æ»šäº†ï¼Œé‚£ä¹ˆ T2 è¯»å–çš„æ•°æ®å°±æ˜¯æ— æ•ˆçš„ã€â€œè„â€ çš„æ•°æ®ã€‚&lt;/p>
&lt;/blockquote>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;strong>è¯»å·²æäº¤&lt;/strong>ï¼ˆRead Committedï¼‰ï¼š
&lt;ul>
&lt;li>å¯èƒ½ä¼šå‡ºç°&lt;strong>ä¸å¯é‡å¤è¯»&lt;/strong>ï¼ˆNon - Repeatable Readï¼‰çš„é—®é¢˜ã€‚
&lt;blockquote>
&lt;p>ä¸å¯é‡å¤è¯»æ˜¯æŒ‡åœ¨ä¸€ä¸ªäº‹åŠ¡å†…ï¼Œå¤šæ¬¡è¯»å–åŒä¸€æ•°æ®ï¼Œç”±äºå…¶ä»–äº‹åŠ¡çš„ä¿®æ”¹æ“ä½œï¼Œå¯¼è‡´æ¯æ¬¡è¯»å–çš„ç»“æœä¸åŒã€‚&lt;/p>
&lt;/blockquote>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;strong>å¯é‡å¤è¯»&lt;/strong>ï¼ˆRepeatable Readï¼‰ï¼š
&lt;ul>
&lt;li>å¯èƒ½ä¼šå‡ºç°å¹»è¯»ï¼ˆPhantom Readï¼‰çš„æƒ…å†µã€‚
&lt;blockquote>
&lt;p>å½“ä¸€ä¸ªäº‹åŠ¡ï¼ˆT1ï¼‰æŒ‰ç…§ä¸€å®šçš„æ¡ä»¶è¿›è¡Œæ•°æ®è¯»å–æ“ä½œæ—¶ï¼Œç¬¬ä¸€æ¬¡è¯»å–æ²¡æœ‰å‘ç°æ»¡è¶³æ¡ä»¶çš„æŸäº›è¡Œï¼ˆè®°å½•ï¼‰ã€‚ä½†æ˜¯åœ¨è¿™ä¸ªäº‹åŠ¡è¿˜æ²¡æœ‰ç»“æŸçš„æ—¶å€™ï¼Œå¦ä¸€ä¸ªäº‹åŠ¡ï¼ˆT2ï¼‰æ’å…¥ï¼ˆæˆ–åˆ é™¤ï¼‰äº†ä¸€äº›æ»¡è¶³ï¼ˆæˆ–åŸæœ¬æ»¡è¶³ï¼‰T1 æŸ¥è¯¢æ¡ä»¶çš„è¡Œã€‚å½“ T1 å†æ¬¡æŒ‰ç…§ç›¸åŒçš„æ¡ä»¶è¿›è¡Œè¯»å–æ—¶ï¼Œå°±ä¼šå‘ç°æ¯”ç¬¬ä¸€æ¬¡è¯»å–æ—¶æ›´å¤šï¼ˆæˆ–æ›´å°‘ï¼‰çš„ç¬¦åˆæ¡ä»¶çš„è¡Œï¼Œè¿™äº› â€œå‡­ç©ºå‡ºç°â€ æˆ– â€œçªç„¶æ¶ˆå¤±â€ çš„è¡Œå°±åƒ â€œå¹»è§‰â€ ä¸€æ ·ï¼Œæ‰€ä»¥è¢«ç§°ä¸ºå¹»è¯»ã€‚&lt;/p>
&lt;/blockquote>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;strong>ä¸²è¡ŒåŒ–&lt;/strong>ï¼ˆSerializableï¼‰ï¼šæœ€é«˜çš„éš”ç¦»çº§åˆ«ã€‚ç‰ºç‰²äº†æ•°æ®åº“çš„å¹¶å‘æ€§èƒ½ã€‚&lt;/li>
&lt;/ol>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>æŒä¹…æ€§&lt;/strong>ï¼ˆDurabilityï¼‰ã€‚&lt;/p>
&lt;/li>
&lt;/ol></description></item><item><title>CPU çš„äº”çº§æµæ°´çº¿</title><link>https://jekyulll.github.io/posts/system-cpu-%E7%9A%84%E4%BA%94%E7%BA%A7%E6%B5%81%E6%B0%B4%E7%BA%BF/</link><pubDate>Wed, 09 Oct 2024 21:05:47 +0800</pubDate><guid>https://jekyulll.github.io/posts/system-cpu-%E7%9A%84%E4%BA%94%E7%BA%A7%E6%B5%81%E6%B0%B4%E7%BA%BF/</guid><description>&lt;p>&lt;a href="https://zhuanlan.zhihu.com/p/382372072">ç°ä»£C++çš„å†…å­˜æ¨¡å‹&lt;/a>ã€‚&amp;ndash;ç¥æ–‡&lt;br>
&lt;a href="https://zhuanlan.zhihu.com/p/682286231">è‡ªåº•å‘ä¸Šç†è§£memory_order&lt;/a>ã€‚&lt;br>
&lt;a href="https://blog.csdn.net/sinat_38293503/article/details/134612152">å¤§ç™½è¯C++ä¹‹ï¼šä¸€æ–‡ææ‡‚C++å¤šçº¿ç¨‹å†…å­˜æ¨¡å‹(Memory Order)&lt;/a>ã€‚&lt;/p>
&lt;blockquote>
&lt;p>&lt;em>æ—¶é’Ÿå‘¨æœŸ&lt;/em>ä¹Ÿç§°ä¸º&lt;em>æŒ¯è¡å‘¨æœŸ&lt;/em>ï¼Œå®šä¹‰ä¸ºæ—¶é’Ÿé¢‘ç‡çš„å€’æ•°ã€‚æ—¶é’Ÿå‘¨æœŸæ˜¯è®¡ç®—æœºä¸­æœ€åŸºæœ¬çš„ã€æœ€å°çš„æ—¶é—´å•ä½ã€‚åœ¨ä¸€ä¸ªæ—¶é’Ÿå‘¨æœŸå†…ï¼ŒCPUä»…å®Œæˆä¸€ä¸ªæœ€åŸºæœ¬çš„åŠ¨ä½œã€‚æ—¶é’Ÿå‘¨æœŸè¡¨ç¤ºäº†&lt;em>SDRAM&lt;/em>æ‰€èƒ½è¿è¡Œçš„æœ€é«˜é¢‘ç‡ã€‚&lt;/p>
&lt;/blockquote>
&lt;blockquote>
&lt;p>å¦‚æœæ²¡æœ‰Cacheï¼ŒCPUæ¯æ‰§è¡Œä¸€æ¡æŒ‡ä»¤ï¼Œéƒ½è¦å»å†…å­˜å–ä¸‹ä¸€æ¡ï¼Œè€Œæ‰§è¡Œä¸€æ¡æŒ‡ä»¤ä¹Ÿå°±å‡ ä¸ªæ—¶é’Ÿå‘¨æœŸï¼ˆå‡ nsï¼‰ï¼Œè€Œå–æŒ‡ä»¤å´è¦ä¸Šç™¾ä¸ªæ—¶é’Ÿå‘¨æœŸï¼Œè¿™å°†å¯¼è‡´CPUå¤§éƒ¨åˆ†æ—¶é—´éƒ½åœ¨ç­‰å¾…çŠ¶æ€ï¼Œè¿›è€Œå¯¼è‡´æ‰§è¡Œæ•ˆç‡ä½ä¸‹ã€‚&lt;/p>
&lt;/blockquote>
&lt;blockquote>
&lt;p>C++ å†…å­˜æ¨¡å‹ï¼ˆMemory Modelï¼‰å®šä¹‰äº†ç¨‹åºåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­å¦‚ä½•è®¿é—®å’Œå…±äº«å†…å­˜ï¼Œå®ƒä¸ºç¨‹åºçš„æ­£ç¡®æ€§ã€å¹¶å‘æ€§å’Œå¯ç§»æ¤æ€§æä¾›äº†ä¿è¯ã€‚C++ å†…å­˜æ¨¡å‹ä¸»è¦é€šè¿‡åŸå­æ“ä½œã€å†…å­˜åºåˆ—ï¼ˆMemory Orderingï¼‰ã€åŒæ­¥å’Œé”ç­‰æœºåˆ¶æ¥è§„èŒƒçº¿ç¨‹ä¹‹é—´çš„å†…å­˜è®¿é—®è¡Œä¸ºã€‚&lt;/p>
&lt;/blockquote>
&lt;hr>
&lt;h1 id="cpu-çš„äº”çº§æµæ°´çº¿">CPU çš„äº”çº§æµæ°´çº¿&lt;/h1>
&lt;blockquote>
&lt;p>CPU å°†æŒ‡ä»¤æ‰§è¡Œåˆ†è§£æˆ5ä¸ªéƒ¨åˆ†ï¼Œåˆ†åˆ«æ˜¯ï¼šIF å–æŒ‡ä»¤ï¼ŒID è¯‘ç ï¼ŒEX æ‰§è¡Œï¼ŒMEM è®¿é—®å†…å­˜ï¼ŒWB å†™å›ã€‚&lt;/p>
&lt;/blockquote>
&lt;table>
 &lt;thead>
 &lt;tr>
 &lt;th>å†…å­˜é¡ºåºæ¨¡å‹&lt;/th>
 &lt;th>æè¿°&lt;/th>
 &lt;/tr>
 &lt;/thead>
 &lt;tbody>
 &lt;tr>
 &lt;td>memory_order_seq_cst&lt;/td>
 &lt;td>é¡ºåºä¸€è‡´(sequentially consistent ordering)ï¼Œåªæœ‰è¯¥å€¼æ»¡è¶³sCé¡ºåºä¸€è‡´æ€§ï¼ŒåŸå­æ“ä½œé»˜è®¤ä½¿ç”¨è¯¥å€¼ã€‚&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>memory_order_relaxed&lt;/td>
 &lt;td>æ¾æ•£(relaxed ordering)&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>memory_order_consume&lt;/td>
 &lt;td>è·å–å‘å¸ƒ(acquire-release ordering)&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>memory_order_acquire&lt;/td>
 &lt;td>è·å–å‘å¸ƒ(acquire-release ordering)&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>memory_order_release&lt;/td>
 &lt;td>è·å–å‘å¸ƒ(acquire-release ordering)&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>memory_order_acq_rel&lt;/td>
 &lt;td>è·å–å‘å¸ƒ(acquire-release ordering)&lt;/td>
 &lt;/tr>
 &lt;/tbody>
&lt;/table>
&lt;p>ä¸ç¼–è¯‘å™¨ä¼˜åŒ–æœ‰å…³ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">//reordering é‡æ’ç¤ºä¾‹ä»£ç 
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">int&lt;/span> A &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>, B &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">void&lt;/span> &lt;span style="color:#a6e22e">foo&lt;/span>()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> A &lt;span style="color:#f92672">=&lt;/span> B &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>; &lt;span style="color:#75715e">//(1)
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> B &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>; &lt;span style="color:#75715e">//(2)
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-asm" data-lang="asm">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// g++ -std=c++11 -O2 -S test.cpp
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// ç¼–è¯‘å™¨é‡æ’åçš„ä»£ç 
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// æ³¨æ„ç¬¬ä¸€å¥æ±‡ç¼–ï¼Œå·²ç»å°†Bæœ€åˆçš„å€¼å­˜åˆ°äº†
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// å¯„å­˜å™¨eaxï¼Œè€Œåå°†è¯¥eaxçš„å€¼åŠ 1ï¼Œå†èµ‹ç»™A
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#a6e22e">movl&lt;/span> &lt;span style="color:#66d9ef">B&lt;/span>(%rip), %eax
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">movl&lt;/span> &lt;span style="color:#66d9ef">$1&lt;/span>, &lt;span style="color:#66d9ef">B&lt;/span>(%rip) &lt;span style="color:#75715e">// B = 1
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#a6e22e">addl&lt;/span> &lt;span style="color:#66d9ef">$1&lt;/span>, %eax &lt;span style="color:#75715e">// A = B + 1
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#a6e22e">movl&lt;/span> %eax, &lt;span style="color:#66d9ef">A&lt;/span>(%rip)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// Inventionç¤ºä¾‹ä»£ç 
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// åŸå§‹ä»£ç 
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">if&lt;/span>( cond ) x &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">42&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// ä¼˜åŒ–åä»£ç 
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>r1 &lt;span style="color:#f92672">=&lt;/span> x;&lt;span style="color:#75715e">// read what&amp;#39;s there
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>x &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">42&lt;/span>;&lt;span style="color:#75715e">// oops: optimistic write is not conditional
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">if&lt;/span>( &lt;span style="color:#f92672">!&lt;/span>cond)&lt;span style="color:#75715e">// check if we guessed wrong
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> x &lt;span style="color:#f92672">=&lt;/span> r1;&lt;span style="color:#75715e">// oops: back-out write is not SC
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¯¹äºå†…å­˜è¯»å†™æ¥è¯´ï¼Œè¯»å†™é¡ºåºéœ€è¦ä¸¥æ ¼æŒ‰ç…§ä»£ç é¡ºåºï¼Œå³è¦æ±‚å¦‚ä¸‹ï¼ˆç¬¦å·&lt;code>&amp;lt;p&lt;/code>è¡¨ç¤ºç¨‹åºä»£ç é¡ºåºï¼Œç¬¦å·&lt;code>&amp;lt;m&lt;/code>è¡¨ç¤ºå†…å­˜çš„è¯»å†™é¡ºåºï¼‰ï¼š&lt;/p></description></item><item><title>C++ ä¸­ tuple æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ</title><link>https://jekyulll.github.io/posts/cpp-c++-%E4%B8%AD-tuple-%E6%98%AF%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E7%9A%84/</link><pubDate>Sat, 28 Sep 2024 18:05:47 +0800</pubDate><guid>https://jekyulll.github.io/posts/cpp-c++-%E4%B8%AD-tuple-%E6%98%AF%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E7%9A%84/</guid><description>&lt;p>&lt;code>tuple&lt;/code>æœ¬èº«å°±æ˜¯ä¸€ç§ç»“æ„ä½“ï¼Œä½†æ˜¯æ˜¯ä¸€ä¸ªæ¨¡æ¿ç±»ã€‚åˆ©ç”¨&lt;code>å½¢å‚åŒ…&lt;/code>(Parameter pack)ã€‚&lt;a href="https://zhuanlan.zhihu.com/p/715025973">C++ std::tupleçš„åŸç†åŠç®€æ˜“å®ç°&lt;/a>ï¼Œé ç€æ¨¡æ¿å…ƒçš„é€’å½’å®ç°çš„ï¼Œç›¸å½“æŠ½è±¡ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">template&lt;/span>&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#66d9ef">typename&lt;/span>...Args&lt;span style="color:#f92672">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">struct&lt;/span> &lt;span style="color:#a6e22e">tuple&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// å½“å…ƒç»„ä¸­æ²¡æœ‰å…ƒç´ æ—¶ï¼Œé€’å½’ç»“æŸ
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">template&lt;/span>&lt;span style="color:#f92672">&amp;lt;&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">struct&lt;/span> &lt;span style="color:#a6e22e">tuple&lt;/span>&lt;span style="color:#f92672">&amp;lt;&amp;gt;&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">constexpr&lt;/span> &lt;span style="color:#a6e22e">tuple&lt;/span>() &lt;span style="color:#66d9ef">noexcept&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">default&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">constexpr&lt;/span> &lt;span style="color:#a6e22e">tuple&lt;/span>(&lt;span style="color:#66d9ef">const&lt;/span> tuple &lt;span style="color:#f92672">&amp;amp;&lt;/span>) &lt;span style="color:#66d9ef">noexcept&lt;/span> {};
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">constexpr&lt;/span> tuple &lt;span style="color:#f92672">&amp;amp;&lt;/span>&lt;span style="color:#66d9ef">operator&lt;/span>&lt;span style="color:#f92672">=&lt;/span>(&lt;span style="color:#66d9ef">const&lt;/span> tuple &lt;span style="color:#f92672">&amp;amp;&lt;/span>) &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">default&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// å½“å…ƒç»„ä¸­æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ æ—¶ï¼Œå°†ç¬¬ä¸€ä¸ªå…ƒç´ çš„ç±»å‹åˆ†ç¦»å‡ºæ¥ï¼Œå¹¶é€šè¿‡ç»§æ‰¿ï¼Œå°†å‰©ä¸‹çš„å…ƒç´ ä½œä¸ºå¦ä¸€ä¸ªå…ƒç»„å¤„ç†ã€‚
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#66d9ef">template&lt;/span>&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#66d9ef">typename&lt;/span> head, &lt;span style="color:#66d9ef">typename&lt;/span>...Args&lt;span style="color:#f92672">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">struct&lt;/span> &lt;span style="color:#a6e22e">tuple&lt;/span>&lt;span style="color:#f92672">&amp;lt;&lt;/span>head, Args...&lt;span style="color:#f92672">&amp;gt;&lt;/span> &lt;span style="color:#f92672">:&lt;/span> tuple&lt;span style="color:#f92672">&amp;lt;&lt;/span>Args...&lt;span style="color:#f92672">&amp;gt;&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">using&lt;/span> base_ &lt;span style="color:#f92672">=&lt;/span> tuple&lt;span style="color:#f92672">&amp;lt;&lt;/span>Args...&lt;span style="color:#f92672">&amp;gt;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">template&lt;/span>&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#66d9ef">typename&lt;/span> head_, &lt;span style="color:#66d9ef">typename&lt;/span>...Args_&lt;span style="color:#f92672">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">constexpr&lt;/span> tuple(head_ &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span>val, Args_ &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span>...args) &lt;span style="color:#f92672">:&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> head_val_(std&lt;span style="color:#f92672">::&lt;/span>forward&lt;span style="color:#f92672">&amp;lt;&lt;/span>head_&lt;span style="color:#f92672">&amp;gt;&lt;/span>(val)), base_(std&lt;span style="color:#f92672">::&lt;/span>forward&lt;span style="color:#f92672">&amp;lt;&lt;/span>Args_&lt;span style="color:#f92672">&amp;gt;&lt;/span>(args)...) {}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> tuple_val_&lt;span style="color:#f92672">&amp;lt;&lt;/span>head&lt;span style="color:#f92672">&amp;gt;&lt;/span> head_val_;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;a href="https://zh.cppreference.com/w/cpp/language/class_template_argument_deduction">ç±»æ¨¡æ¿å®å‚æ¨å¯¼ï¼ˆCTADï¼‰(C++17 èµ·)&lt;/a>ã€‚&lt;/p></description></item><item><title>C++ çš„å››ç§ç±»å‹è½¬æ¢</title><link>https://jekyulll.github.io/posts/cpp-c++-%E7%9A%84%E5%9B%9B%E7%A7%8D%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2/</link><pubDate>Sat, 28 Sep 2024 18:05:47 +0800</pubDate><guid>https://jekyulll.github.io/posts/cpp-c++-%E7%9A%84%E5%9B%9B%E7%A7%8D%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2/</guid><description>&lt;p>æ€è€ƒäº†ä¸€ä¸‹&lt;code>reinterpret_cast&lt;/code>å’Œå¼ºè½¬çš„åŒºåˆ«ï¼Ÿè¿™æ®µéå¸¸æ˜“æ‡‚ï¼š&lt;br>
C è¯­è¨€çš„ç±»å‹è½¬æ¢å®é™…ä¸ŠåŒ…å«å„ç§è½¬æ¢æ–¹å¼ï¼Œæ˜¯ &lt;code>static_cast&lt;/code> è·Ÿ &lt;code>reinterpret_cast&lt;/code> ç­‰çš„çˆ¶æ“ä½œã€‚&lt;/p>
&lt;ul>
&lt;li>
&lt;p>ä¸€ç±»æ˜¯ä»é€»è¾‘æ„ä¹‰ä¸Šè¯»å–åŸæœ‰çš„å€¼ï¼Œç„¶ååˆ°æ–°çš„å˜é‡ç±»å‹ç”Ÿæˆä¸€ä¸ªæ–°å€¼ã€‚ï¼ˆå¯ä»¥ç§°ä¸º&lt;strong>æ˜¾å¼ç±»å‹è½¬æ¢&lt;/strong>ï¼Œç®€ç§°æ˜¾è½¬ï¼‰&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ä¸€ç±»æ˜¯å®Œå…¨ä¿æŒåŸæœ‰å€¼çš„å†…å­˜è¡¨è¾¾æ–¹å¼ï¼Œç”¨æ–°çš„å˜é‡ç±»å‹æ¥è§£è¯»è¿™æ®µå†…å­˜åŒºåŸŸã€‚ï¼ˆå¯ä»¥ç§°ä¸º&lt;strong>å¼ºåˆ¶ç±»å‹è½¬æ¢&lt;/strong>ï¼Œç®€ç§°å¼ºè½¬ï¼‰&lt;br>
è¿™ä¸¤ä¸ªç”¨æ³•å®é™…çš„åŠ¨ä½œå®Œå…¨ä¸åŒï¼Œä½†åœ¨ C è¯­è¨€ä¸­æ˜¯åŒä¸€ç§å†™æ³•ã€‚æ‰€ä»¥åˆ°äº†C++ï¼Œå°±æŠŠå‰ä¸€ç§å†™æ³•å†™æˆ &lt;code>static_cast&lt;/code>ï¼Œåä¸€ç§å†™æ³•å†™æˆ &lt;code>reinterpret_cast&lt;/code>ã€‚&lt;br>
&lt;code>reinterpret_cast&lt;/code> ä»…ä½œç”¨äºç¼–è¯‘æ—¶ï¼Œå¯ä»¥ä¿è¯ä¸æ”¹å˜å†…å­˜åŒºåŸŸçš„å†…å®¹ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>dynamic_castï¼šè¿™æ˜¯ C é‡Œé¢ä¸å­˜åœ¨çš„è½¬å‹æ–¹å¼ï¼Œç”¨æ¥åœ¨å¸¦æœ‰è™šå‡½æ•°çš„â€œåŠ¨æ€å¯¹è±¡â€ç»§æ‰¿æ ‘é‡Œè¿›è¡ŒæŒ‡é’ˆæˆ–å¼•ç”¨çš„ç±»å‹è½¬æ¢ã€‚æ¯”å¦‚ï¼Œå‡è®¾æˆ‘ä»¬æœ‰å¯¹è±¡åŸºç±» &lt;code>Shape&lt;/code> å’Œæ´¾ç”Ÿç±» &lt;code>Circle&lt;/code> å’Œ &lt;code>Rectangle&lt;/code>ï¼šå¦‚æœæœ‰ &lt;code>Shape&lt;/code> æŒ‡é’ˆ &lt;code>ptr&lt;/code>ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ &lt;code>dynamic_cast&amp;lt;Circle*&amp;gt;(ptr)&lt;/code> å°è¯•æŠŠå®ƒè½¬å‹æˆ &lt;code>Circle*&lt;/code>ã€‚ç³»ç»Ÿä¼šè¿›è¡Œéœ€è¦çš„ç±»å‹æ£€æŸ¥ï¼Œå¹¶åœ¨è½¬å‹æˆåŠŸæ—¶è¿”å›ä¸€ä¸ªéç©ºæŒ‡é’ˆï¼Œè¿”å›ç©ºæŒ‡é’ˆåˆ™è¡¨ç¤ºå¤±è´¥ï¼ˆå¦‚å½“ &lt;code>ptr&lt;/code> å®é™…æŒ‡å‘çš„ä¸æ˜¯ &lt;code>Circle&lt;/code>ï¼Œè€Œæ˜¯ &lt;code>Rectangle&lt;/code>ï¼‰ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>static_castï¼šè¿™æ˜¯ä¸€ç§åœ¨å¾ˆå¤šè®¤ä¸ºè¾ƒå®‰å…¨çš„åœºæ™¯ä¸‹çš„â€œé™æ€â€è½¬å‹æ–¹å¼ã€‚ä½ å¯ä»¥ä½¿ç”¨å®ƒåœ¨ä¸åŒçš„æ•°å€¼ç±»å‹ä¹‹é—´è¿›è¡Œè½¬æ¢ï¼Œå¦‚ä» &lt;code>long&lt;/code> åˆ° &lt;code>int&lt;/code>ï¼Œæˆ–è€…ä» &lt;code>long long&lt;/code> åˆ° &lt;code>double&lt;/code>â€”â€”å½“è½¬æ¢æœ‰å¯èƒ½æœ‰ç²¾åº¦æŸå¤±æ—¶ï¼Œå°±ä¸èƒ½ä½¿ç”¨éšå¼ç±»å‹è½¬æ¢ï¼Œè€Œå¾—æ˜ç¡®ä½¿ç”¨è½¬å‹äº†ã€‚ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨å®ƒæŠŠä¸€ä¸ª &lt;code>void*&lt;/code> è½¬æˆä¸€ä¸ªå®é™…ç±»å‹çš„æŒ‡é’ˆï¼ˆå¦‚ &lt;code>int*&lt;/code>ï¼‰ã€‚ä½ è¿˜å¯ä»¥ç”¨å®ƒæŠŠåŸºç±»çš„æŒ‡é’ˆè½¬æˆæ´¾ç”Ÿç±»çš„æŒ‡é’ˆï¼Œå‰ææ¡ä»¶æ˜¯ä½ èƒ½ç¡®è®¤è¿™ä¸ªåŸºç±»çš„æŒ‡é’ˆç¡®å®æŒ‡å‘ä¸€ä¸ªæ´¾ç”Ÿç±»çš„å¯¹è±¡ã€‚æ˜¾ç„¶ï¼Œå¯¹äºè¿™æœ€åä¸€ç§åœºæ™¯ static_cast ä¸å¦‚ dynamic_cast å®‰å…¨ï¼Œä½†ç”±äºä¸éœ€è¦è¿›è¡Œè¿è¡ŒæœŸçš„æ£€æŸ¥ï¼Œå®ƒçš„æ€§èƒ½æ¯” &lt;code>dynamic_cast&lt;/code> è¦é«˜ï¼Œåœ¨å¾ˆå¤šæƒ…å†µä¸‹æ˜¯ä¸ªç©ºæ“ä½œã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>const_castï¼šè¿™ç§è½¬å‹æ–¹å¼æ½œåœ¨å°±ä¸é‚£ä¹ˆå®‰å…¨äº†ã€‚å®ƒçš„ç›®çš„æ˜¯å»æ‰ä¸€ä¸ªæŒ‡é’ˆæˆ–å¼•ç”¨ç±»å‹çš„ &lt;code>const&lt;/code> æˆ– &lt;code>volatile&lt;/code> ä¿®é¥°ï¼Œå¦‚ä» &lt;code>const char*&lt;/code> è½¬æ¢åˆ° &lt;code>char*&lt;/code>ã€‚è¿™ç§è½¬å‹çš„ä¸€ç§å¸¸è§ç”¨é€”æ˜¯æŠŠä¸€ä¸ª C++ çš„æŒ‡é’ˆä¼ é€’åˆ°ä¸€ä¸ª &lt;code>const&lt;/code> ä¸æ­£ç¡®çš„ C æ¥å£é‡Œå»ï¼Œæ¯”å¦‚ C æ¥å£åœ¨è¯¥ç”¨ &lt;code>const char*&lt;/code> æ—¶ä½¿ç”¨äº† &lt;code>char*&lt;/code>ã€‚æ³¨æ„è¿™ç§è½¬å‹åªæ˜¯ä¸ºäº†â€œæ¬ºéª—â€ç±»å‹ç³»ç»Ÿï¼Œè®©ä»£ç èƒ½é€šè¿‡ç¼–è¯‘ã€‚å¦‚æœä½ é€šè¿‡ &lt;code>const_cast&lt;/code> æ“ä½œæŒ‡é’ˆæˆ–å¼•ç”¨å»ä¿®æ”¹ä¸€ä¸ª &lt;code>const&lt;/code> å¯¹è±¡ï¼Œè¿™ä»ç„¶æ˜¯é”™è¯¯çš„ï¼Œæ˜¯æœªå®šä¹‰è¡Œä¸ºï¼Œå¯èƒ½ä¼šå¯¼è‡´å¥‡æ€ªçš„æ„å¤–ç»“æœã€‚&lt;/p></description></item><item><title>å¯¹ C++ å·¦å€¼ã€å³å€¼ã€æ™ºèƒ½æŒ‡é’ˆçš„æ€è€ƒ</title><link>https://jekyulll.github.io/posts/cpp-%E5%AF%B9-c++-%E5%B7%A6%E5%80%BC%E5%8F%B3%E5%80%BC%E6%99%BA%E8%83%BD%E6%8C%87%E9%92%88%E7%9A%84%E6%80%9D%E8%80%83/</link><pubDate>Thu, 19 Sep 2024 18:05:47 +0800</pubDate><guid>https://jekyulll.github.io/posts/cpp-%E5%AF%B9-c++-%E5%B7%A6%E5%80%BC%E5%8F%B3%E5%80%BC%E6%99%BA%E8%83%BD%E6%8C%87%E9%92%88%E7%9A%84%E6%80%9D%E8%80%83/</guid><description>&lt;h5 id="å·¦å€¼å³å€¼å‡½æ•°ä¼ å‚">å·¦å€¼å³å€¼ã€å‡½æ•°ä¼ å‚ï¼š&lt;/h5>
&lt;ol>
&lt;li>&lt;strong>ä¼ å€¼ï¼ˆæŒ‰å€¼ä¼ é€’ï¼‰&lt;/strong>
å¦‚æœå‡½æ•°çš„å‚æ•°æ˜¯é€šè¿‡æŒ‰å€¼ä¼ é€’çš„ï¼Œä¼ å…¥ä¸€ä¸ªå³å€¼æ—¶ï¼Œç¼–è¯‘å™¨ä¼šç”Ÿæˆä¸€ä¸ªä¸´æ—¶å¯¹è±¡ï¼Œå¹¶å°†è¯¥ä¸´æ—¶å¯¹è±¡å¤åˆ¶æˆ–ç§»åŠ¨åˆ°å‡½æ•°å†…éƒ¨çš„å±€éƒ¨å˜é‡ä¸­ã€‚&lt;/li>
&lt;/ol>
&lt;ul>
&lt;li>å¤åˆ¶ï¼šå¯¹äºä¸å¯ç§»åŠ¨çš„ç±»å‹ï¼ˆä¾‹å¦‚åŸºç¡€ç±»å‹ intï¼‰ï¼Œå³å€¼ä¼šè¢«å¤åˆ¶ã€‚&lt;/li>
&lt;li>ç§»åŠ¨ï¼šå¯¹äºå¯ä»¥ç§»åŠ¨çš„ç±»å‹ï¼ˆä¾‹å¦‚æ‹¥æœ‰ç§»åŠ¨æ„é€ å‡½æ•°çš„ç±»ï¼‰ï¼Œå³å€¼å°†ä¼šè¢«ç§»åŠ¨ï¼Œä»è€Œé¿å…å¤åˆ¶çš„å¼€é”€ã€‚ç§»åŠ¨æ“ä½œæ˜¯ä¸€ä¸ªé«˜æ•ˆçš„æµ…æ‹·è´æ“ä½œï¼Œå°†èµ„æºçš„æ‰€æœ‰æƒä»å³å€¼è½¬ç§»åˆ°å‡½æ•°å†…éƒ¨çš„å±€éƒ¨å˜é‡ä¸­ã€‚&lt;/li>
&lt;/ul>
&lt;ol start="2">
&lt;li>&lt;strong>ä¼ å¼•ç”¨ï¼ˆæŒ‰å¼•ç”¨ä¼ é€’ï¼‰&lt;/strong>&lt;br>
2.1 ä¼ å·¦å€¼å¼•ç”¨
&lt;code>void foo(const std::string&amp;amp; s);&lt;/code> å½“å‡½æ•°æ¥å—ä¸€ä¸ªconst å·¦å€¼å¼•ç”¨æ—¶ï¼Œå¦‚æœä¼ å…¥ä¸€ä¸ªå³å€¼ï¼Œç¼–è¯‘å™¨ä¼šç”Ÿæˆä¸€ä¸ªä¸´æ—¶å¯¹è±¡å¹¶å°†å®ƒç»‘å®šåˆ°å·¦å€¼å¼•ç”¨ä¸Šã€‚è¿™æ—¶ä¸ä¼šå‘ç”Ÿå¤åˆ¶æˆ–ç§»åŠ¨ï¼Œå‡½æ•°å†…éƒ¨ä¼šç›´æ¥ä½¿ç”¨å³å€¼çš„ä¸´æ—¶å¯¹è±¡ã€‚è¿™ä¸ªä¸´æ—¶å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸä¼šè¢«å»¶é•¿åˆ°å‡½æ•°ç»“æŸã€‚
2.2 ä¼ å³å€¼å¼•ç”¨
&lt;code>void foo(std::string&amp;amp;&amp;amp; s);&lt;/code> å½“å‡½æ•°æ¥å—ä¸€ä¸ªå³å€¼å¼•ç”¨æ—¶ï¼Œå³å€¼å¼•ç”¨å‚æ•°å¯ä»¥ç›´æ¥ç»‘å®šåˆ°å³å€¼ï¼Œå› æ­¤ä¸ä¼šå‘ç”Ÿå¤åˆ¶ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œå³å€¼å¼•ç”¨ç”¨äºè½¬ç§»èµ„æºçš„æ‰€æœ‰æƒï¼Œå‡½æ•°å†…éƒ¨å¯ä»¥è‡ªç”±åœ°æ“ä½œè¯¥å³å€¼å¼•ç”¨çš„å†…å­˜å†…å®¹ã€‚&lt;/li>
&lt;/ol>
&lt;h6 id="stdmove-ä¸-æ™ºèƒ½æŒ‡é’ˆ">std::move ä¸ æ™ºèƒ½æŒ‡é’ˆ&lt;/h6>
&lt;p>&lt;code>std::move()&lt;/code> æœ¬èº«å¹¶ä¸ä¼šç§»åŠ¨æ•°æ®ï¼Œå®ƒåªæ˜¯å°†å¯¹è±¡çš„å·¦å€¼å¼ºåˆ¶è½¬æ¢ä¸ºå³å€¼å¼•ç”¨ï¼Œä»è€Œå…è®¸å¯¹è±¡ä½¿ç”¨ç§»åŠ¨æ„é€ å‡½æ•°æˆ–ç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦ã€‚å®é™…çš„â€œç§»åŠ¨â€è¡Œä¸ºæ˜¯åœ¨è¿™äº›å‡½æ•°ä¸­å®ç°çš„ã€‚&lt;/p>
&lt;ul>
&lt;li>
&lt;p>std::move() å¯ä»¥ä¼ å…¥æ™®é€šæŒ‡é’ˆï¼ˆå¦‚ int*ï¼‰ã€‚ä¼ å…¥æŒ‡é’ˆæ—¶å¹¶ä¸ä¼šäº§ç”Ÿä»»ä½•æœ‰å®é™…æ„ä¹‰çš„â€œç§»åŠ¨â€è¡Œä¸ºï¼Œç”±äºæŒ‡é’ˆåªæ˜¯æŒ‡å‘æŸä¸ªå†…å­˜åœ°å€çš„å˜é‡(è€Œä¸è´Ÿè´£ç®¡ç†èµ„æº)ï¼Œæ‰€ä»¥â€œç§»åŠ¨â€ä¸€ä¸ªæŒ‡é’ˆåªæ˜¯ç®€å•åœ°è½¬ç§»å…¶åœ°å€å€¼ï¼Œå¹¶æ²¡æœ‰å®é™…æ¶‰åŠèµ„æºçš„æ‰€æœ‰æƒè½¬ç§»ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å½“ &lt;code>std::move&lt;/code> ä¼ å…¥æ™ºèƒ½æŒ‡é’ˆï¼ˆå¦‚ &lt;code>std::unique_ptr&lt;/code> æˆ– &lt;code>std::shared_ptr&lt;/code>ï¼‰æ—¶ï¼Œä¸ä¼ å…¥æ™®é€šæŒ‡é’ˆç›¸æ¯”ï¼Œå®ƒä¼šäº§ç”Ÿå®é™…çš„èµ„æºè½¬ç§»ï¼Œè¿™æ˜¯æ™ºèƒ½æŒ‡é’ˆçš„ç§»åŠ¨è¯­ä¹‰å¸¦æ¥çš„ç»“æœã€‚&lt;/p>
&lt;ul>
&lt;li>&lt;code>std::unique_ptr&lt;/code> æ˜¯ç‹¬å æ‰€æœ‰æƒçš„æ™ºèƒ½æŒ‡é’ˆï¼Œæ„å‘³ç€å®ƒç‹¬è‡ªç®¡ç†åŠ¨æ€åˆ†é…çš„å¯¹è±¡ã€‚ä¸èƒ½å¤åˆ¶ &lt;code>std::unique_ptr&lt;/code>ï¼Œä½†å¯ä»¥é€šè¿‡ç§»åŠ¨å°†æ‰€æœ‰æƒè½¬ç§»ç»™å¦ä¸€ä¸ª &lt;code>std::unique_ptr&lt;/code>ã€‚è¢«ç§»åŠ¨çš„ &lt;code>std::unique_ptr&lt;/code> ä¼šå˜ä¸º &lt;code>nullptr&lt;/code>ã€‚&lt;/li>
&lt;li>&lt;code>std::move&lt;/code> + &lt;code>std::shared_ptr&lt;/code>ï¼šå°† &lt;code>std::shared_ptr&lt;/code> çš„å¼•ç”¨è®¡æ•°å’Œæ‰€æœ‰æƒä»ä¸€ä¸ªå¯¹è±¡è½¬ç§»åˆ°å¦ä¸€ä¸ªã€‚è¢«ç§»åŠ¨çš„ &lt;code>shared_ptr&lt;/code> å˜ä¸º &lt;code>nullptr&lt;/code>ï¼Œä½†åŸæ¥å…±äº«çš„èµ„æºåªä¼šåœ¨æœ€åä¸€ä¸ª &lt;code>shared_ptr&lt;/code> é”€æ¯æ—¶é‡Šæ”¾ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;pre tabindex="0">&lt;code>void process(std::unique_ptr&amp;lt;int&amp;gt;&amp;amp;&amp;amp; ptr) {
 std::cout &amp;lt;&amp;lt; &amp;#34;Value: &amp;#34; &amp;lt;&amp;lt; *ptr &amp;lt;&amp;lt; std::endl;
}
std::unique_ptr&amp;lt;int&amp;gt; p1 = std::make_unique&amp;lt;int&amp;gt;(42);
process(std::move(p1)); // ä½¿ç”¨ std::move å°†æ‰€æœ‰æƒè½¬ç§»ç»™ process å‡½æ•°
&lt;/code>&lt;/pre>&lt;p>&lt;strong>å½“ &lt;code>std::unique_ptr&lt;/code> ä½œä¸ºå‚æ•°ä¼ å…¥å‡½æ•°æ—¶ï¼š&lt;/strong>&lt;/p></description></item><item><title>C++ æ¨¡æ¿ç±»å‹æ¨å¯¼</title><link>https://jekyulll.github.io/posts/cpp-morden-c++-%E6%A8%A1%E6%9D%BF%E7%B1%BB%E5%9E%8B%E6%8E%A8%E5%AF%BC/</link><pubDate>Sun, 01 Sep 2024 18:05:47 +0800</pubDate><guid>https://jekyulll.github.io/posts/cpp-morden-c++-%E6%A8%A1%E6%9D%BF%E7%B1%BB%E5%9E%8B%E6%8E%A8%E5%AF%BC/</guid><description>&lt;p>&lt;a href="https://zhuanlan.zhihu.com/p/649667647">ä¸€ç¯‡æ–‡ç« å­¦å®Œ Effective Modern C++ï¼šæ¡æ¬¾ &amp;amp; å®è·µ&lt;/a>ï¼š&lt;/p>
&lt;h2 id="æ¡æ¬¾1-æ¨¡æ¿å‚æ•°ç±»å‹æ¨å¯¼å¼•ç”¨æŠ˜å ">æ¡æ¬¾1ï¼š æ¨¡æ¿å‚æ•°ç±»å‹æ¨å¯¼ï¼Œå¼•ç”¨æŠ˜å &lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">template&lt;/span>&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#66d9ef">typename&lt;/span> T&lt;span style="color:#f92672">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">void&lt;/span> f(T&lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> param);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">int&lt;/span> x &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">27&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#66d9ef">int&lt;/span> cx &lt;span style="color:#f92672">=&lt;/span> x;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#66d9ef">int&lt;/span>&lt;span style="color:#f92672">&amp;amp;&lt;/span> rx &lt;span style="color:#f92672">=&lt;/span> x;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// å·¦å€¼çš„æƒ…å†µ
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>f(x); &lt;span style="color:#75715e">// T çš„ç±»å‹ä¸º int&amp;amp;, paramType ä¸º int&amp;amp;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>f(cx); &lt;span style="color:#75715e">// T çš„ç±»å‹ä¸º const int&amp;amp;, paramType ä¸º const int&amp;amp;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>f(rx); &lt;span style="color:#75715e">// T çš„ç±»å‹ä¸º const int&amp;amp;, paramType ä¸º const int&amp;amp;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// å³å€¼çš„æƒ…å†µ
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>f(&lt;span style="color:#ae81ff">27&lt;/span>) &lt;span style="color:#75715e">// T çš„ç±»å‹ä¸º int, paramType ä¸º int&amp;amp;&amp;amp;
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¯¹äºæŒ‡å‘ &lt;code>const&lt;/code> å¯¹è±¡çš„ &lt;code>const&lt;/code> æŒ‡é’ˆçš„ä¼ é€’ï¼Œä»…æœ‰æŒ‡é’ˆæœ¬èº«çš„å¸¸é‡æ€§ä¼šè¢«å¿½ç•¥ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">template&lt;/span>&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#66d9ef">typename&lt;/span> T&lt;span style="color:#f92672">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">void&lt;/span> f(T param);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#66d9ef">char&lt;/span>&lt;span style="color:#f92672">*&lt;/span> &lt;span style="color:#66d9ef">const&lt;/span> ptr &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;Fun with pointers&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>f(ptr); &lt;span style="color:#75715e">// T å’Œ param çš„ç±»å‹å‡ä¸º const char*
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æŒ‰å€¼ä¼ é€’ç»™å‡½æ•°æ¨¡æ¿çš„æ•°ç»„ç±»å‹å°†é€€åŒ–ä¸ºæŒ‡é’ˆç±»å‹ï¼Œä½†æŒ‰å¼•ç”¨ä¼ é€’å´èƒ½æ¨å¯¼å‡ºçœŸæ­£çš„æ•°ç»„ç±»å‹ï¼š&lt;/p></description></item><item><title>C++ çš„ä¸‰äº”æ³•åˆ™æ˜¯ä»€ä¹ˆï¼Ÿ</title><link>https://jekyulll.github.io/posts/cpp-c++-%E7%9A%84%E4%B8%89%E4%BA%94%E6%B3%95%E5%88%99%E6%98%AF%E4%BB%80%E4%B9%88/</link><pubDate>Mon, 26 Aug 2024 18:05:47 +0800</pubDate><guid>https://jekyulll.github.io/posts/cpp-c++-%E7%9A%84%E4%B8%89%E4%BA%94%E6%B3%95%E5%88%99%E6%98%AF%E4%BB%80%E4%B9%88/</guid><description>&lt;p>ä¸‰äº”æ³•åˆ™ï¼ˆRule of Three/Five/Zeroï¼‰ã€‚&lt;/p>
&lt;p>â€œä¸‰æ³•åˆ™â€ä¸»è¦é€‚ç”¨äº C++98/03 æ ‡å‡†ä¸‹çš„èµ„æºç®¡ç†ã€‚åœ¨ä½¿ç”¨åŠ¨æ€å†…å­˜æˆ–å…¶ä»–èµ„æºæ—¶ï¼Œå¦‚æœç±»éœ€è¦æ˜¾å¼åœ°ç®¡ç†èµ„æºï¼Œé€šå¸¸éœ€è¦å®ç°ä»¥ä¸‹ä¸‰ä¸ªç‰¹æ®Šæˆå‘˜å‡½æ•°ï¼š&lt;/p>
&lt;ol>
&lt;li>æ‹·è´æ„é€ å‡½æ•°ï¼ˆCopy Constructorï¼‰ï¼šç”¨äºå¤åˆ¶å¯¹è±¡æ—¶åˆ†é…æ–°èµ„æºã€‚&lt;/li>
&lt;li>æ‹·è´èµ‹å€¼è¿ç®—ç¬¦ï¼ˆCopy Assignment Operatorï¼‰ï¼šç”¨äºå¯¹è±¡èµ‹å€¼æ—¶é‡Šæ”¾æ—§èµ„æºå¹¶åˆ†é…æ–°èµ„æºã€‚&lt;/li>
&lt;li>ææ„å‡½æ•°ï¼ˆDestructorï¼‰ï¼šç”¨äºå¯¹è±¡é”€æ¯æ—¶é‡Šæ”¾èµ„æºã€‚&lt;/li>
&lt;li>&lt;/li>
&lt;/ol>
&lt;p>éšç€ C++11 å¼•å…¥äº†ç§»åŠ¨è¯­ä¹‰å’Œå³å€¼å¼•ç”¨ï¼Œ&amp;ldquo;äº”æ³•åˆ™&amp;quot;æ‰©å±•äº†â€œä¸‰æ³•åˆ™â€ï¼Œå¢åŠ äº†ä¸¤ä¸ªæ–°çš„ç‰¹æ®Šæˆå‘˜å‡½æ•°ï¼š&lt;/p>
&lt;ol>
&lt;li>ç§»åŠ¨æ„é€ å‡½æ•°ï¼ˆMove Constructorï¼‰ï¼šç”¨äºç§»åŠ¨å¯¹è±¡æ—¶â€œçªƒå–â€èµ„æºï¼Œè€Œä¸æ˜¯å¤åˆ¶ã€‚&lt;/li>
&lt;li>ç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦ï¼ˆMove Assignment Operatorï¼‰ï¼šç”¨äºå¯¹è±¡èµ‹å€¼æ—¶â€œçªƒå–â€èµ„æºï¼Œè€Œä¸æ˜¯å¤åˆ¶ã€‚&lt;/li>
&lt;/ol></description></item><item><title>C++ 17 ç¼–è¯‘æœŸ if</title><link>https://jekyulll.github.io/posts/cpp-c++-17-%E7%BC%96%E8%AF%91%E6%9C%9F-if/</link><pubDate>Sat, 10 Aug 2024 18:05:47 +0800</pubDate><guid>https://jekyulll.github.io/posts/cpp-c++-17-%E7%BC%96%E8%AF%91%E6%9C%9F-if/</guid><description>&lt;p>&lt;a href="https://www.bilibili.com/video/BV1Eb42177a8/?spm_id_from=333.1007.tianma.1-1-1.click&amp;amp;vd_source=9b0b9cbfd8c349b95b4776bd10953f3a">C++17ç¼–è¯‘æœŸif&lt;/a>ï¼š&lt;code>constexpr&lt;/code>ã€‚&lt;/p>
&lt;p>ç”¨ä¾‹ï¼šä¸åŠ &lt;code>constexpr&lt;/code>ä¼šç¼–è¯‘å‡ºé”™ï¼Œå› ä¸ºå¿…æœ‰ä¸€ç§æƒ…å†µæ˜¯è¯­æ³•é”™è¯¯çš„ã€‚å¦‚æœ&lt;code>T&lt;/code>ä¸º&lt;code>X&lt;/code>ç±»å‹ï¼Œåˆ™å†…éƒ¨æ²¡æœ‰&lt;code>y_func()&lt;/code>ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">template&lt;/span>&lt;span style="color:#f92672">&amp;lt;&lt;/span>&lt;span style="color:#66d9ef">typename&lt;/span> T&lt;span style="color:#f92672">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">void&lt;/span> f(T t) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	&lt;span style="color:#75715e">// åˆ¤æ–­ç±»å‹
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>	&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#a6e22e">constexpr&lt;/span> (std&lt;span style="color:#f92672">::&lt;/span>is_same_v&lt;span style="color:#f92672">&amp;lt;&lt;/span>T, X&lt;span style="color:#f92672">&amp;gt;&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>		t.x_func();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	} &lt;span style="color:#66d9ef">else&lt;/span> { &lt;span style="color:#75715e">// æ­¤å¤„è‹¥ä¸º &amp;#34;èˆå¼ƒè¯­å¥&amp;#34;ï¼Œä¸ä¼šå‚åŠ ç¼–è¯‘ã€‚ä½†ä¼šæ£€æŸ¥è¯­æ³•é”™è¯¯(ä½†ä¸ä¼šæ£€æŸ¥æ¨¡æ¿çš„å®ä¾‹åŒ–)ã€‚è€Œé¢„å¤„ç†å™¨if(#if)å¦‚æœèˆå¼ƒï¼Œå®Œå…¨ä¸æ£€æŸ¥ã€‚
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>		t.y_func();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿”å›ç±»å‹æ¨å¯¼ï¼šC++14åå¯ä»¥ç”¨&lt;code>auto&lt;/code>ä½œä¸ºå‡½æ•°è¿”å›å€¼ï¼Œä½†æ‰€æœ‰è¡¨è¾¾å¼å¿…é¡»æ¨å¯¼å‡ºç›¸åŒçš„è¿”å›ç±»å‹(ä¸èƒ½åœ¨ä¸åŒæƒ…å†µä¸‹è¿”å›ä¸åŒçš„ç±»å‹ï¼Œä¾‹å¦‚&lt;code>int&lt;/code>å’Œ&lt;code>float&lt;/code>)ã€‚ä½†å¦‚æœåœ¨åˆ¤æ–­çš„åœ°æ–¹ä½¿ç”¨&lt;code>constexpr&lt;/code>ï¼Œèƒ½é€šè¿‡ç¼–è¯‘(å› ä¸ºæ˜¯åœ¨ç¼–è¯‘æœŸåˆ¤æ–­çš„)ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">auto&lt;/span> &lt;span style="color:#a6e22e">func&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#66d9ef">constexpr&lt;/span> (...) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>		&lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#ae81ff">1.0f&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	} &lt;span style="color:#66d9ef">else&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>		&lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>	}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>OpenGL åˆå­¦ç¬”è®° -- Cherno + LearnOpenGL</title><link>https://jekyulll.github.io/posts/opengl-%E8%8F%9C--opengl-%E5%88%9D%E5%AD%A6%E7%AC%94%E8%AE%B0----cherno-+-learnopengl/</link><pubDate>Mon, 29 Jul 2024 21:05:47 +0800</pubDate><guid>https://jekyulll.github.io/posts/opengl-%E8%8F%9C--opengl-%E5%88%9D%E5%AD%A6%E7%AC%94%E8%AE%B0----cherno-+-learnopengl/</guid><description>&lt;p>&lt;img src="https://jekyulll.github.io/images/ayanami_header.jpg" alt="hearder">&lt;/p>
&lt;p>è¿™ä¸¤ä¸ªæœˆå­¦ä¹ äº†ä¸€ä¸‹OpenGLã€‚ä»Chernoçš„æ•™å­¦è§†é¢‘å¼€å§‹å­¦ä¹ ï¼Œçœ‹å®Œåå¼€å§‹çœ‹LearnOpenGLï¼Œåº”è¯¥æ˜¯å¾ˆå¸¸è§çš„å­¦ä¹ è·¯å¾„ã€‚&lt;br>
åœ¨æ­¤ä»¥æ–°æ‰‹è§†è§’ï¼Œè®°å½•ä¸€ä¸‹å­¦ä¹ ä¸­åœ¨å·¥ç¨‹æ–¹é¢é‡åˆ°çš„ä¸€äº›å‘ï¼ˆæ•°å­¦å’Œåº•å±‚æ–¹é¢å°±ä¸æ‰“ç®—å¼€å£ä¸¢äººäº†ï¼‰ã€‚&lt;/p>
&lt;p>&lt;a href="https://www.youtube.com/@TheCherno">Chernoä¸»é¡µ&lt;/a> | &lt;a href="https://learnopengl.com/">LearnOpenGL&lt;/a>&lt;/p>
&lt;hr>
&lt;h2 id="1-ç›´æ¥é€‰æ‹©-64-ä½">&lt;strong>1.&lt;/strong> ç›´æ¥é€‰æ‹© 64 ä½&lt;/h2>
&lt;p>Chernoè§†é¢‘æ˜¯2017åŠä¹‹å‰çš„ï¼Œä¸ºäº†å…¼å®¹æ€§ï¼Œæ•™ç¨‹é‡Œ32ä½ã€‚è€ŒLearnOpenGLå†™åˆ°åé¢æ˜¯64ä½ï¼Œè¿˜è¦ç”¨Assimpåº“ï¼Œé»˜è®¤æ˜¯ç¼–è¯‘æˆ64ä½ã€‚å»ºè®®ç›´æ¥x64ï¼Œåƒæˆ‘è¿™æ ·é—·å¤´è·Ÿç€å†™çš„è¯è¦æŠŠ GLEW å’Œ GLFW çš„é™æ€åº“å…¨æ¢ä¸€éï¼Œæˆ–è€…å»æŠ˜è…¾CMakeã€‚&lt;/p>
&lt;hr>
&lt;h2 id="2-glew-glad-glfw">&lt;strong>2.&lt;/strong> GLEW, GLAD, GLFW&lt;/h2>
&lt;p>è¿™ä¸‰ä¸ªæ¯”è¾ƒå¸¸ç”¨ã€‚ä¸¤ä¸ªæ•™ç¨‹çš„é€‰æ‹©éƒ½æ˜¯ GLEW + GLFWï¼Œå…¶ä¸­ GLEW å’Œ GLAD å®šä½ç›¸ä¼¼ï¼Œéƒ½æ˜¯ç”¨äºè®¿é—®OpenGLå‡½æ•°ã€‚å¯ä»¥å…ˆçœ‹çœ‹è‡ªå·±å–œæ¬¢å“ªä¸€ä¸ªï¼Œå…å¾—åé¢æƒ³æ¢å†è´¹åŠŸå¤«ã€‚&lt;/p>
&lt;hr>
&lt;h2 id="3-texture-çš„å®ç°----å°å¿ƒææ„å‡½æ•°">&lt;strong>3.&lt;/strong> &lt;code>Texture&lt;/code> çš„å®ç° &amp;ndash; å°å¿ƒææ„å‡½æ•°&lt;/h2>
&lt;p>LearnOpenGLä¸­çš„&lt;code>Texture&lt;/code>åªæ˜¯ä¸€ä¸ªå­˜å‚¨æ•°æ®çš„ç»“æ„ä½“ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">struct&lt;/span> &lt;span style="color:#a6e22e">Texture&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> GLuint id;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> string type;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> aiString path;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>è€ŒChernoå°†&lt;code>Texture&lt;/code>åˆ›å»ºä¸ºç±»ï¼Œæ„é€ å‡½æ•°ä¸­ç›´æ¥å®ŒæˆåŠ è½½å›¾ç‰‡çš„æ“ä½œï¼Œå¹¶ä¸”åœ¨ææ„å‡½æ•°é‡Œè°ƒç”¨&lt;code>glDeleteTextures&lt;/code>ã€‚&lt;br>
å¦‚æœæ— è„‘ç¼ä»£ç å°±å®Œè›‹äº†ï¼Œå› ä¸ºLearnOpenGLåœ¨&lt;code>Model::loadMaterialTextures&lt;/code>å‡½æ•°ä¸­åˆ›å»ºäº†&lt;code>Texture&lt;/code>çš„ä¸´æ—¶å¯¹è±¡å¹¶è¿”å›ï¼Œä¼šè°ƒç”¨ææ„å‡½æ•°ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>vector&lt;span style="color:#f92672">&amp;lt;&lt;/span>Texture&lt;span style="color:#f92672">&amp;gt;&lt;/span> loadMaterialTextures(aiMaterial&lt;span style="color:#f92672">*&lt;/span> mat, aiTextureType type, string typeName)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> vector&lt;span style="color:#f92672">&amp;lt;&lt;/span>Texture&lt;span style="color:#f92672">&amp;gt;&lt;/span> textures;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// ...
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#66d9ef">return&lt;/span> textures;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¯ä»¥é€‰æ‹©ï¼š&lt;/p>
&lt;ol>
&lt;li>ä¿®æ”¹Textureç±»çš„å®ç°ï¼ˆæ¯”å¦‚æŠŠï¼‰glDeleteTextureså•ç‹¬è°ƒç”¨ï¼›&lt;/li>
&lt;li>ä¿®æ”¹Modelç±»ä¸­åŠ è½½çº¹ç†çš„å®ç°ï¼Œä¾‹å¦‚ä¼ å…¥Textureçš„å¼•ç”¨ï¼›&lt;/li>
&lt;li>ä½¿ç”¨æŒ‡é’ˆã€‚æˆ‘é€‰æ‹©äº†ä½¿ç”¨æ™ºèƒ½æŒ‡é’ˆï¼ˆç›¸å¯¹åº”çš„åœ°æ–¹å…¨è¦æ”¹ï¼‰ï¼š&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-cpp" data-lang="cpp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// é¡ºä¾¿æŠŠå‚æ•°æ”¹æˆ `aiTextureType`(Assimpå®šä¹‰çš„ç”¨äºè¡¨ç¤ºTextureä¸åŒç±»å‹çš„æšä¸¾)
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// ä¼˜åŒ–æ‰LearnOpenGLé‡Œé‚£ä¸ªä¸‘é™‹çš„å­—ç¬¦ä¸²å¤„ç†
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>std&lt;span style="color:#f92672">::&lt;/span>vector&lt;span style="color:#f92672">&amp;lt;&lt;/span>std&lt;span style="color:#f92672">::&lt;/span>shared_ptr&lt;span style="color:#f92672">&amp;lt;&lt;/span>Texture&lt;span style="color:#f92672">&amp;gt;&amp;gt;&lt;/span> Model&lt;span style="color:#f92672">::&lt;/span>loadMaterialTextures(aiMaterial&lt;span style="color:#f92672">*&lt;/span> mat, aiTextureType type)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> std&lt;span style="color:#f92672">::&lt;/span>vector&lt;span style="color:#f92672">&amp;lt;&lt;/span>std&lt;span style="color:#f92672">::&lt;/span>shared_ptr&lt;span style="color:#f92672">&amp;lt;&lt;/span>Texture&lt;span style="color:#f92672">&amp;gt;&amp;gt;&lt;/span> textures;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">for&lt;/span> (GLuint i &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>; i &lt;span style="color:#f92672">&amp;lt;&lt;/span> mat&lt;span style="color:#f92672">-&amp;gt;&lt;/span>GetTextureCount(type); i&lt;span style="color:#f92672">++&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> aiString str;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> mat&lt;span style="color:#f92672">-&amp;gt;&lt;/span>GetTexture(type, i, &lt;span style="color:#f92672">&amp;amp;&lt;/span>str);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">bool&lt;/span> canSkip &lt;span style="color:#f92672">=&lt;/span> false;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">for&lt;/span> (&lt;span style="color:#66d9ef">int&lt;/span> j &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>; j &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#66d9ef">this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>textures_loaded.size(); j&lt;span style="color:#f92672">++&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (textures_loaded[j]&lt;span style="color:#f92672">-&amp;gt;&lt;/span>path &lt;span style="color:#f92672">==&lt;/span> str)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> textures.push_back(textures_loaded[j]);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> canSkip &lt;span style="color:#f92672">=&lt;/span> true;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">break&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (&lt;span style="color:#f92672">!&lt;/span>canSkip)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> std&lt;span style="color:#f92672">::&lt;/span>string filename &lt;span style="color:#f92672">=&lt;/span> std&lt;span style="color:#f92672">::&lt;/span>string(str.C_Str());
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> filename &lt;span style="color:#f92672">=&lt;/span> directory &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#e6db74">&amp;#39;/&amp;#39;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> filename;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> std&lt;span style="color:#f92672">::&lt;/span>shared_ptr&lt;span style="color:#f92672">&amp;lt;&lt;/span>Texture&lt;span style="color:#f92672">&amp;gt;&lt;/span> texture &lt;span style="color:#f92672">=&lt;/span> std&lt;span style="color:#f92672">::&lt;/span>make_shared&lt;span style="color:#f92672">&amp;lt;&lt;/span>Texture&lt;span style="color:#f92672">&amp;gt;&lt;/span>(filename); &lt;span style="color:#75715e">// æ•™ç¨‹é‡Œæ­¤å¤„è°ƒç”¨äº†TextureFromFile()æ¥åˆå§‹åŒ–textureï¼Œä½†å¯ä»¥ç”¨Textureçš„æ„é€ å‡½æ•°
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> texture&lt;span style="color:#f92672">-&amp;gt;&lt;/span>type &lt;span style="color:#f92672">=&lt;/span> type; 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> texture&lt;span style="color:#f92672">-&amp;gt;&lt;/span>path &lt;span style="color:#f92672">=&lt;/span> str;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> textures.push_back(texture);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">this&lt;/span>&lt;span style="color:#f92672">-&amp;gt;&lt;/span>textures_loaded.push_back(texture);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> textures;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>åŒç†ï¼Œå°å¿ƒå…¶ä»–ç±»é‡Œçš„ææ„å‡½æ•°ï¼ˆä¾‹å¦‚Shaderç±»å¯èƒ½ä¼šåœ¨ææ„é‡Œè°ƒç”¨glDeleteProgramï¼‰ã€‚&lt;/p></description></item><item><title>C++ / Golang / æ¸¸æˆå¼€å‘ / TA å­¦ä¹ è·¯çº¿æ±‡æ€»</title><link>https://jekyulll.github.io/posts/means/</link><pubDate>Sun, 02 Jun 2024 19:46:34 +0800</pubDate><guid>https://jekyulll.github.io/posts/means/</guid><description>&lt;!-- -- 2024å¹´6æœˆ2æ—¥23:56:19
æ”¶è—çš„è·¯çº¿è¶Šæ¥è¶Šå¤šï¼Œæœ‰ç‚¹ä¹±ã€‚å•åˆ—ä¸€ä¸ªæ–‡ä»¶ï¼Œæƒ³åˆ°çš„æ—¶å€™æ±‡æ€»ä¸€ä¸‹ã€‚ -->
&lt;h1 id="c">C++&lt;/h1>
&lt;p>&lt;a href="https://zhuanlan.zhihu.com/p/649667647">ä¸€ç¯‡æ–‡ç« å­¦å®Œ Effective Modern C++ï¼šæ¡æ¬¾ &amp;amp; å®è·µ&lt;/a>ã€‚&lt;/p>
&lt;p>&lt;a href="https://zhuanlan.zhihu.com/p/14264391441">æ·±å…¥ç†è§£C++å†…å­˜ç®¡ç†ï¼šæŒ‡é’ˆã€å¼•ç”¨å’Œå†…å­˜åˆ†é…&lt;/a>ã€‚&lt;/p>
&lt;p>&lt;a href="https://www.zhihu.com/question/274189552/answer/3578048970">CPUçš„æ ¸å¿ƒæ•°å’Œçº¿ç¨‹æ•°é‡æ˜¯ä»€ä¹ˆå…³ç³»ï¼Ÿ - texttime vageçš„å›ç­” - çŸ¥ä¹&lt;/a>ã€‚&lt;/p>
&lt;p>&lt;a href="https://space.bilibili.com/28615855/channel/collectiondetail?sid=43297">åˆé›†Â·ç°ä»£ C++ è¯­è¨€æ ¸å¿ƒç‰¹æ€§è§£æ&lt;/a>ã€‚&lt;br>
&lt;a href="https://changkun.de/modern-cpp/zh-cn/01-intro/">ç°ä»£ C++ æ•™ç¨‹ï¼šé«˜é€Ÿä¸Šæ‰‹ C++ 11/14/17/20&lt;/a>ã€‚&lt;/p>
&lt;p>å°é¹çš„æ•™ç¨‹ï¼š&lt;a href="https://space.bilibili.com/263032155/channel/collectiondetail?sid=599074">åˆé›†Â·ç°ä»£C++é¡¹ç›®å®æˆ˜&lt;/a>ã€‚&lt;/p>
&lt;p>&lt;a href="https://www.zhihu.com/question/290102232/answer/2094675219">æ ¡æ‹›C++å¤§æ¦‚å­¦ä¹ åˆ°ä»€ä¹ˆç¨‹åº¦ï¼Ÿ - ç¨‹åºå‘˜å†…åŠŸä¿®ç‚¼çš„å›ç­” - çŸ¥ä¹&lt;/a>ã€‚å…«è‚¡æ–‡ç»„åˆæ‹³ã€‚&lt;/p>
&lt;p>é™ˆçš“ï¼ˆå·¦è€³æœµè€—å­ï¼‰çš„ä¸€äº›åšå®¢ï¼š&lt;br>
&lt;a href="https://blog.csdn.net/haoel/article/details/1948051">C++ è™šå‡½æ•°è¡¨è§£æ&lt;/a>ã€‚&lt;br>
&lt;a href="https://haoel.blog.csdn.net/article/details/3081328">C++ å¯¹è±¡çš„å†…å­˜å¸ƒå±€ï¼ˆä¸Šï¼‰&lt;/a>ã€‚&lt;br>
&lt;a href="https://haoel.blog.csdn.net/article/details/2886">è·Ÿæˆ‘ä¸€èµ·å†™ Makefileï¼ˆä¸€ï¼‰&lt;/a>ã€‚&lt;br>
&lt;a href="https://coolshell.cn/articles/11564.html">TCP çš„é‚£äº›äº‹å„¿ï¼ˆä¸Šï¼‰&lt;/a>ã€‚&lt;/p>
&lt;p>&lt;a href="https://github.com/Light-City/CPlusPlusThings">C++é‚£äº›äº‹ CPlusPlusThings&lt;/a>ã€‚&lt;br>
&lt;a href="https://light-city.github.io/stories_things/">C++é‚£äº›äº‹ ä¸­æ–‡&lt;/a>ã€‚&lt;/p>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1D84y1t76J/?spm_id_from=333.1007.top_right_bar_window_history.content.click&amp;amp;vd_source=9b0b9cbfd8c349b95b4776bd10953f3a">ç°ä»£C++æ•™ç¨‹ 2023&lt;/a>ã€‚&lt;/p>
&lt;p>&lt;a href="https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html">CUDA C++ Programming Guide&lt;/a>ã€‚&lt;/p>
&lt;p>&lt;a href="https://www.zhihu.com/question/394704611/answer/1245846184">å¦‚ä½•æˆä¸ºlinuxæœåŠ¡ç«¯C++å¼€å‘ä¸“å®¶? - ä¸è°™ä¸–äº‹çš„å´åŒå­¦çš„å›ç­” - çŸ¥ä¹&lt;/a>ã€‚&lt;/p>
&lt;p>&lt;a href="https://zhuanlan.zhihu.com/p/527327054">c++17 å¤šæ€å†…å­˜èµ„æº(PMR)&lt;/a>ã€‚&lt;br>
&lt;a href="https://zhuanlan.zhihu.com/p/452697297">å†…å­˜ç®¡ç†ï¼šè®¾è®¡Arena&lt;/a>ã€‚&lt;/p>
&lt;p>&lt;a href="https://www.bilibili.com/video/BV1Se411D7y4/?spm_id_from=333.337.search-card.all.click&amp;amp;vd_source=9b0b9cbfd8c349b95b4776bd10953f3a">è¿™æœ¬ä¹¦åŠ æ·±äº†æˆ‘å¯¹C++çš„ç†è§£ | C++ Core Guidelinesè§£æ&lt;/a>ã€‚&lt;/p>
&lt;p>&lt;a href="https://blog.csdn.net/weixin_42136255/article/details/133815129">æ·±å…¥ç†è§£Asan:å†…å­˜é”™è¯¯æ£€æµ‹å·¥å…·ä¸å®è·µ&lt;/a>ã€‚&lt;/p>
&lt;!-- [C++ç¿»è¯‘é˜¶æ®µä¸­çš„ç¼–ç è½¬æ¢-æ‰§è¡Œå­—ç¬¦é›†ä¸æºå­—ç¬¦é›†](https://www.bilibili.com/video/BV1yof2Y4EPF/?spm_id_from=333.1007.tianma.2-1-4.click&amp;vd_source=9b0b9cbfd8c349b95b4776bd10953f3a)ã€‚ -->
&lt;p>&lt;a href="https://www.zhihu.com/question/428340896/answer/2913419725">ä¸ºä»€ä¹ˆC/C++ç­‰å°‘æ•°ç¼–ç¨‹è¯­è¨€è¦åŒºåˆ†å·¦å³å€¼ï¼Ÿ - è…¾è®¯æŠ€æœ¯å·¥ç¨‹çš„å›ç­” - çŸ¥ä¹&lt;/a>ã€‚éå¸¸ç‰›é€¼ã€‚è®²å¾—å¾ˆæ·±ï¼Œä»Cè¯­è¨€çš„å‘å±•ã€å¯„å­˜å™¨è®²èµ·ã€‚&lt;/p>
&lt;p>&lt;a href="https://zhuanlan.zhihu.com/p/670821214">13.çº¤ç¨‹ï¼ˆFiberï¼‰ä¸åç¨‹ï¼ˆCoroutineï¼‰&lt;/a>ã€‚&lt;/p>
&lt;p>&lt;a href="https://baijiahao.baidu.com/s?id=1719486804831856788&amp;amp;wfr=spider&amp;amp;for=pc">æ·±å…¥å¹¶å‘ä¹‹çº¿ç¨‹ã€è¿›ç¨‹ã€çº¤ç¨‹ã€åç¨‹ã€ç®¡ç¨‹ä¸æ­»é”ã€æ´»é”ï½œè¯¦è§£&lt;/a>ã€‚&lt;/p>
&lt;p>&lt;a href="https://www.zhihu.com/question/33979489/answer/1854635802">ä»æ“ä½œç³»ç»Ÿå†…å­˜ç®¡ç†æ¥è¯´ï¼Œmallocç”³è¯·ä¸€å—å†…å­˜çš„èƒŒååŸç†æ˜¯ä»€ä¹ˆï¼Ÿ - ç¼–ç¨‹æŒ‡åŒ—çš„å›ç­” - çŸ¥ä¹&lt;/a>ã€‚&lt;/p></description></item><item><title/><link>https://jekyulll.github.io/posts/cpp-%E4%BA%8B%E5%8A%A1%E6%80%A7%E5%86%85%E5%AD%98/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://jekyulll.github.io/posts/cpp-%E4%BA%8B%E5%8A%A1%E6%80%A7%E5%86%85%E5%AD%98/</guid><description>&lt;!-- +++
date = '2025-03-10T12:05:47+08:00'
draft = false
title = 'ã€AIã€‘ä½¿ç”¨æ™®é€šçš„äº’æ–¥é”å®ç°è¯»å†™é”'
author = 'JekYUlll'
lastmod = '2025-03-10T12:05:47+08:00'
tags = ['cpp','algorithm']
categories = ['cpp']
+++ -->
&lt;p>// TODO&lt;/p></description></item></channel></rss>